# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/_securetransport/
@generated: 2026-02-09T18:16:08Z

## Purpose
This directory provides macOS-specific SSL/TLS support for urllib3 through Apple's SecureTransport framework. It implements a complete low-level interface to Apple's Security and CoreFoundation frameworks, enabling secure HTTPS connections using the native macOS cryptographic stack instead of OpenSSL.

## Architecture & Components

### Core Components
- **`__init__.py`**: Empty package initializer following standard Python conventions
- **`bindings.py`**: Low-level ctypes bindings to Apple's SecureTransport and CoreFoundation frameworks
- **`low_level.py`**: High-level helper functions and utilities built on top of the raw bindings

### Framework Integration
The module creates a two-layer architecture:
1. **Raw bindings layer** (`bindings.py`): Direct ctypes access to C APIs with proper type definitions
2. **Helper layer** (`low_level.py`): Python-friendly functions handling memory management and data conversion

## Key Functionality

### SSL/TLS Operations
- **Connection management**: SSL context creation, handshake, read/write operations
- **Certificate handling**: PEM parsing, certificate chain validation, client certificate support
- **Protocol support**: TLS 1.0-1.3 with cipher suite configuration
- **Trust evaluation**: Certificate trust chain validation using macOS keychain

### Memory Management
Implements comprehensive CoreFoundation memory management:
- Automatic CFRetain/CFRelease handling
- Exception-safe resource cleanup
- Temporary keychain creation for certificate operations

### Data Type Conversion
Bidirectional conversion between Python and CoreFoundation types:
- Python strings ↔ CFString
- Python bytes ↔ CFData  
- Python lists/dicts ↔ CFArray/CFDictionary
- PEM certificates → SecCertificateRef objects

## Platform Requirements
- **macOS-only**: Enforced platform validation with ImportError on non-Darwin systems
- **Version requirements**: macOS 10.8+ minimum, with conditional features for newer versions
- **Framework dependencies**: Security.framework and CoreFoundation.framework

## Public API Surface
The module exposes two main interfaces:

### Bindings Interface (`bindings.py`)
- Framework library handles: `Security`, `CoreFoundation`
- Complete function bindings for SSL operations, certificate management, and CoreFoundation utilities
- Constant classes: `CFConst`, `SecurityConst` with SSL/TLS configuration values

### Helper Interface (`low_level.py`)
- Certificate operations: `_cert_array_from_pem()`, `_load_client_cert_chain()`
- Data conversion utilities: `_cf_data_from_bytes()`, `_cfstr()`, `_cf_string_to_unicode()`
- Keychain management: `_temporary_keychain()`, `_load_items_from_file()`
- Error handling: `_assert_no_error()` with SSL-specific exception mapping
- Protocol support: `TLS_PROTOCOL_VERSIONS`, `_build_tls_unknown_ca_alert()`

## Integration Context
This module serves as the foundation for urllib3's SecureTransport adapter on macOS, providing an alternative to OpenSSL-based SSL implementations. It's part of pip's vendored urllib3 library, ensuring consistent HTTPS behavior across different Python environments on macOS systems.

## Design Patterns
- **Resource management**: Consistent CFRetain/CFRelease patterns with exception safety
- **Error propagation**: OSStatus codes converted to Python ssl.SSLError exceptions
- **Type safety**: Extensive ctypes type definitions matching Apple's C APIs
- **Platform abstraction**: Graceful fallback and version detection for macOS compatibility