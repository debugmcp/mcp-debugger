# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/__init__.py
@source-hash: d7fcccffbf61c71b
@generated: 2026-02-09T17:57:59Z

**Primary Purpose:** Dynamic formatter discovery and loading system for the Pygments syntax highlighting library, providing runtime access to all available formatters with lazy loading and caching.

**Core Architecture:**
- Uses module replacement technique (L154-158) to enable automatic formatter importing via attribute access
- Implements two-level caching: formatter classes (`_formatter_cache`, L24) and compiled filename patterns (`_pattern_cache`, L25)
- Supports both built-in formatters (via `FORMATTERS` mapping) and plugin formatters

**Key Functions:**

**`_fn_matches(fn, glob)` (L28-33):** Pattern matching utility with regex caching. Compiles glob patterns to regex on first use and caches for subsequent lookups.

**`_load_formatters(module_name)` (L36-42):** Dynamic module loader that imports all formatters from a module and populates the formatter cache using each class's `name` attribute.

**`get_all_formatters()` (L44-52):** Generator yielding all available formatter classes. Lazy-loads built-in formatters from `FORMATTERS` mapping and includes plugin formatters.

**`find_formatter_class(alias)` (L55-68):** Lookup function that searches for formatters by alias in both built-in and plugin formatters. Returns None if not found.

**`get_formatter_by_name(_alias, **options)` (L70-81):** Factory function that returns instantiated formatter by alias. Raises `ClassNotFound` if alias not found.

**`load_formatter_from_file(filename, formattername="CustomFormatter", **options)` (L84-116):** Security-sensitive function that loads custom formatters from arbitrary files using `exec()`. Includes comprehensive error handling for file I/O and class instantiation.

**`get_formatter_for_filename(fn, **options)` (L119-138):** Filename-based formatter selection using glob pattern matching. Searches both built-in and plugin formatters.

**`_automodule` (L141-151):** Custom module type that enables dynamic attribute access. When an unknown attribute is accessed, it checks `FORMATTERS` mapping and lazy-loads the corresponding formatter class.

**Dependencies:**
- `pip._vendor.pygments.formatters._mapping.FORMATTERS` - Core formatter registry
- `pip._vendor.pygments.plugin.find_plugin_formatters` - Plugin discovery
- `pip._vendor.pygments.util.ClassNotFound` - Exception type

**Critical Design Patterns:**
- Lazy loading: Formatters only imported when first accessed
- Module replacement: Entire module replaced with custom type for dynamic imports
- Dual formatter sources: Built-in (FORMATTERS) and plugins handled uniformly
- Caching strategy: Both compiled patterns and loaded classes cached for performance

**Security Consideration:** `load_formatter_from_file()` uses `exec()` on arbitrary files, requiring careful input validation by callers.