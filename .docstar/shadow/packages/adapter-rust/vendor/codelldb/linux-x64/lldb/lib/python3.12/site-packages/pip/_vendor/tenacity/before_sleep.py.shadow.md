# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/tenacity/before_sleep.py
@source-hash: 626a6037d63b1c69
@generated: 2026-02-09T18:01:50Z

## Purpose
Module providing "before sleep" strategies for the tenacity retry library. These functions execute between retry attempts, typically for logging or other side effects during the sleep period before the next retry.

## Key Functions

### `before_sleep_nothing(retry_state)` (L27-28)
No-op strategy that performs no action between retry attempts. Used as default or when no pre-sleep behavior is desired.

### `before_sleep_log(logger, log_level, exc_info=False)` (L31-71)
Factory function that creates a logging strategy for retry attempts. Returns a closure `log_it` that:
- Validates retry state has `outcome` and `next_action` set (L41-45)
- Formats log messages based on whether the attempt failed or succeeded (L47-57)
- Extracts function name using `_utils.get_callback_name()` (L63)
- Logs retry information including sleep duration, outcome, and optional exception info (L65-69)

The inner `log_it` function (L38-71) handles the actual logging logic, differentiating between failed attempts (with exception details) and successful attempts (with return values).

## Dependencies
- `typing` for type annotations
- `pip._vendor.tenacity._utils` for callback name extraction
- Conditional imports: `logging` and `RetryCallState` for type checking only

## Architecture Notes
- Uses factory pattern - `before_sleep_log` returns a configured function rather than executing directly
- Type-safe with forward references to avoid circular imports
- Handles edge cases like missing function names (L59-63) and validates retry state consistency
- Supports optional exception info logging controlled by `exc_info` parameter

## Integration
These strategies are designed to be passed to tenacity's retry decorators/objects as `before_sleep` callbacks, executed during the sleep period between retry attempts.