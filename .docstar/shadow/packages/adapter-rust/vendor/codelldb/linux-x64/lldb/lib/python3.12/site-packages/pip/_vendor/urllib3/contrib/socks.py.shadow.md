# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/socks.py
@source-hash: 6918bd7965e8f591
@generated: 2026-02-09T17:58:02Z

**Purpose:** SOCKS proxy support module for urllib3, providing SOCKS4/4A/5 proxy connectivity with full urllib3 feature compatibility.

## Key Classes

**SOCKSConnection (L75-141)** - HTTP connection class that routes through SOCKS proxy
- Inherits from HTTPConnection
- `__init__` (L80-82): Extracts `_socks_options` from kwargs 
- `_new_conn()` (L84-140): Core connection establishment via `socks.create_connection()`
- Handles source_address and socket_options passthrough
- Comprehensive error handling for SocketTimeout and socks.ProxyError exceptions

**SOCKSHTTPSConnection (L147-148)** - HTTPS variant using multiple inheritance
- Simple combination of SOCKSConnection and HTTPSConnection
- Automatically inherits correct Verified/Unverified SSL behavior

**SOCKSHTTPConnectionPool (L151-152)** - HTTP connection pool for SOCKS
- Sets ConnectionCls to SOCKSConnection

**SOCKSHTTPSConnectionPool (L155-156)** - HTTPS connection pool for SOCKS  
- Sets ConnectionCls to SOCKSHTTPSConnection

**SOCKSProxyManager (L159-216)** - Main proxy manager class
- Inherits from PoolManager
- `pool_classes_by_scheme` (L165-168): Maps http/https to appropriate pool classes
- `__init__` (L170-214): Complex initialization handling proxy URL parsing and SOCKS configuration

## Dependencies
- **Required:** `socks` module (PySocks) - raises DependencyWarning if missing (L43-58)
- **Core urllib3:** HTTPConnection, HTTPSConnection, connection pools, PoolManager
- **Utilities:** parse_url for proxy URL parsing
- **Optional:** ssl module (graceful degradation if unavailable)

## Protocol Support
- **SOCKS4:** Basic IPv4 support (`socks4://`)
- **SOCKS4A:** IPv4 + domain names (`socks4a://`) 
- **SOCKS5:** IPv4/IPv6/domains with local DNS (`socks5://`)
- **SOCKS5h:** IPv4/IPv6/domains with remote DNS (`socks5h://`)

## Configuration Flow
1. SOCKSProxyManager parses proxy_url to determine SOCKS version and rdns setting (L179-209)
2. Extracts credentials from URL auth or explicit username/password parameters
3. Creates socks_options dict passed to connection classes via `_socks_options`
4. Connection classes use socks_options in `_new_conn()` for proxy establishment

## Error Handling Strategy
- Translates PySocks exceptions to urllib3 exceptions (ConnectTimeoutError, NewConnectionError)
- Defensive SocketError catching with comment noting PySocks should handle these (L135)
- Fragile ProxyError introspection to extract underlying socket errors (L116-133)