# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/util.py
@source-hash: 004558d2aa27cb21
@generated: 2026-02-09T18:01:38Z

## Primary Purpose
Utility module for the Pygments syntax highlighting library, providing text analysis, option parsing, encoding detection, and XML/HTML parsing functionality.

## Key Classes and Exceptions
- **ClassNotFound (L30-31)**: ValueError subclass for failed class lookups
- **OptionError (L34-38)**: Exception for invalid option values/types  
- **Future (L271-278)**: Abstract base for deferred work execution (used by RegexLexerMeta)
- **UnclosingTextIOWrapper (L327-330)**: TextIOWrapper that doesn't close underlying buffer on destruction

## Regular Expressions
- **split_path_re (L15)**: Splits on path separators and spaces `[/\\ ]`
- **doctype_lookup_re (L16-24)**: Extracts DOCTYPE declarations from XML/HTML
- **tag_re (L25-26)**: Matches XML/HTML tags with attributes
- **xml_decl_re (L27)**: Matches XML declarations

## Option Parsing Functions
- **get_choice_opt (L40-51)**: Validates option against allowed choices
- **get_bool_opt (L54-82)**: Parses boolean values from strings (1/0, yes/no, true/false, on/off)
- **get_int_opt (L85-97)**: Parses integer values with error handling
- **get_list_opt (L99-113)**: Converts strings to lists via whitespace splitting

## Text Analysis Functions
- **docstring_headline (L116-125)**: Extracts first paragraph from docstrings
- **make_analysator (L128-142)**: Decorator creating static text analysis functions returning 0.0-1.0 floats
- **shebang_matches (L145-187)**: Regex matching against shebang lines, handles Windows executables
- **doctype_matches (L190-200)**: Regex matching against DOCTYPE declarations
- **html_doctype_matches (L203-205)**: Specific check for HTML doctypes
- **looks_like_xml (L211-224)**: XML detection via declarations/tags, uses caching (L208)

## Encoding Detection
- **guess_decode (L281-299)**: Multi-stage encoding detection (UTF-8 → locale → latin-1)
- **guess_decode_from_terminal (L302-316)**: Terminal-aware encoding detection
- **terminal_encoding (L319-324)**: Best guess terminal encoding

## Utility Functions
- **surrogatepair (L227-233)**: Converts Unicode codepoints >16 bits to surrogate pairs
- **format_lines (L236-252)**: Formats string sequences for code output with indentation
- **duplicates_removed (L255-268)**: Order-preserving deduplication

## Caching
Global cache `_looks_like_xml_cache` (L208) optimizes repeated XML detection calls using text hash keys.

## Dependencies
- `re` for regex operations
- `io.TextIOWrapper` for stream handling
- `locale` for encoding detection (imported on demand)