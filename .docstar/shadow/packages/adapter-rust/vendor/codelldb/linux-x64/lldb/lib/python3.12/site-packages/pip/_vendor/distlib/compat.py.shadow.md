# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/compat.py
@source-hash: 527fae201bf2d36c
@generated: 2026-02-09T18:01:33Z

## Primary Purpose

Python 2/3 compatibility layer for the distlib library, providing unified interfaces across Python versions by conditionally importing modules and defining compatibility shims.

## Core Functionality

**Version Detection & Imports (L19-87)**
- Detects Python version and imports appropriate modules for each version
- Python 2: Uses `StringIO`, `urllib2`, `ConfigParser`, `Queue`, etc.
- Python 3: Uses `io.StringIO`, `urllib.request`, `configparser`, `queue`, etc.
- Provides unified `quote()` function (L30-33) handling Unicode encoding for Python 2

**SSL Certificate Validation (L89-185)**
- `CertificateError` exception class (L93-94) when ssl module lacks it
- `_dnsname_match()` function (L96-143) implements RFC 6125 DNS name matching with wildcard support
- `match_hostname()` function (L145-185) verifies SSL certificates against hostnames, checking subjectAltName and commonName fields

**Container Classes (L188-627)**
- `Container` class (L192-198) - SimpleNamespace alternative for Python 2
- `ZipFile` and `ZipExtFile` context manager wrappers (L271-301) for Python 2.6 compatibility
- `ChainMap` implementation (L525-627) - backport from Python 3 with full MutableMapping interface

**Utility Functions**
- `which()` implementation (L205-266) for finding executables in PATH, with Windows PATHEXT support
- `python_implementation()` (L308-316) detects PyPy, Jython, IronPython, or CPython
- `callable()` function (L326-327) for Python 3 compatibility
- File system encoding functions `fsencode()`/`fsdecode()` (L346-362) with UTF-8 fallback

**Advanced Compatibility**
- `detect_encoding()` implementation (L383-473) for Python source file encoding detection per PEP 263
- `OrderedDict` backport (L660-909) with full dict interface and order preservation
- Logging configuration classes: `BaseConfigurator`, `ConvertingDict/List/Tuple` (L1005-1137) for dynamic value conversion

## Key Dependencies

- Standard library modules: `os`, `re`, `sys`, `ssl`, `zipfile`, `platform`, `sysconfig`
- Version-specific imports handled via try/except blocks
- Minimal external dependencies - pure compatibility layer

## Architectural Decisions

- Uses feature detection rather than version checks where possible
- Implements complete backports rather than minimal shims for complex features
- Provides drop-in replacements that maintain identical APIs across versions
- Heavy use of `try/except ImportError` pattern for graceful degradation