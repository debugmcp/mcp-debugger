# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/markers.py
@source-hash: 756292aa7e52a7e8
@generated: 2026-02-09T18:01:35Z

## Purpose
Python package dependency marker evaluation system (PEP 508 compliant). Parses and evaluates environment markers like `python_version >= "3.8"` to determine if dependencies should be installed based on current platform/Python environment.

## Core Classes

**Marker (L260-325)**: Main marker evaluation class
- `__init__(marker: str)` (L261): Parses marker string using `_parse_marker`, stores normalized structure in `_markers`
- `evaluate(environment=None)` (L301): Evaluates marker against current/provided environment, returns boolean
- String representation methods for debugging and serialization (L286-299)

**Environment (L49-119)**: TypedDict defining all available environment variables
- Platform info: `os_name`, `platform_machine`, `platform_release`, `platform_system`, `platform_version`
- Python info: `python_version`, `python_full_version`, `implementation_name`, `implementation_version`
- System info: `sys_platform`, `platform_python_implementation`

**Exception Classes (L30-47)**:
- `InvalidMarker`: Invalid marker syntax
- `UndefinedComparison`: Unsupported operation on value
- `UndefinedEnvironmentName`: Referenced environment variable doesn't exist

## Key Functions

**`default_environment()` (L242-257)**: Creates current system's Environment dict by querying `sys`, `os`, `platform` modules

**`_evaluate_markers(markers, environment)` (L204-231)**: Core recursive evaluation logic
- Processes MarkerList structure with AND/OR grouping
- Handles Variable/Value comparisons with operator lookup
- Returns boolean result using `any(all(item) for item in groups)` pattern

**`_eval_op(lhs, op, rhs)` (L177-189)**: Evaluates single comparison operation
- First tries version specifier comparison via `Specifier` class
- Falls back to operator lookup in `_operators` dict (L165-174)

**`_normalize_extra_values(results)` (L121-134)**: Canonicalizes "extra" values per PEP 685
**`_format_marker(marker, first=True)` (L137-162)**: Converts parsed marker back to string representation

## Dependencies
- `._parser`: MarkerAtom, MarkerList, Op, Value, Variable, parse_marker
- `._tokenizer`: ParserSyntaxError  
- `.specifiers`: Specifier, InvalidSpecifier
- `.utils`: canonicalize_name
- Standard library: operator, os, platform, sys, typing

## Architecture Notes
- Marker parsing creates recursive list structure: `List[Union[Tuple[Node, ...], str, MarkerList]]`
- Evaluation uses grouped boolean logic: OR creates new groups, AND stays in current group
- Extra name normalization follows PEP 503/685 standards
- Environment can be partially overridden while preserving defaults
- Handles non-PEP 440 compliant Python versions by appending "+local"