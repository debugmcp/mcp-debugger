# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/cli/autocompletion.py
@source-hash: 2e58b732be9a0cdb
@generated: 2026-02-09T18:01:05Z

This module implements bash completion logic for pip commands, activated via the `pip completion` command.

## Primary Purpose
Provides autocompletion functionality for pip CLI, handling both main commands and subcommand-specific options, as well as intelligent completion for package names and file paths.

## Key Functions

### `autocomplete()` (L15-122)
Main entry point for bash completion. Parses environment variables `COMP_WORDS` and `COMP_CWORD` to determine completion context. Handles three completion scenarios:
- **Subcommand detection**: Scans command words to identify active subcommand
- **Package name completion**: For `show`/`uninstall` commands, suggests locally installed packages matching current input (L47-64)
- **File path completion**: For `install` command, suggests file/directory paths (L66-72)
- **Option completion**: Suggests available command-line options filtered by current input

### `get_path_completion_type()` (L124-145)
Determines if the current completion context expects file paths by examining the previous option's metavar. Returns completion type ("file", "dir", "path") or None based on option metadata.

### `auto_complete_paths()` (L148-176)
Generates file/directory completions based on completion type:
- **"file"/"path"**: Lists both files and directories
- **"dir"**: Lists only directories
- Handles path normalization and access permission checks

## Key Dependencies
- `pip._internal.cli.main_parser.create_main_parser`: Creates pip's main argument parser
- `pip._internal.commands`: Access to pip's command registry and instantiation
- `pip._internal.metadata.get_default_environment`: Queries installed packages

## Architecture Patterns
- **Environment-driven execution**: Only runs when `PIP_AUTO_COMPLETE` environment variable is set
- **Early exits**: Uses `sys.exit(1)` to terminate after printing completions
- **Filtering pipeline**: Progressively filters options based on previous arguments and current input
- **Type-based completion**: Different completion strategies based on option metadata

## Critical Behavior
- Requires bash completion environment variables (`COMP_WORDS`, `COMP_CWORD`)
- Special handling for `help` subcommand (immediate exit)
- Prevents duplicate option suggestions by filtering previously used options
- Case-insensitive package name matching with canonical name normalization