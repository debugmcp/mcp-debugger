# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/pangomarkup.py
@source-hash: e8b2a741cf32878f
@generated: 2026-02-09T17:57:58Z

## Primary Purpose
Pygments formatter for generating Pango Markup output, enabling syntax-highlighted code to be rendered as SVG through Pango's text layout engine.

## Key Components

### PangoMarkupFormatter (L28-83)
Main formatter class inheriting from Pygments' base `Formatter`. Converts syntax-highlighted tokens into Pango Markup format with style tags.

**Key attributes:**
- `name`: 'Pango Markup' (L35)
- `aliases`: ['pango', 'pangomarkup'] (L36) 
- `styles`: Dictionary mapping tokens to (start_tag, end_tag) tuples (L42)

**Core methods:**
- `__init__(**options)` (L39-59): Builds style mapping from token types to Pango markup tags
- `format_unencoded(tokensource, outfile)` (L61-83): Main formatting logic that processes token stream and writes markup

### Utility Functions

#### escape_special_chars(text, table=_escape_table) (L23-25)
Escapes XML special characters (&, <) for safe Pango markup rendering using translation table.

#### _escape_table (L17-20)
Character translation mapping for XML escaping: & → &amp;, < → &lt;

## Dependencies
- `pip._vendor.pygments.formatter.Formatter` (L11): Base formatter class

## Architecture & Patterns

**Style Processing Pattern (L44-59):**
- Iterates through style definitions from theme
- Builds nested markup tags for each style attribute (color, bold, italic, underline)
- Uses reverse nesting for proper tag closure

**Token Streaming Pattern (L67-82):**
- Processes tokens sequentially with type inheritance lookup
- Batches consecutive tokens of same type for efficiency
- Wraps entire output in `<tt>` tags for monospace rendering

## Critical Behavior
- Token type inheritance: walks up token hierarchy until style match found (L68-69)
- Consecutive token optimization: groups same-type tokens to minimize markup overhead (L70-77)
- Proper XML escaping prevents markup injection vulnerabilities
- Maintains proper tag nesting order for complex styles

## Output Format
Generates well-formed Pango Markup XML suitable for rendering with Pango/Cairo libraries, commonly used in GTK applications and SVG generation.