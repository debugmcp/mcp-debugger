# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/metadata/importlib/_envs.py
@source-hash: f001a88db7fb122f
@generated: 2026-02-09T17:57:56Z

## Primary Purpose
Package discovery and environment management for pip's importlib-based metadata backend. Provides functionality to locate, enumerate, and manage Python package distributions across filesystem paths while handling legacy egg formats and wheel files.

## Key Components

### _looks_like_wheel function (L24-31)
Validates if a file path represents a proper wheel package by checking:
- File extension (.whl)
- File existence 
- Filename format matching wheel specification
- Valid ZIP archive structure

### _DistributionFinder class (L34-147)
Core distribution discovery engine that maintains memoization of found package names to prevent duplicates.

**Key attributes:**
- `_found_names` (L50): Set tracking normalized package names to avoid duplicates

**Key methods:**
- `_find_impl(location)` (L52-72): Internal implementation that scans locations for distributions, handles BadMetadata exceptions, and enforces name uniqueness
- `find(location)` (L74-84): Public interface returning BaseDistribution objects from directories or ZIP archives
- `find_linked(location)` (L86-108): Processes egg-link files for setuptools development installations
- `find_eggs(location)` (L134-146): Legacy egg format support using pkg_resources backend
- `_find_eggs_in_dir(location)` (L110-120): Scans directories for .egg files
- `_find_eggs_in_zip(location)` (L122-132): Extracts eggs from ZIP archives

### _emit_egg_deprecation function (L149-156)
LRU-cached warning emitter for deprecated egg format usage, scheduled for removal in pip 24.3.

### Environment class (L159-189)
Main environment interface implementing BaseEnvironment protocol.

**Key methods:**
- `__init__(paths)` (L160-161): Constructor accepting path sequence
- `default()` (L163-165): Class method returning system path environment
- `from_paths(paths)` (L167-171): Factory method with optional path override
- `_iter_distributions()` (L173-181): Orchestrates distribution discovery across all paths using finder
- `get_distribution(name)` (L183-189): Retrieves specific distribution by canonical name

## Dependencies & Architecture
- **Core dependencies**: importlib.metadata, pathlib, zipfile, zipimport
- **pip internals**: BaseDistribution/BaseEnvironment protocols, Distribution wrapper, wheel utilities
- **Legacy support**: pkg_resources backend for egg format compatibility
- **Packaging**: canonicalize_name for name normalization

## Critical Patterns
- **Memoization**: DistributionFinder prevents duplicate packages across search paths
- **Priority ordering**: Higher precedence paths mask lower precedence installations
- **Error resilience**: BadMetadata exceptions handled gracefully with logging
- **Deprecation path**: Egg format support maintained but deprecated

## Key Invariants
- Each normalized package name appears only once in results
- Wheel files are skipped during distribution discovery
- Egg-link resolution follows setuptools compatibility patterns
- Search order: standard distributions → eggs → linked distributions