# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/connection.py
@source-hash: f7693db5dff2e0f1
@generated: 2026-02-09T18:02:03Z

## HTTP/HTTPS Connection Classes for urllib3

This module provides enhanced HTTP and HTTPS connection classes that extend Python's standard library with additional features like SSL/TLS support, proxy handling, and connection pooling compatibility.

### Primary Components

**HTTPConnection (L76-284)** - Enhanced HTTP connection class extending `http.client.HTTPConnection`
- Provides backward compatibility between Python versions
- Configurable socket options (L124) with Nagle's algorithm disabled by default (L106)
- Custom host property handling for FQDN support (L133-159)
- Proxy support with `proxy` and `proxy_config` attributes (L127-128)
- Source address binding capability (L120)
- Custom request method with User-Agent injection (L231-244)
- Chunked encoding support via `request_chunked()` (L246-283)

**HTTPSConnection (L286-533)** - SSL/TLS-enabled connection class extending HTTPConnection
- SSL certificate validation and fingerprint assertion
- Support for custom SSL contexts, client certificates, and CA certificates
- TLS-in-TLS proxy connection support via `_connect_tls_proxy()` (L479-533)
- Automatic system time validation against RECENT_DATE (L385-393)
- Hostname verification with fallback warnings for missing subjectAltName
- Certificate requirement resolution and default SSL context creation

### Key Functions

**_new_conn() (L161-190)** - Creates new socket connections with timeout and error handling
**_match_hostname() (L536-555)** - Custom hostname verification with certificate error enhancement
**_get_default_user_agent() (L558-559)** - Returns urllib3 user agent string

### Configuration Constants

- `port_by_scheme` (L67) - Default ports for HTTP/HTTPS
- `RECENT_DATE` (L71) - Date threshold for system time validation
- `_CONTAINS_CONTROL_CHAR_RE` (L73) - Regex for HTTP method validation

### Error Handling

Comprehensive exception handling for:
- Socket timeouts → ConnectTimeoutError
- Socket errors → NewConnectionError
- SSL certificate mismatches with detailed logging

### Dependencies

Critical imports from urllib3 ecosystem:
- SSL utilities from `.util.ssl_` (L55-62)
- Connection utilities from `.util.connection`
- Exception classes for proper error propagation
- Six library for Python 2/3 compatibility

### Architecture Notes

- Uses composition pattern with `_dns_host` for hostname handling
- Implements verification state tracking via `is_verified` and `proxy_is_verified`
- Graceful SSL fallback with DummyConnection when SSL unavailable (L568-569)
- Control character validation in HTTP methods for security