# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/utils/hashes.py
@source-hash: 68b8409435de100f
@generated: 2026-02-09T18:01:27Z

**Purpose**: Provides hash validation utilities for pip's package integrity verification. Enables computing and validating multiple cryptographic hashes against known-good values during package installation.

**Key Components**:

- **FAVORITE_HASH** (L13): Current recommended hash algorithm (`sha256`), used as default for hash generation
- **STRONG_HASHES** (L18): List of collision-resistant hash algorithms accepted by pip (`sha256`, `sha384`, `sha512`)

**Core Classes**:

- **Hashes** (L21-130): Main hash validation class
  - `__init__` (L27-37): Accepts dict mapping algorithm names to lists of allowed hex digests, sorts values for consistent equality checks
  - `__and__` (L39-56): Intersection operator - returns new Hashes with only common allowed hashes between two instances
  - `digest_count` (L59-60): Property returning total number of allowed digests across all algorithms
  - `is_hash_allowed` (L62-64): Checks if specific hex digest is permitted for given algorithm
  - `check_against_chunks` (L66-87): Core validation method - computes hashes from byte chunks, raises `HashMismatch` if none match allowed values
  - `check_against_file` (L92-98): Validates hashes against file-like object using `read_chunks` utility
  - `check_against_path` (L100-102): Validates hashes against file path by opening in binary mode
  - `has_one_of` (L104-109): Returns true if any provided hash/digest pair is allowed
  - `__bool__` (L111-113): Returns true if any hashes are configured
  - `__eq__` (L115-118): Equality based on internal `_allowed` dict comparison
  - `__hash__` (L120-129): Hash implementation using sorted string representation of all algorithm:digest pairs

- **MissingHashes** (L132-147): Special subclass for handling missing hash scenarios
  - `__init__` (L140-144): Initializes with empty allowed hashes for `FAVORITE_HASH` to force validation failure
  - `_raise` (L146-147): Overrides parent to raise `HashMissing` exception with computed hash value instead of `HashMismatch`

**Dependencies**:
- `hashlib`: Standard library for hash computation
- `pip._internal.exceptions`: Custom exceptions (`HashMismatch`, `HashMissing`, `InstallationError`)
- `pip._internal.utils.misc.read_chunks`: Utility for reading file data in chunks

**Architecture Pattern**: 
Uses strategy pattern with hash algorithm abstraction. The `Hashes` class maintains a registry of allowed digests per algorithm and validates against all configured algorithms. The intersection operator enables combining hash requirements from different sources (e.g., requirements files and lock files).

**Critical Invariants**:
- Hash digests are always stored sorted within each algorithm list for consistent equality checks
- Validation succeeds if ANY configured hash matches (OR logic across algorithms)
- Empty Hashes object (no configured hashes) allows any content
- `MissingHashes` always fails validation to surface computed hashes to users