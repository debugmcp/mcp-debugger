# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/utils/wheel.py
@source-hash: 6f8e368e4c9d1478
@generated: 2026-02-09T18:01:26Z

**Primary Purpose**: Utility module for parsing and validating wheel file metadata and structure, ensuring compatibility with pip's supported wheel format versions.

**Core Constants**:
- `VERSION_COMPATIBLE = (1, 0)` (L14): Defines the maximum compatible wheel format version that pip supports

**Key Functions**:

**`parse_wheel(wheel_zip, name)` (L20-35)**: Main entry point that orchestrates wheel validation. Returns tuple of dist-info directory name and parsed WHEEL metadata. Wraps lower-level parsing functions with unified error handling.

**`wheel_dist_info_dir(source, name)` (L38-66)**: Locates and validates the .dist-info directory within a wheel archive. Ensures exactly one .dist-info directory exists and that its name matches the expected package name (canonicalized). Returns the directory name.

**`read_wheel_metadata_file(source, path)` (L69-75)**: Safe file reader that handles common zip file errors (corruption, missing files, password protection) and converts them to UnsupportedWheel exceptions.

**`wheel_metadata(source, dist_info_dir)` (L78-94)**: Extracts and parses the WHEEL metadata file from the dist-info directory. Handles UTF-8 decoding and uses email.parser.Parser to parse the metadata format. Returns Message object.

**`wheel_version(wheel_data)` (L97-110)**: Extracts and parses the Wheel-Version header from WHEEL metadata. Converts version string to integer tuple for comparison. Validates format and presence.

**`check_compatibility(version, name)` (L113-134)**: Enforces pip's wheel compatibility policy. Raises UnsupportedWheel for major version incompatibilities, warns for minor version differences. Uses VERSION_COMPATIBLE constant for comparison.

**Dependencies**:
- `zipfile.ZipFile`: Core wheel file access
- `email.parser.Parser`: WHEEL metadata parsing (RFC 5322 format)
- `pip._vendor.packaging.utils.canonicalize_name`: Package name normalization
- `pip._internal.exceptions.UnsupportedWheel`: Primary error type for wheel format issues

**Architecture Pattern**: Sequential validation pipeline with early error propagation. Each function handles a specific aspect of wheel validation and bubbles up UnsupportedWheel exceptions with contextual error messages.

**Critical Constraints**:
- Wheel files must contain exactly one .dist-info directory
- .dist-info directory name must match package name (canonicalized)
- WHEEL file must be UTF-8 decodable and contain valid Wheel-Version header
- Major wheel format versions ahead of VERSION_COMPATIBLE are rejected