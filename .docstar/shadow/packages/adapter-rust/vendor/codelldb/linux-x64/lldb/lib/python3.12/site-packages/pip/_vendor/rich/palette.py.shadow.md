# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/palette.py
@source-hash: 9489ef4753830d3d
@generated: 2026-02-09T18:01:48Z

## Primary Purpose
Color palette management for Rich's terminal color system. Provides color storage, indexing, matching algorithms, and visual representation capabilities.

## Key Components

### Palette Class (L11-72)
Core palette container managing RGB color collections with optimized color matching:

**Constructor (L14-15)**: Accepts sequence of RGB tuples, stores as `_colors`

**Indexing (L17-18)**: `__getitem__` returns ColorTriplet objects for palette access

**Visual Representation (L20-41)**: `__rich__` method generates Rich Table with color swatches, showing index, RGB values, and visual color blocks

**Color Matching (L44-72)**: `match()` method finds closest palette color using weighted Euclidean distance:
- Uses LRU cache (maxsize=1024) for performance optimization
- Implements perceptually-weighted RGB distance calculation accounting for human color sensitivity
- Red-mean formula considers human eye's varying sensitivity across red spectrum (L61-69)
- Returns index of best matching color

### Demo Code (L75-100)
Standalone color gradient demonstration when run as main module:
- `ColorBox` class (L83-97) generates HLS color space gradient display
- Uses colorsys for HSL-to-RGB conversion
- Renders terminal color gradient using Unicode block characters

## Dependencies
- `math.sqrt`: Distance calculations
- `functools.lru_cache`: Performance optimization
- `ColorTriplet`: RGB color representation
- Rich modules (table, color, style, text): Visual formatting

## Architectural Patterns
- Implements Rich protocol via `__rich__()` for seamless integration
- Uses caching strategy for expensive color matching operations
- Separates storage (tuples) from access interface (ColorTriplet)
- Optimizes inner loop performance by caching frequently-used functions (L55-56)

## Critical Algorithms
The color matching algorithm (L58-69) uses a perceptually-weighted distance metric that accounts for human color vision characteristics, particularly red sensitivity variations across the spectrum.