# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/database.py
@source-hash: d15f50becd15af16
@generated: 2026-02-09T18:01:38Z

This module implements PEP 376 metadata standards for Python package distribution management. It provides classes for representing and working with installed Python packages, both modern (.dist-info) and legacy (.egg-info) formats.

## Primary Purpose
The file serves as a complete distribution database system, handling package discovery, metadata parsing, dependency resolution, and file management for Python packages. It acts as the core layer between package managers and the underlying filesystem structure.

## Core Classes

**_Cache (L44-73)**: Simple cache mapping distribution names/paths to distribution objects. Maintains `name` and `path` dictionaries plus `generated` flag. Used internally by DistributionPath for performance optimization.

**DistributionPath (L75-325)**: Main entry point for package discovery on sys.path. Scans directories for .dist-info/.egg-info and creates distribution instances. Key methods:
- `get_distributions()` (L210-230): Returns iterator of all found distributions
- `get_distribution(name)` (L232-256): Finds specific distribution by name
- `_yield_distributions()` (L115-167): Core discovery logic scanning filesystem

**Distribution (L327-481)**: Base class for all distribution types. Wraps Metadata object and provides:
- Basic properties: name, version, provides, requires variants (L378-416)
- `matches_requirement(req)` (L418-449): Version matching logic
- Equality/hashing based on name, version, source_url

**BaseInstalledDistribution (L483-536)**: Abstract base for installed packages. Adds path tracking and hash computation via `get_hash()` (L506-535).

**InstalledDistribution (L538-865)**: Modern PEP 376 .dist-info packages. Features:
- RECORD file parsing for installed files tracking (L589-610, L672-680)
- Export entries management (L612-650) 
- File integrity checking (L717-751)
- Resource/shared location management (L652-803)

**EggInfoDistribution (L867-1090)**: Legacy .egg/.egg-info package support. Handles setuptools-style metadata and requirements parsing (L898-990).

**DependencyGraph (L1097-1238)**: Represents package dependency relationships as adjacency lists. Provides topological sorting (L1202-1231) and DOT output (L1170-1200).

## Key Functions

**make_graph(dists, scheme)** (L1241-1292): Constructs dependency graph from distribution list, resolving requirements against provided packages.

**get_dependent_dists/get_required_dists** (L1295-1347): Recursive dependency traversal utilities.

**make_dist(name, version, **kwargs)** (L1350-1359): Convenience factory for creating Distribution instances.

## Constants & Configuration
- `DIST_FILES` (L38-39): Valid .dist-info file names
- `DISTINFO_EXT` (L41): .dist-info extension constant
- `EXPORTS_FILENAME`, `COMMANDS_FILENAME` (L35-36): Entry point file names
- `new_dist_class`/`old_dist_class` (L1093-1094): Aliases for distribution types

## Architecture Notes
- Heavy use of resources.finder_for_path() for filesystem abstraction
- Caching system enables efficient repeated queries
- Supports both ZIP-based and directory-based package layouts
- Exception handling for malformed/missing metadata with warning fallbacks
- CSV reading/writing for RECORD files using custom CSVReader/CSVWriter utilities

The module integrates tightly with distlib's metadata, version, and utility modules to provide a complete package management foundation.