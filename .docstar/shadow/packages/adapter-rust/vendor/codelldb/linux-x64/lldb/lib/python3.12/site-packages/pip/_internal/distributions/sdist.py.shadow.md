# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/distributions/sdist.py
@source-hash: 3e570fe1aebe47a7
@generated: 2026-02-09T18:01:12Z

## Purpose
Implements source distribution handling for pip's internal package installation system. Manages the complex process of preparing source distributions by handling PEP 517/518 build backends, build isolation, and dependency resolution.

## Core Classes

### SourceDistribution (L16-158)
Concrete implementation of `AbstractDistribution` for source packages that require building. Orchestrates the entire source distribution preparation workflow including:
- Build backend initialization and isolation
- Dynamic build requirement discovery and installation  
- Metadata generation via PEP 517 or legacy `setup.py egg_info`
- Conflict detection and resolution

**Key Methods:**
- `build_tracker_id` (L24-27): Returns unique identifier from package link URL
- `get_metadata_distribution()` (L29-30): Retrieves distribution metadata
- `prepare_distribution_metadata()` (L32-69): Main orchestration method handling build isolation, dependency checks, and metadata preparation
- `_prepare_build_backend()` (L71-95): Sets up isolated build environment and installs static build requirements
- `_install_build_reqs()` (L115-132): Installs dynamic build requirements after querying backend
- `_get_build_requires_wheel()` (L97-103): Queries backend for wheel build dependencies
- `_get_build_requires_editable()` (L105-113): Queries backend for editable build dependencies

## Dependencies
- `pip._internal.build_env.BuildEnvironment`: Provides build isolation
- `pip._internal.distributions.base.AbstractDistribution`: Base class
- `pip._internal.exceptions.InstallationError`: Error handling
- `pip._internal.utils.subprocess.runner_with_spinner_message`: Process execution with UI feedback

## Architecture Decisions
- **Two-phase dependency installation**: Static pyproject.toml requirements first, then dynamic backend-discovered requirements
- **Conditional build isolation**: Only isolates when using PEP 517 and isolation is requested
- **Editable package support**: Special handling for PEP 660 editable wheels vs traditional editable installs
- **Comprehensive conflict detection**: Checks both missing and conflicting dependencies at multiple stages

## Critical Flow
1. Load pyproject.toml to determine PEP 517 usage
2. Conditionally set up build isolation and install static requirements
3. Perform editable package sanity checks
4. Install dynamic build requirements discovered from backend
5. Check for dependency conflicts throughout process
6. Generate package metadata

## Error Handling
- `_raise_conflicts()` (L134-149): Formats and raises conflicts between installed and required packages
- `_raise_missing_reqs()` (L151-158): Formats and raises missing dependency errors