# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/idna/intranges.py
@source-hash: 601af87d162e587e
@generated: 2026-02-09T18:01:28Z

## Purpose
Efficient integer set representation and membership testing using compressed ranges. Converts lists of integers into compact range tuples and provides O(log n) membership queries using binary search.

## Core Functions

**`intranges_from_list(list_: List[int]) -> Tuple[int, ...]` (L11-30)**
- Compresses integer lists into consecutive ranges for space efficiency
- Algorithm: sorts input, identifies consecutive sequences, encodes as (start, end) pairs
- Returns tuple of encoded ranges where each range is a single 64-bit integer
- Key insight: ranges are half-open intervals [start, end)

**`intranges_contain(int_: int, ranges: Tuple[int, ...]) -> bool` (L39-54)**
- Fast O(log n) membership testing using binary search on encoded ranges
- Uses `bisect.bisect_left()` to locate potential containing range
- Checks both adjacent positions for boundary conditions
- Handles edge cases where query integer could be at range start or within previous range

## Encoding Utilities

**`_encode_range(start: int, end: int) -> int` (L32-33)**
- Packs two 32-bit integers into single 64-bit value: `(start << 32) | end`
- Enables efficient storage and comparison of range pairs

**`_decode_range(r: int) -> Tuple[int, int]` (L35-36)**
- Unpacks encoded range back to (start, end) tuple
- Uses bit masking: `(r >> 32, r & 0xFFFFFFFF)`

## Dependencies
- `bisect`: Binary search for efficient range lookup
- `typing`: Type annotations for List and Tuple

## Architecture Notes
- Optimized for sparse integer sets with long consecutive runs
- Trade-off: O(n) preprocessing for O(log k) queries (k = number of ranges)
- Memory efficient: reduces storage from O(n) integers to O(k) ranges
- Binary search leverages natural ordering of encoded ranges

## Critical Invariants
- Input ranges must be sorted for binary search correctness
- Ranges are half-open intervals: [start, end)
- Encoded ranges maintain lexicographic ordering for bisect compatibility
- Range endpoints are inclusive-start, exclusive-end