# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/groff.py
@source-hash: c72f197f7b573a8e
@generated: 2026-02-09T17:58:00Z

## Purpose
Pygments formatter that outputs syntax-highlighted code using groff/troff markup language for document preparation systems like man pages and technical documentation.

## Core Components

### GroffFormatter (L18-170)
Primary formatter class inheriting from `pip._vendor.pygments.formatter.Formatter`. Converts tokenized source code into groff markup with color, font styling, and optional line numbering.

**Configuration Options:**
- `monospaced` (L48): Boolean flag for monospace font usage (default: True)
- `linenos` (L49): Boolean flag for line number display (default: False) 
- `wrap` (L51): Integer for line wrapping width (default: 0, disabled)

**State Variables:**
- `_lineno` (L50): Current line number counter
- `_linelen` (L52): Current line length for wrap calculations
- `styles` (L54): Dictionary mapping token types to groff markup pairs

### Key Methods

**_make_styles() (L58-78)**
Builds style mapping from Pygments token types to groff escape sequences. Generates start/end markup pairs for:
- Font styles: regular (`\f[CR]`/`\f[R]`), bold (`\f[CB]`/`\f[B]`), italic (`\f[CI]`/`\f[I]`)
- Colors: foreground (`\m[color]`) and background (`\M[color]`)

**_define_colors() (L81-88)**
Extracts unique colors from style definitions and outputs groff color definitions using `.defcolor` directives.

**_write_lineno() (L91-93)**
Outputs formatted line numbers with conditional newline handling for multi-line content.

**_wrap_line() (L96-116)**
Handles line wrapping logic when `wrap > 0`. Calculates chunks, handles remainders, and maintains line length state for continuation lines.

**_escape_chars() (L119-135)**
Escapes special groff characters and converts Unicode characters to groff escape sequences. Handles backslashes, dots, quotes, tildes, and multi-byte Unicode characters.

**format_unencoded() (L138-170)**
Main formatting entry point. Processes token stream and outputs:
1. Color definitions via `_define_colors()`
2. Groff directives (`.nf` for no-fill mode, `\f[CR]` for font)
3. Formatted tokens with style markup and optional line numbers
4. Closing `.fi` directive

## Dependencies
- `math` (L11): For floor division in line wrapping
- `pip._vendor.pygments.formatter.Formatter` (L12): Base formatter class
- `pip._vendor.pygments.util` (L13): Option parsing utilities (`get_bool_opt`, `get_int_opt`)

## Architecture Notes
- Token type inheritance: Uses parent token types as fallback when specific styles don't exist (L147-148)
- Stateful processing: Maintains line numbering and wrapping state across token boundaries
- Groff-specific markup: Generates proper groff escape sequences for fonts, colors, and special characters