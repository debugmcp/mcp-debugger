# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/url.py
@source-hash: 942004ecce66c80f
@generated: 2026-02-09T17:58:08Z

## Purpose
URL parsing and normalization utilities for urllib3, providing RFC 3986 and RFC 6874 compliant URL handling with support for IPv4/IPv6 addresses, percent encoding, and IDNA domain names.

## Key Components

### Data Structures
- **Url (L82-173)**: Immutable namedtuple for structured URL representation with fields: scheme, auth, host, port, path, query, fragment
  - `__new__` (L91-107): Normalizes scheme to lowercase, ensures paths start with "/"
  - `hostname` property (L110-112): Backwards-compatibility alias for host
  - `request_uri` property (L115-122): Returns absolute path with query string
  - `netloc` property (L125-129): Returns host:port or just host
  - `url` property (L132-169): Reconstructs full URL string from components

### Core Functions
- **parse_url (L333-427)**: Main URL parsing function that handles incomplete URLs, normalizes components, and returns Url namedtuple
- **get_host (L430-435)**: Deprecated wrapper returning (scheme, hostname, port) tuple

### Helper Functions
- **split_first (L175-207)**: DEPRECATED - Splits string on first occurrence of any delimiter
- **_encode_invalid_chars (L210-241)**: Percent-encodes URI components while preserving existing encodings
- **_remove_path_dot_segments (L244-271)**: Normalizes paths by resolving "." and ".." segments per RFC 3986
- **_normalize_host (L274-302)**: Normalizes hostnames including IPv6 zone ID handling and IDNA encoding
- **_idna_encode (L305-320)**: Encodes internationalized domain names using IDNA
- **_encode_target (L323-330)**: Percent-encodes request targets (path + query)

### Regular Expressions & Constants
- **URI_RE (L19-26)**: Main URI parsing regex with capture groups for all components
- **IPV4_RE, IPV6_RE, IPV6_ADDRZ_RE (L60-63)**: IP address validation patterns
- **SCHEME_RE (L18)**: Detects presence of scheme or absolute path
- **TARGET_RE (L58)**: Parses request target into path and query
- **Character Sets (L73-79)**: Defines allowed characters for different URI components per RFC 3986

### Key Patterns
- Graceful handling of malformed URLs with best-effort parsing
- Automatic scheme normalization to lowercase
- IPv6 zone ID support with proper percent-encoding
- Path normalization removing dot segments
- Backwards compatibility with Python 2/3 and urlparse module
- IDNA support for internationalized domain names with graceful fallback

### Dependencies
- Uses `six` for Python 2/3 compatibility
- Optional `idna` module for internationalized domain names
- Raises `LocationParseError` for unparseable URLs

### Critical Invariants
- Parsed URLs always have normalized schemes (lowercase)
- Paths in Url objects always start with "/" if present
- Port numbers validated to be within 0-65535 range
- Percent-encoding preserves existing valid encodings