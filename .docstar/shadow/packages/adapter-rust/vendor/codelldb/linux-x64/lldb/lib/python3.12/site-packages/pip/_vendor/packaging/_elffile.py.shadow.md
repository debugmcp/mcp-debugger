# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/_elffile.py
@source-hash: fcb7095b860d2b2c
@generated: 2026-02-09T18:01:30Z

## Purpose
ELF (Executable and Linkable Format) file parser providing read-only access to ELF executables. Implements a ZipFile-like interface for parsing binary executables on Unix-like systems.

## Core Components

### Exception Classes
- `ELFInvalid` (L19-20): ValueError subclass for ELF parsing errors

### Enum Classes  
- `EIClass` (L23-25): ELF class/bitness constants (32-bit=1, 64-bit=2)
- `EIData` (L28-30): Endianness constants (LSB=1, MSB=2)
- `EMachine` (L33-38): CPU architecture constants (I386, ARM, x86_64, AArch64, S390)

### Main Parser Class
- `ELFFile` (L41-110): Primary ELF parser class
  - `__init__` (L46-90): Parses ELF header, validates magic bytes, determines format
  - `_read` (L92-93): Helper for struct unpacking from file stream
  - `interpreter` property (L95-109): Extracts PT_INTERP section path

## Key Architecture Decisions

### Format Detection Strategy (L64-69)
Uses tuple lookup table mapping (capacity, encoding) to appropriate struct formats:
- 32-bit LSB/MSB: Different format strings and field indexes
- 64-bit LSB/MSB: Handles pointer size differences
- Stores `_p_fmt` and `_p_idx` for subsequent section parsing

### Header Parsing Flow
1. Read 16-byte identification header
2. Validate ELF magic bytes (`\x7fELF`)  
3. Extract capacity (bitness) and encoding (endianness)
4. Select appropriate struct format based on architecture
5. Parse remaining header fields (machine type, program header offset, etc.)

### Section Traversal (L100-109)
Iterates through program headers to find PT_INTERP (type=3) section, seeking to offset and reading null-terminated interpreter path.

## Dependencies
- `struct`: Binary data parsing
- `os`: Path decoding via `os.fsdecode`
- `enum`: Type-safe constants
- `typing.IO`: File handle typing

## Critical Constraints
- Read-only access (no write operations)
- Requires valid ELF magic bytes for initialization
- Architecture-specific format handling mandatory
- File must remain open for interpreter property access