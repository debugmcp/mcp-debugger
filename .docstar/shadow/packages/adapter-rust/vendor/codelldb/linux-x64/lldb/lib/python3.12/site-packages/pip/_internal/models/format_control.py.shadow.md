# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/models/format_control.py
@source-hash: c2db10a922bd1da5
@generated: 2026-02-09T18:01:12Z

## Primary Purpose
Manages installation format constraints for Python packages, controlling whether packages can be installed from binary wheels or source distributions.

## Key Classes and Functions

### FormatControl (L8-78)
Core class managing binary/source format restrictions with two complementary sets:
- `no_binary` (L23): Set of package names that cannot be installed from binary wheels
- `only_binary` (L24): Set of package names that can only be installed from binary wheels

**Constructor** (L13-24): Initializes both sets, defaulting to empty sets if None provided.

**Equality Methods** (L26-33): Implements `__eq__` using slot-based comparison for efficient equality checking.

**String Representation** (L35-36): Provides readable format showing both sets.

### Static Method: handle_mutual_excludes (L38-59)
Processes comma-separated format control strings with special tokens:
- `:all:` - applies restriction to all packages, clears opposing set
- `:none:` - clears the target set
- Regular package names are canonicalized and added to target set while removed from opposing set

Validates input format and raises CommandError for malformed arguments (L40-43).

### Instance Methods

**get_allowed_formats** (L61-71): Returns frozenset of allowed formats ("binary", "source") for a given canonical package name. Applies precedence rules:
1. Specific package restrictions override global ones
2. `:all:` tokens apply globally when no specific restriction exists

**disallow_binaries** (L73-78): Convenience method that disallows binary installation for all packages using the `:all:` token.

## Dependencies
- `pip._vendor.packaging.utils.canonicalize_name`: Standardizes package names
- `pip._internal.exceptions.CommandError`: Error handling for invalid inputs

## Architectural Patterns
- Uses `__slots__` for memory efficiency
- Mutual exclusion logic ensures consistency between binary/source preferences
- Special token system (`:all:`, `:none:`) provides powerful bulk operations
- Immutable return types (frozenset) prevent external modification

## Critical Invariants
- `no_binary` and `only_binary` sets are mutually exclusive for any given package
- `:all:` token takes precedence and clears opposing restrictions
- Package names are always canonicalized before storage/lookup