# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/requests/adapters.py
@source-hash: 27b55e571281bdac
@generated: 2026-02-09T18:01:46Z

## Primary Purpose
Transport adapters module for the Requests library, providing HTTP/HTTPS connection management and request handling through urllib3. Implements the adapter pattern to abstract connection pooling, SSL/TLS verification, proxy handling, and response building.

## Key Components

### Constants (L71-74)
- `DEFAULT_POOLBLOCK`, `DEFAULT_POOLSIZE`, `DEFAULT_RETRIES`, `DEFAULT_POOL_TIMEOUT`: Configuration defaults for connection pooling
- `_preloaded_ssl_context` (L80-87): Pre-configured SSL context with default CA bundle for performance optimization

### Core Functions

#### `_urllib3_request_context()` (L90-134)
Builds urllib3 connection parameters from request context. Handles SSL context selection, certificate verification settings, and client certificate configuration. Returns tuple of host parameters and pool kwargs for connection establishment.

### Base Classes

#### `BaseAdapter` (L137-164)
Abstract base class defining the adapter interface. Provides `send()` and `close()` methods that must be implemented by subclasses.

### Main Implementation

#### `HTTPAdapter` (L167-719)
Primary HTTP adapter implementation extending BaseAdapter. Key responsibilities:

**Initialization & State Management:**
- `__init__()` (L202-222): Configures pool settings, retry logic, and initializes poolmanager
- `__getstate__()` / `__setstate__()` (L224-238): Pickle support for serialization
- `init_poolmanager()` (L240-264): Creates urllib3 PoolManager for connection pooling

**Connection Management:**
- `proxy_manager_for()` (L266-302): Returns cached or new ProxyManager for given proxy URL. Handles SOCKS and HTTP proxies differently
- `get_connection_with_tls_context()` (L446-493): Primary connection method with TLS context support
- `get_connection()` (L495-534): DEPRECATED legacy connection method with deprecation warning

**SSL/TLS Handling:**
- `cert_verify()` (L304-357): Configures SSL certificate verification on connections. Handles CA bundles, client certificates, and verification modes
- `build_connection_pool_key_attributes()` (L396-444): Wrapper for `_urllib3_request_context()` to build pool key attributes

**Request Processing:**
- `send()` (L613-719): Main request execution method. Handles connection establishment, SSL verification, timeout processing, and comprehensive exception mapping from urllib3 to requests exceptions
- `request_url()` (L546-576): Determines final request URL based on proxy configuration
- `add_headers()` (L578-590): Hook for adding connection-specific headers (no-op in base implementation)
- `proxy_headers()` (L592-611): Builds proxy authentication headers

**Response Building:**
- `build_response()` (L359-394): Converts urllib3 response to requests Response object. Handles status codes, headers, encoding, cookies, and URL handling

**Cleanup:**
- `close()` (L536-544): Disposes poolmanager and proxy managers

## Dependencies
- urllib3: Core HTTP client library for connection pooling and request handling
- requests internal modules: auth, models, exceptions, utils for request/response processing
- SSL/TLS support with fallback handling for environments without ssl module

## Architectural Patterns
- Adapter pattern: Abstracts urllib3 implementation details from requests
- Connection pooling: Reuses HTTP connections for performance
- Exception translation: Maps urllib3 exceptions to requests exception hierarchy
- Lazy initialization: SSL contexts and proxy managers created on-demand

## Critical Constraints
- Thread-safe connection pooling through urllib3
- SSL context reuse for performance optimization
- Proper cleanup of pooled connections on adapter disposal
- Backward compatibility maintenance for deprecated methods