# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/response.py
@source-hash: 7e60c9005906ef5b
@generated: 2026-02-09T18:02:08Z

## Purpose
HTTP response handling and content decoding for urllib3. Provides the main `HTTPResponse` class for wrapping HTTP responses with automatic content decoding, streaming, and connection management.

## Key Classes

**DeflateDecoder (L35-65)**: Handles deflate/zlib decompression with fallback handling for raw deflate vs zlib-wrapped deflate formats. Uses `_first_try` flag to attempt standard decompression first, then falls back to raw deflate on error.

**GzipDecoder (L74-102)**: Multi-member gzip decompression handler with state machine (`GzipDecoderState`) to track processing phases (FIRST_MEMBER, OTHER_MEMBERS, SWALLOW_DATA). Handles concatenated gzip streams and trailing garbage.

**BrotliDecoder (L106-121)**: Optional Brotli decompression wrapper supporting both 'brotlipy' and 'Brotli' packages. Only instantiated if `brotli` module is available.

**MultiDecoder (L123-142)**: Handles multiple content encodings applied in sequence (e.g., "gzip, deflate"). Applies decoders in reverse order per RFC7231.

**HTTPResponse (L157-879)**: Main response container extending `io.IOBase`. Provides:
- Lazy content loading and decoding
- Streaming capabilities with chunked transfer encoding support
- Connection pooling integration
- Backward compatibility with `http.client.HTTPResponse`

## Key Methods

**HTTPResponse.__init__ (L195-261)**: Comprehensive initialization handling headers, status, content length calculation, chunked encoding detection, and optional preloading.

**HTTPResponse.read (L529-599)**: Main content reading method with decode/cache options. Handles content length validation, decoder initialization, and partial reads.

**HTTPResponse.stream (L601-626)**: Generator for streaming content in chunks. Automatically uses chunked reading for chunked responses.

**HTTPResponse.read_chunked (L783-851)**: Specialized chunked transfer encoding reader with chunk length parsing and CRLF handling.

**HTTPResponse._fp_read (L481-527)**: Low-level file reading with overflow protection for large reads on certain Python/SSL combinations.

**HTTPResponse._error_catcher (L425-480)**: Context manager converting low-level exceptions to urllib3 exceptions and managing connection cleanup.

## Dependencies
- `zlib` for deflate/gzip decompression
- Optional `brotli` for Brotli decompression  
- `._collections.HTTPHeaderDict` for header management
- `.util.response` utilities for response validation
- `.exceptions` for urllib3-specific exception types

## Key Constants
- `CONTENT_DECODERS` (L190-192): Supported content encodings
- `REDIRECT_STATUSES` (L193): HTTP redirect status codes
- `DECODER_ERROR_CLASSES` (L388-390): Exception types for decode errors

## Architecture Notes
- Decoder pattern with pluggable decompression algorithms
- State-based chunked transfer handling
- Lazy initialization of decoders only when needed
- Connection pooling integration through `_pool` and `_connection` attributes
- Comprehensive error handling with urllib3-specific exceptions