# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/cachecontrol/cache.py
@source-hash: 393423ef6b547fc0
@generated: 2026-02-09T18:01:23Z

## Cache API Abstraction Layer

This module defines a cache abstraction layer for HTTP caching with three distinct cache implementations, providing a pluggable caching system for the pip HTTP client.

### Core Components

**BaseCache (L18-32)** - Abstract base class defining the standard cache interface:
- `get(key: str) -> bytes | None` (L19-20) - Retrieves cached value by key
- `set(key: str, value: bytes, expires: int | datetime | None = None) -> None` (L22-25) - Stores value with optional expiration
- `delete(key: str) -> None` (L27-28) - Removes cached entry
- `close() -> None` (L30-31) - Cleanup method (no-op in base implementation)

**DictCache (L34-51)** - Thread-safe in-memory dictionary cache implementation:
- Uses `threading.Lock` (L36) for thread safety during write operations
- Stores data in `self.data` dictionary (L37) - can accept initial dictionary
- `get()` (L39-40) is lock-free for read performance
- `set()` (L42-46) and `delete()` (L48-51) use lock protection
- Ignores expiration parameter (no TTL support)

**SeparateBodyBaseCache (L54-74)** - Abstract cache variant for separating metadata from response bodies:
- Extends BaseCache with body-specific methods
- `set_body(key: str, body: bytes) -> None` (L67-68) - Stores response body separately
- `get_body(key: str) -> IO[bytes] | None` (L70-74) - Returns body as file-like object
- Designed for two-phase caching: metadata first, then body

### Key Dependencies

- `threading.Lock` for thread synchronization
- `typing` annotations for type safety
- Optional `datetime` import for expiration handling

### Architectural Patterns

- **Strategy Pattern**: Multiple cache implementations behind common interface
- **Template Method**: BaseCache defines interface, subclasses implement specifics
- **Separation of Concerns**: SeparateBodyBaseCache isolates body storage from metadata
- **Thread Safety**: Explicit locking in DictCache for concurrent access

### Usage Context

Part of pip's HTTP caching infrastructure, likely used by CacheControl middleware to store HTTP responses with proper cache semantics and thread safety guarantees.