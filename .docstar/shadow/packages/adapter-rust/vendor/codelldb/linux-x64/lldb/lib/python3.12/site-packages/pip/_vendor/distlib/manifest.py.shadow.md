# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/manifest.py
@source-hash: dea7e6026570c51a
@generated: 2026-02-09T18:01:35Z

## Manifest Class for File Distribution Management

**Purpose**: Implements a file manifest system for Python distributions, equivalent to distutils.filelist but with fixes. Manages file inclusion/exclusion patterns compatible with MANIFEST.in format.

### Core Class
- **Manifest (L38-395)**: Main class representing a list of files in a distribution, built by filesystem exploration and filtered by patterns

### Key Attributes
- `base` (L50): Absolute base directory path
- `prefix` (L51): Base directory with trailing separator
- `allfiles` (L52): List of all discovered files (populated by `findall()`)
- `files` (L53): Set of files matching inclusion patterns

### Public API Methods

**File Discovery**:
- `findall()` (L59-85): Recursively discovers all regular files under base directory, avoiding symlinked directories. Uses stack-based traversal for efficiency.

**File Management**:
- `add(item)` (L86-94): Adds single file to manifest, handles relative paths
- `add_many(items)` (L96-103): Bulk adds multiple files
- `clear()` (L127-130): Resets both files and allfiles collections
- `sorted(wantdirs=False)` (L105-125): Returns sorted file list with optional directory inclusion

**Pattern Processing**:
- `process_directive(directive)` (L132-194): Main entry point for processing MANIFEST.in-style directives. Supports: include, exclude, global-include, global-exclude, recursive-include, recursive-exclude, graft, prune

### Private Implementation Methods

**Directive Parsing**:
- `_parse_directive(directive)` (L200-245): Validates and parses directive syntax, returns action/patterns tuple

**Pattern Matching**:
- `_include_pattern(pattern, anchor, prefix, is_regex)` (L247-286): Adds files matching pattern to manifest
- `_exclude_pattern(pattern, anchor, prefix, is_regex)` (L288-306): Removes files matching pattern from manifest
- `_translate_pattern(pattern, anchor, prefix, is_regex)` (L308-361): Converts shell patterns to compiled regex objects
- `_glob_to_re(pattern)` (L363-384): Translates glob patterns to regex, differs from fnmatch by not matching path separators

### Dependencies
- Standard library: fnmatch, logging, os, re, sys
- Internal: DistlibException, fsdecode, convert_path

### Architecture Notes
- Uses lazy loading for `allfiles` (populated on first pattern match)
- Platform-aware path separator handling for regex construction
- Python version compatibility handling for fnmatch.translate differences (L35, L323-359)
- Recursive directory walking uses manual stack to avoid recursion limits

### Key Patterns
- **Lazy Loading**: File discovery deferred until needed
- **Pattern Translation**: Shell globs â†’ regex with platform-specific separator handling  
- **Anchor/Prefix Logic**: Flexible pattern matching modes for different use cases
- **Set-based File Management**: Efficient add/remove operations using Python sets