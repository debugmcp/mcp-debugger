# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py
@source-hash: f61ad3c90a85be5f
@generated: 2026-02-09T17:57:59Z

## Purpose and Responsibility
This module provides lazy candidate iteration utilities for pip's dependency resolution process. It optimizes performance by deferring expensive operations (fetching, extracting, building) until candidates are actually needed, preventing unnecessary downloads during resolution.

## Key Classes and Functions

### FoundCandidates (L127-174)
Primary lazy sequence class implementing `SequenceCandidate` interface. Provides controlled iteration over package candidates with three distinct behaviors based on installation status and preferences:
- **Constructor (L136-146)**: Takes candidate info getter function, installed candidate, preference flag, and incompatible IDs set
- **__iter__ (L154-162)**: Returns filtered iterator based on installation state and preferences
- **__bool__ (L170-174)**: Cached boolean check with short-circuit for preferred installed candidates
- **__getitem__/__len__ (L148-168)**: Deliberately raise NotImplementedError to prevent inefficient access patterns

### Iterator Functions
Three specialized iteration strategies for different resolution scenarios:

**_iter_built (L42-71)**
- Used when no package is currently installed
- Deduplicates by version, handles MetadataInvalid exceptions
- Logs warnings for invalid metadata with pip version guidance (L55-62)

**_iter_built_with_prepended (L73-93)**
- Used when resolver prefers existing installation (no upgrade)
- Yields installed candidate first, then index candidates
- Skips duplicate versions already found

**_iter_built_with_inserted (L95-125)**
- Used when resolver prefers to upgrade existing installation
- Inserts installed candidate at appropriate position in version ordering
- Handles edge case where installed version is older than all candidates (L122-124)

## Key Dependencies
- `pip._vendor.packaging.version._BaseVersion`: Version comparison and deduplication
- `pip._internal.exceptions.MetadataInvalid`: Error handling for corrupt package metadata
- `.base.Candidate`: Core candidate interface

## Type Definitions
- `IndexCandidateInfo` (L24): Tuple of version and candidate factory function
- `SequenceCandidate` (L27-39): Compatibility shim for Python <3.9 generic type support

## Architectural Patterns
- **Lazy Evaluation**: All candidate creation deferred until iteration
- **Strategy Pattern**: Three iterator functions handle different resolution preferences
- **Generator Pattern**: All iterators yield candidates on-demand
- **Caching**: LRU cache on `__bool__` method prevents redundant evaluations
- **Error Recovery**: Graceful handling of invalid metadata with user guidance

## Critical Invariants
- Version deduplication across all iterator strategies
- Installed candidate preference respected in ordering
- Incompatible candidates filtered out via ID blacklist
- Performance-critical operations (indexing, length) deliberately disabled