# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/distro/distro.py
@source-hash: 5ea6de7da7008434
@generated: 2026-02-09T18:01:40Z

## Primary Purpose and Responsibility

Linux distribution detection library that provides reliable, machine-readable OS distribution information. Serves as modern replacement for deprecated `platform.linux_distribution()` function, gathering data from multiple sources (os-release files, lsb_release command, distro release files, uname).

## Key Classes and Functions

### Core Classes

**LinuxDistribution (L649-1357)**: Main class that encapsulates distribution detection logic
- Constructor parameters control data source inclusion (lsb, uname, oslevel)
- Supports custom root directory for chrooted environments  
- Uses cached properties to avoid re-parsing files
- Key methods: `id()`, `name()`, `version()`, `codename()`, `like()`

### TypedDict Definitions

**VersionDict (L61-65)**: Type structure for version components (major, minor, build_number)
**InfoDict (L67-73)**: Complete distribution info structure including id, version, version_parts, like, codename

### Module-Level API Functions (L160-626)

All functions delegate to global `_distro` instance (L1359):
- `linux_distribution()` (L160): Deprecated compatibility function
- `id()` (L203): Returns normalized distribution ID 
- `name()` (L287): Distribution name with optional pretty formatting
- `version()` (L326): Version string with best/pretty options
- `version_parts()` (L374): Tuple of (major, minor, build_number)
- `codename()` (L447): Distribution codename
- `info()` (L471): Complete info as InfoDict
- Data source accessors: `os_release_info()`, `lsb_release_info()`, `distro_release_info()`, `uname_info()`

## Data Source Hierarchy and Processing

### Normalization Tables (L86-115)
- `NORMALIZED_OS_ID`: Maps os-release ID variants to canonical values
- `NORMALIZED_LSB_ID`: Maps lsb_release distributor IDs  
- `NORMALIZED_DISTRO_ID`: Maps release file basename patterns

### Parsing Logic
- **OS Release**: `_parse_os_release_content()` (L1104) uses shlex for shell-like parsing
- **LSB Release**: `_parse_lsb_release_content()` (L1173) parses colon-separated output
- **Distro Release**: `_parse_distro_release_content()` (L1334) uses reversed regex pattern
- **Uname**: `_parse_uname_content()` (L1229) extracts name/version from kernel info

### File Discovery (L1252-1309)
- Searches `/etc` for release files matching patterns
- Ignores known non-distribution files (L147-157)
- Falls back to common basenames list (L126-144) if directory unreadable

## Dependencies and Architecture

**External Dependencies**: argparse, json, logging, os, re, shlex, subprocess, sys, warnings
**Python Version Compatibility**: Includes fallbacks for Python 3.7 (TypedDict, cached_property)

### Cached Property Implementation (L633-647)
Custom `cached_property` decorator for Python <3.8 compatibility - stores computed values in `__dict__`

## Critical Patterns and Constraints

### Data Source Priority Order
1. os-release file (`/etc/os-release` or `/usr/lib/os-release`)
2. lsb_release command output  
3. Distribution-specific release files in `/etc`
4. uname command output
5. AIX oslevel command (AIX only)
6. Debian version file (Debian derivatives)

### Version Selection Strategy
- **best=False**: First non-empty version in priority order
- **best=True**: Most precise version (highest dot count) across all sources

### Security Constraint (L784-789)
Prevents subprocess execution when using custom root_dir to avoid false information

## Command Line Interface (L1362-1403)
Standalone execution supports JSON output and custom root directory via `main()` function