# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_ratio.py
@source-hash: 66de7c6a9b3323a8
@generated: 2026-02-09T18:01:43Z

## Purpose
Space allocation module for distributing total available space among multiple elements (edges) based on size constraints, ratios, and minimum requirements. Core utility for Rich's layout system.

## Key Components

### Edge Protocol (L12-17)
Protocol defining interface for layout elements:
- `size`: Optional fixed size override
- `ratio`: Proportional weight for flexible sizing (default 1)
- `minimum_size`: Minimum space requirement (default 1)

### Core Functions

**ratio_resolve(total, edges) → List[int] (L20-78)**
Primary space allocation algorithm. Iteratively distributes `total` space among `edges` while satisfying all constraints:
- Fixed sizes take precedence
- Remaining space distributed proportionally by ratio
- Ensures minimum_size constraints are met
- Uses Fraction arithmetic for precise calculations
- Handles edge case where total < sum of minimums (returns minimums anyway)

**ratio_reduce(total, ratios, maximums, values) → List[int] (L81-110)**
Reduces values by distributing a total amount proportionally, respecting maximum constraints:
- Zeros out ratios where maximum is 0
- Distributes reduction proportionally among valid slots
- Subtracts distributed amounts from original values

**ratio_distribute(total, ratios, minimums) → List[int] (L113-146)**
Simple proportional distribution with minimum constraints:
- Distributes total space based on ratios
- Enforces minimum values using max()
- Uses ceil() for rounding to ensure total is fully allocated
- Asserts total_ratio > 0 for safety

## Dependencies
- `fractions.Fraction`: For precise fractional arithmetic in ratio_resolve
- `typing_extensions`: Backward compatibility for Protocol (Python < 3.8)

## Architectural Notes
- All functions return integer lists that should sum to input total (except ratio_resolve edge cases)
- Uses local variable optimization (`_Fraction = Fraction`, `append = result.append`)
- Iterative constraint satisfaction in ratio_resolve handles complex sizing scenarios
- Test code in __main__ block (L149-159) demonstrates basic usage

## Critical Invariants
- ratio_resolve may return sum > total when constraints impossible to satisfy
- ratio_reduce and ratio_distribute guarantee exact sum preservation
- All minimum_size constraints are respected even if total space insufficient