# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/html.py
@source-hash: 89ab919942bb2a70
@generated: 2026-02-09T17:58:12Z

## Primary Purpose
HTML formatter for the Pygments syntax highlighting library. Converts tokenized source code into HTML with syntax highlighting, supporting various display modes and customization options.

## Core Components

### Main Class: HtmlFormatter (L113-990)
Primary formatter class inheriting from `Formatter`. Provides extensive configuration options and methods for HTML output generation.

**Key Initialization Options (L411-458):**
- Line numbering modes: `linenos` (0=none, 1=table, 2=inline)
- CSS handling: `noclasses`, `classprefix`, `cssclass`, `cssstyles`
- Document modes: `nowrap`, `full`, `cssfile`
- Line features: `hl_lines`, `lineanchors`, `linespans`, `filename`
- CTags integration: `tagsfile`, `tagurlformat`

### Utility Functions

#### HTML Escaping (L38-40)
`escape_html()` - Escapes HTML special characters using translation table `_escape_html_table` (L29-35)

#### CSS Utilities (L43-59)
- `webify()` (L43-47) - Converts colors to web format (adds # prefix)
- `_get_ttype_class()` (L50-59) - Maps token types to CSS class names using `STANDARD_TYPES`

### CSS Generation Methods (L460-607)

#### Token Type Processing (L460-482)
- `_get_css_class()` (L460-466) - Single CSS class for token type
- `_get_css_classes()` (L468-474) - Full CSS class hierarchy
- `_get_css_inline_styles()` (L476-482) - Inline styles for token types

#### Style Definition Generation (L484-607)
- `_create_stylesheet()` (L484-506) - Builds internal style mappings
- `get_style_defs()` (L508-520) - Main entry point for CSS generation
- `get_token_style_defs()` (L522-537) - Token-specific CSS rules
- `get_background_style_defs()` (L539-560) - Background and highlight colors
- `get_linenos_style_defs()` (L562-571) - Line number styling

### Wrapping Generators (L616-825)
Chain of responsibility pattern for HTML generation:

#### Document Structure
- `_wrap_full()` (L616-655) - Complete HTML document with headers/footers
- `_wrap_div()` (L790-802) - Outer div container
- `_wrap_pre()` (L804-819) - Pre tag with optional filename
- `_wrap_code()` (L821-824) - Code tag wrapper

#### Line Number Handling
- `_wrap_tablelinenos()` (L657-722) - Table-based line numbers
- `_wrap_inlinelinenos()` (L725-766) - Inline line numbers

#### Line Features
- `_wrap_lineanchors()` (L768-778) - Anchor tags for line linking
- `_wrap_linespans()` (L780-788) - Span wrappers for JavaScript access

### Token Processing (L826-936)

#### Core Formatting (L831-907)
`_format_lines()` - Main token processing method:
- Converts tokens to HTML spans with CSS classes/inline styles
- Handles line breaks and HTML escaping via `_translate_parts()` (L826-829)
- Integrates CTags hyperlink generation (L864-875)
- Caches span openers in `span_element_openers` dict (L426)

#### Line Highlighting (L916-936)
`_highlight_lines()` - Post-processes output to highlight specified lines using `hl_lines` option

#### CTags Integration (L909-914)
`_lookup_ctag()` - Searches CTags file for token definitions

### Main Formatting Pipeline (L938-990)

#### Template Generation (L938-951)
`wrap()` - Applies basic wrapping generators (code, pre tags)

#### Complete Processing (L953-990)  
`format_unencoded()` - Master coordination method:
1. Basic token formatting via `_format_lines()`
2. Optional inline line numbers
3. Line highlighting if configured
4. Sequential wrapper application based on options
5. Output generation to file

## Template Constants (L62-110)
- `CSSFILE_TEMPLATE` (L62-69) - CSS file structure
- `DOC_HEADER` (L71-90) - HTML document header with inline CSS
- `DOC_HEADER_EXTERNALCSS` (L92-105) - HTML header with external CSS
- `DOC_FOOTER` (L107-110) - HTML document footer

## Dependencies
- `pip._vendor.pygments.formatter.Formatter` - Base formatter class
- `pip._vendor.pygments.token` - Token types and constants  
- `pip._vendor.pygments.util` - Option parsing utilities
- Optional: `ctags` module for hyperlink generation

## Architecture Notes
- Generator-based pipeline allows flexible composition of HTML features
- Caching mechanisms optimize repeated token processing
- Extensive option system supports diverse output requirements
- Clean separation between CSS generation and HTML structure