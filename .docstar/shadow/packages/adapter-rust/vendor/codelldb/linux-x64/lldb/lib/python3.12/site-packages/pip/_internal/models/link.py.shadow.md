# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/models/link.py
@source-hash: 8c76b1f4efbdce54
@generated: 2026-02-09T18:01:26Z

## Purpose
This module defines core data structures for representing download links in pip's package management system. It handles URL parsing, hash validation, metadata extraction, and link equivalency checking for Python packages from various sources (PyPI, VCS, local files).

## Key Classes

### LinkHash (L44-95)
Immutable dataclass representing hash values embedded in URLs. Parses hash fragments using regex pattern `_hash_url_fragment_re` (L57-66) supporting sha512, sha384, sha256, sha224, sha1, md5. Key methods:
- `find_hash_url_fragment()` (L73-79): Cached classmethod to extract hash from URL
- `as_hashes()` (L84-86): Converts to pip's Hashes object for validation
- `is_hash_allowed()` (L88-94): Validates against allowed hash schemes

### MetadataFile (L98-106)
Container for core metadata file information with optional hash validation. Validates all hash names against `_SUPPORTED_HASHES` in `__post_init__`.

### Link (L182-528)
Primary class representing a parsed package link. Uses `__slots__` for memory efficiency (L185-195). Core functionality:

#### Construction
- `__init__()` (L197-258): Handles UNC paths, URL parsing, hash extraction from fragments
- `from_json()` (L261-309): Creates from PyPI JSON API response, handles PEP 714 metadata
- `from_element()` (L312-361): Creates from HTML anchor attributes in simple repository

#### Properties & Methods
- URL components: `scheme`, `netloc`, `path` (L412-424)
- File operations: `filename` (L394-405), `file_path` (L408-409), `is_existing_dir()` (L500-501)
- Hash handling: `as_hashes()` (L481-482), `is_hash_allowed()` (L521-527)
- Type detection: `is_wheel`, `is_vcs`, `is_yanked` (L504-515)
- Fragment parsing: `egg_fragment` (L445-461), `subdirectory_fragment` (L466-470)

#### Special Methods
Total ordering implementation (L181, L384-387) based on URL comparison. Hash and equality based on URL (L376-382).

### _CleanResult (L530-560)
NamedTuple for link equivalency checking. Normalizes URLs by removing auth, parsing query parameters, and extracting relevant fragments while ignoring egg= fragments.

## Key Functions

### URL Processing
- `_ensure_quoted_url()` (L166-178): Ensures proper URL encoding without double-quoting
- `_clean_url_path()` (L144-163): Cleans URL paths with special handling for VCS revision strings
- `_clean_file_url_path()` (L127-137): Platform-aware file URL cleaning

### Link Equivalency
- `links_equivalent()` (L589-590): Cached function comparing cleaned link representations
- `_clean_link()` (L562-585): Normalizes links for equivalency comparison

### Utility Functions
- `supported_hashes()` (L108-116): Filters hash dictionary to supported algorithms

## Dependencies
- Internal: `pip._internal.utils.*` modules for hashing, URLs, file types, deprecation
- External: `urllib.parse`, `re`, `functools`, `dataclasses`

## Architectural Notes
- Extensive use of caching (`@functools.lru_cache`) for performance on repeated operations
- Immutable design with frozen dataclasses and private URL storage
- PEP compliance: Supports PEP 503 (simple repository), PEP 592 (yanked files), PEP 714 (metadata)
- Hash precedence defined by `_SUPPORTED_HASHES` ordering (L40)
- Fragment parsing supports both `#` and `&` delimiters for hash values