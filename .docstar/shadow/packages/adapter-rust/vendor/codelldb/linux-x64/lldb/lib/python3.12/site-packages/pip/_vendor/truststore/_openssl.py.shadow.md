# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/truststore/_openssl.py
@source-hash: 2cb519ed919a8a8f
@generated: 2026-02-09T18:01:55Z

## Purpose
OpenSSL-based SSL/TLS certificate verification implementation for the truststore package. Provides system certificate store discovery and configuration for SSL contexts on Unix-like systems.

## Key Components

### Constants
- `_CA_FILE_CANDIDATES` (L8-17): Prioritized list of common CA certificate file locations across different Linux distributions and BSD systems
- `_HASHED_CERT_FILENAME_RE` (L19): Regex pattern matching OpenSSL hashed certificate filenames (format: 8-digit hex hash + dot + digit)

### Functions
- `_configure_context()` (L22-46): Context manager that configures an SSL context with appropriate CA certificates. First attempts OpenSSL defaults via `ssl.get_default_verify_paths()`, falls back to searching common system locations if defaults are unavailable
- `_capath_contains_certs()` (L49-56): Validates that a certificate directory exists and contains properly formatted certificate files using hashed naming convention
- `_verify_peercerts_impl()` (L59-66): No-op implementation that relies on SSL context's built-in verification (CERT_REQUIRED mode)

## Dependencies
- Standard library: `contextlib`, `os`, `re`, `ssl`, `typing`
- Relies on system OpenSSL installation and certificate stores

## Architecture Notes
- Follows fallback pattern: OpenSSL defaults → system-specific paths → failure
- Cross-platform compatibility focused on Unix-like systems (Linux distributions, BSD)
- Integrates with Python's ssl module rather than reimplementing certificate validation
- Certificate discovery based on Christian Heimes' certifi-system-store research

## Critical Behavior
- Certificate path discovery respects SSL_CERT_FILE and SSL_CERT_DIR environment variables through OpenSSL defaults
- Searches certificate candidates in priority order, stopping at first valid file found
- Validates certificate directories by presence of hashed certificate files, not just directory existence