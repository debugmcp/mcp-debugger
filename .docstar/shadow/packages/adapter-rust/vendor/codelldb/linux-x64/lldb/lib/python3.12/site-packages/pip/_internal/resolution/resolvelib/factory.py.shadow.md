# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/resolution/resolvelib/factory.py
@source-hash: ab334847f62c0b89
@generated: 2026-02-09T17:58:04Z

## Primary Purpose
Factory class that serves as the central coordinator for pip's dependency resolution system using ResolveLib. Creates and manages candidate objects, requirements, and handles caching for efficient package installation resolution.

## Key Classes and Functions

### CollectedRootRequirements (L89-93)
NamedTuple containing processed root requirements:
- `requirements`: List of requirement objects
- `constraints`: Dict mapping package names to constraint objects  
- `user_requested`: Dict tracking user-supplied requirements with their order

### Factory (L95-816)
Main factory class coordinating the resolution process.

**Initialization (L96-133)**
- Sets up package finder, preparer, and install requirement provider
- Initializes multiple caches for candidates and build failures
- Loads installed distributions if not ignoring them
- Creates RequiresPythonCandidate for Python version constraints

**Key Properties:**
- `force_reinstall` (L134-136): Returns reinstall flag
- Multiple caches: `_build_failures`, `_link_candidate_cache`, `_editable_candidate_cache`, `_installed_candidate_cache`, `_extras_candidate_cache`

**Candidate Creation Methods:**
- `_make_extras_candidate` (L147-161): Creates ExtrasCandidate with caching
- `_make_candidate_from_dist` (L162-176): Creates candidates from installed distributions
- `_make_candidate_from_link` (L177-191): Creates candidates from package links
- `_make_base_candidate_from_link` (L192-248): Core logic for link-based candidates, handles editable vs regular packages

**Candidate Finding (L249-465)**
- `_iter_found_candidates` (L249-345): Main candidate discovery logic
  - Handles installed packages vs index packages
  - Implements PEP 592 yanked package logic (L307-324)
  - Returns FoundCandidates iterator
- `find_candidates` (L390-465): Primary entry point for candidate resolution
  - Collects explicit candidates and install requirements
  - Handles extras and constraints
  - Filters incompatible candidates

**Requirement Creation:**
- `_make_requirements_from_install_req` (L466-518): Converts InstallRequirement to Requirement objects, handles splitting constraints from extras
- `collect_root_requirements` (L519-560): Processes root requirements and constraints, sorts requirements to put extras last
- `make_requirements_from_spec` (L566-583): Creates requirements from specifier strings

**Utility Methods:**
- `_fail_if_link_is_unsupported_wheel` (L138-146): Validates wheel compatibility
- `get_wheel_cache_entry` (L595-613): Retrieves cached wheel entries
- `get_dist_to_uninstall` (L614-641): Determines if existing package needs uninstallation

**Error Handling:**
- `_report_requires_python_error` (L642-663): Formats Python version conflicts
- `_report_single_requirement_conflict` (L664-715): Reports single requirement failures
- `get_installation_error` (L716-816): Main error reporting for resolution failures

## Dependencies
- ResolveLib for dependency resolution algorithm
- pip._vendor.packaging for requirement parsing and version handling
- pip._internal modules for package finding, metadata, and installation
- Local modules: .base, .candidates, .requirements, .found_candidates

## Key Patterns
- Extensive caching strategy to avoid redundant candidate creation
- Separation of concerns between base candidates and extras candidates
- Two-phase requirement processing (constraints vs regular requirements)
- Comprehensive error reporting with actionable user guidance

## Critical Constraints
- Candidate objects are cached by link/distribution to maintain identity
- Extras are handled separately from base packages for optimization
- Build failures are cached to avoid repeated attempts
- Python version requirements are treated specially in conflict resolution