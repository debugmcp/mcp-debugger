# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/commands/inspect.py
@source-hash: 3c6ad8f534534423
@generated: 2026-02-09T18:01:11Z

## Purpose
Implements the `pip inspect` command that analyzes a Python environment and generates a comprehensive JSON report of installed packages and environment details.

## Core Components

### InspectCommand Class (L19-92)
- **Primary Function**: CLI command class that inspects Python environments and outputs JSON reports
- **Inheritance**: Extends `Command` from pip's internal CLI framework
- **Key Attribute**: `ignore_require_venv = True` (L24) - allows running in any environment

### Command Configuration (L28-46)
- **add_options()**: Configures CLI options:
  - `--local`: Exclude globally-installed packages in virtualenvs (L29-37)
  - `--user`: Show only user-site packages (L38-44)
  - `--path`: Custom path option via `cmdoptions.list_path()` (L45)

### Main Execution Logic (L48-63)
- **run() method**: Core command execution
  - Validates path options via `cmdoptions.check_list_path_option()` (L49)
  - Retrieves installed distributions using `get_environment().iter_installed_distributions()` (L50-54)
  - Filters out stdlib packages via `skip=set(stdlib_pkgs)` (L53)
  - Constructs JSON output with version info, pip version, package list, and environment markers (L55-61)
  - Outputs formatted JSON via `print_json()` (L62)

### Package Serialization (L65-92)
- **_dist_to_dict()**: Converts `BaseDistribution` objects to dictionaries
  - Core metadata: `metadata_dict` and `info_location` (L67-68)
  - Direct URL handling: Uses `direct_url.to_dict()` when available (L72-74)
  - Legacy editable support: Emulates direct_url for editable installs using `path_to_url()` (L76-84)
  - Optional fields: installer info (L86-88) and requested status (L90-91)

## Dependencies
- **External**: `packaging.markers.default_environment`, `rich.print_json`
- **Internal**: pip CLI framework, metadata system, utility functions for URLs and compatibility

## Output Format
Structured JSON with fields:
- `version`: Report format version
- `pip_version`: Current pip version
- `installed`: Array of package dictionaries
- `environment`: Platform environment markers

## Notable Patterns
- Conditional field inclusion in package dictionaries based on data availability
- Special handling for editable installations when direct_url is missing
- Environment filtering capabilities (local/user/path-specific)