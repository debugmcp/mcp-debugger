# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/idna/codec.py
@source-hash: 3d2ea6f9799d493e
@generated: 2026-02-09T18:01:31Z

## Primary Purpose
IDNA (Internationalized Domain Names) codec implementation for Python's codecs framework, providing encoding/decoding between Unicode domain names and ASCII-compatible encoding (ACE) format.

## Key Classes and Functions

### Codec (L8-26)
Core codec class extending `codecs.Codec`. Provides basic encode/decode functionality:
- `encode(data, errors)` (L10-17): Converts Unicode string to bytes using IDNA encoding
- `decode(data, errors)` (L19-26): Converts bytes back to Unicode string using IDNA decoding
- Only supports 'strict' error handling mode

### IncrementalEncoder (L28-59)
Buffered incremental encoder extending `codecs.BufferedIncrementalEncoder`:
- `_buffer_encode(data, errors, final)` (L29-59): Handles partial domain name encoding
- Splits input on Unicode dot variants using `_unicode_dots_re` (L36)
- Manages trailing dots and incomplete labels when `final=False` (L37-46)
- Uses `alabel()` for ASCII label conversion (L51)

### IncrementalDecoder (L61-94)
Buffered incremental decoder extending `codecs.BufferedIncrementalDecoder`:
- `_buffer_decode(data, errors, final)` (L62-94): Handles partial domain name decoding
- Similar label splitting and trailing dot logic as encoder (L72-82)
- Uses `ulabel()` for Unicode label conversion (L87)
- Handles both string and bytes input (L69-70)

### Stream Classes (L97-102)
- `StreamWriter` (L97-98): Combines Codec with codecs.StreamWriter
- `StreamReader` (L101-102): Combines Codec with codecs.StreamReader
- Both are minimal pass-through implementations

### Registration Function (L105-118)
- `search_function(name)` (L105-116): Codec discovery function for 'idna2008' codec
- Returns `CodecInfo` object with all codec components
- Registered with Python's codec system (L118)

## Dependencies
- `.core` module: Provides `encode`, `decode`, `alabel`, `ulabel`, `IDNAError`
- `codecs`: Python's codec framework
- `re`: For Unicode dot pattern matching
- `typing`: Type annotations

## Key Patterns
- **Unicode Dot Handling**: `_unicode_dots_re` (L6) matches various Unicode dot characters (U+002E, U+3002, U+FF0E, U+FF61)
- **Label-based Processing**: Domain names split into labels for individual IDNA processing
- **Incremental Processing**: Supports partial input with proper boundary handling
- **Strict Error Policy**: Only 'strict' error handling supported across all codecs

## Critical Constraints
- Error handling must be 'strict' - other modes raise IDNAError
- Empty input returns appropriate empty values with zero length
- Incremental codecs preserve incomplete labels between calls when `final=False`
- Size calculation tracks original input length, not output length