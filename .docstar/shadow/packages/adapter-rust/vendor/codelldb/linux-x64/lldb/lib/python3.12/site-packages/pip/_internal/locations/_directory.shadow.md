# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/locations/
@generated: 2026-02-09T18:16:09Z

## Overall Purpose
This directory provides pip's cross-platform location resolution system for Python package installations. It serves as the central abstraction layer that determines where packages, scripts, and data files should be installed across different Python distributions, operating systems, and installation modes (user, system, virtual environment).

## Key Components and Architecture

### Dual Backend System
The module implements a sophisticated dual-backend architecture:
- **sysconfig backend** (`_sysconfig.py`): Modern Python 3.10+ approach using Python's built-in sysconfig module
- **distutils backend** (`_distutils.py`): Legacy fallback using distutils for older Python versions and edge cases
- **Main orchestrator** (`__init__.py`): Coordinates between backends, compares results, and handles platform-specific quirks

### Platform Detection and Compatibility Layer
- **Distribution detection**: Identifies Red Hat, Debian, Slackware, MSYS2, and other distribution-specific Python patches
- **Framework handling**: Special logic for macOS framework Python installations
- **Cross-platform utilities** (`base.py`): Core path manipulation and Python environment introspection

## Public API Surface

### Primary Entry Points
- `get_scheme(dist_name, user=False, home=None, root=None, isolated=False, prefix=None)`: Returns complete `Scheme` object with all installation paths
- `get_bin_prefix()`, `get_bin_user()`: Binary/script directory resolution
- `get_purelib()`, `get_platlib()`: Library installation directories for pure Python vs platform-specific packages

### Core Data Structure
All functions return or work with `Scheme` objects containing:
- `platlib`: Platform-specific library files
- `purelib`: Pure Python library files  
- `headers`: C extension headers
- `scripts`: Executable scripts
- `data`: Package data files

## Internal Organization and Data Flow

### Resolution Process
1. **Backend selection**: `_should_use_sysconfig()` determines primary backend based on Python version and environment flags
2. **Scheme generation**: Both backends generate installation paths independently
3. **Comparison and validation**: Results are compared, with mismatches logged and platform-specific corrections applied
4. **Distribution-specific fixes**: 8+ special case handlers address known bugs in various Linux distributions and Python builds

### Critical Path Logic
- Platform detection using cached functions (`is_osx_framework`, `_looks_like_*` family)
- Virtual environment awareness throughout all path resolution
- Root rebasing and prefix override handling for containerized/relocated installations
- Unicode-safe configuration file parsing with graceful error handling

## Important Patterns and Conventions

### Defensive Programming
- Extensive use of try/catch blocks with graceful fallbacks
- LRU caching for expensive platform detection operations
- Assertion-based validation of mutually exclusive parameters
- Comprehensive logging of path resolution conflicts

### Cross-Platform Compatibility
- Windows-specific drive letter handling in path operations
- macOS framework detection and special path handling
- Linux distribution-specific lib vs lib64 resolution
- MSYS2 and PyPy implementation quirks

### Extensibility
- Plugin-like architecture for adding new distribution detection
- Configurable logging levels for debugging path resolution
- Environment variable overrides for testing and debugging (`_PIP_USE_SYSCONFIG`)

This module is essential for pip's core functionality, ensuring packages install to the correct locations regardless of the underlying Python distribution or platform configuration.