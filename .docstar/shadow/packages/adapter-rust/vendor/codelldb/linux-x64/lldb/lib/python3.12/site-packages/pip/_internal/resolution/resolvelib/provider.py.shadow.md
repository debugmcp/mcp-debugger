# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/resolution/resolvelib/provider.py
@source-hash: 6dcb059d8be59ad0
@generated: 2026-02-09T17:58:00Z

## Primary Purpose

This file implements `PipProvider` (L79-258), pip's adapter that bridges pip's internal resolution logic with the external resolvelib dependency resolver. It translates between pip's concrete `Requirement` and `Candidate` objects and resolvelib's abstract provider interface.

## Key Components

### PipProvider Class (L79-258)
The main provider implementation that satisfies resolvelib's `AbstractProvider` interface:

- **Constructor (L90-103)**: Accepts factory, constraints, dependency handling flags, upgrade strategy, and user-requested packages. Initializes `_known_depths` for tracking dependency tree depth.

- **identify() (L105-106)**: Simple name-based identification for requirements/candidates.

- **get_preference() (L108-197)**: Core preference ranking algorithm that determines resolution order based on:
  - Requires-Python special handling (L181)
  - Direct URLs vs indirect dependencies (L157)
  - Pinned versions (== operators) (L158)
  - Backtrack cause prioritization (L186)
  - Dependency depth inference (L161-175)
  - User-specified order (L162-164, L177)
  - Constraint presence (unfree requirements) (L159)
  - Alphabetical fallback (L196)

- **find_matches() (L199-239)**: Delegates to factory for candidate discovery, with nested helper `_eligible_for_upgrade()` (L205-225) implementing upgrade strategy logic.

- **is_satisfied_by() (L241-243)**: Cached requirement satisfaction check using `@lru_cache`.

- **get_dependencies() (L245-247)**: Extracts dependencies from candidates, respecting `--no-deps` flag.

- **is_backtrack_cause() (L249-258)**: Static method identifying if an identifier caused backtracking.

### Helper Functions

- **_get_with_identifier() (L54-76)**: Utility for looking up package names in mappings, handling extras notation (e.g., "package[extra]").

## Key Dependencies

- `resolvelib.providers.AbstractProvider` (L15): Base interface being implemented
- `.factory.Factory` (L19): Creates requirements/candidates and provides pip services
- `.base.{Requirement, Candidate, Constraint}` (L17): Core resolution objects
- `.candidates.REQUIRES_PYTHON_IDENTIFIER` (L18): Special Python version requirement handling

## Architectural Patterns

- **Adapter Pattern**: Translates between pip's internal APIs and resolvelib's abstract interface
- **Strategy Pattern**: Multiple upgrade strategies handled via string-based dispatch
- **Delegation**: Core resolution work delegated to factory and requirement/candidate objects
- **Caching**: LRU cache on satisfaction checks for performance

## Critical Constraints

- Preference tuple ordering (L188-197) determines resolution behavior - order matters
- Depth calculation assumes finite dependency trees (uses `math.inf` for unknown depths)
- Identifier format assumes PEP 503 normalization with optional extras bracket notation
- Factory must provide stateless services for thread safety