# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/response.py
@source-hash: 189a60dc4822f6a6
@generated: 2026-02-09T17:58:03Z

## Primary Purpose
HTTP response utility functions for urllib3, providing robust handling of file-like object states, HTTP header parsing validation, and HEAD request detection.

## Key Functions

### `is_fp_closed(obj)` (L9-37)
Determines if a file-like object is closed using multiple fallback strategies:
1. Tries `obj.isclosed()` method first (handles Python3 edge cases)
2. Falls back to standard `obj.closed` attribute
3. Checks `obj.fp is None` for container objects (e.g., HTTPResponse)
4. Raises ValueError if none of the methods work

**Pattern**: Defensive programming with graceful attribute error handling

### `assert_header_parsing(headers)` (L40-91)
Validates HTTP header parsing completeness by examining defects and unparsed data:
- Type-checks input as `httplib.HTTPMessage`
- Extracts parsing defects and payload data
- Filters out benign multipart-related defects (StartBoundaryNotFoundDefect, MultipartInvariantViolationDefect)
- Raises `HeaderParsingError` if issues remain

**Critical Logic**: Only processes non-multipart messages for payload inspection (L65)

### `is_response_to_head(response)` (L94-107)
Detects HEAD requests by examining response object's private `_method` attribute:
- Handles AppEngine platform quirk where method is integer (3 = HEAD)
- Standard string comparison for normal cases
- Accesses private `response._method` attribute

## Dependencies
- `email.errors`: Multipart parsing defect types
- `..exceptions.HeaderParsingError`: Custom urllib3 exception
- `..packages.six.moves.http_client`: Cross-Python HTTP client compatibility

## Architectural Notes
- **Defensive Programming**: Multiple fallback strategies for file state detection
- **Platform Compatibility**: Special handling for AppEngine integer method codes
- **Error Filtering**: Intelligent defect filtering to avoid false positives in multipart scenarios
- **Private API Usage**: Intentional use of `response._method` for HEAD detection (noted in FIXME comment)