# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/req/constructors.py
@source-hash: 682f4d73e484484c
@generated: 2026-02-09T18:01:26Z

## Primary Purpose
Factory module for creating InstallRequirement instances from various sources (editable requirements, requirement strings, parsed requirements, etc.). Moved from InstallRequirement class to improve code organization and maintainability.

## Core Architecture
- **RequirementParts dataclass (L195-201)**: Immutable container holding parsed requirement components (Requirement, Link, Marker, extras)
- **Three main parsing pathways**: editable requirements → `parse_editable()`, line-based requirements → `parse_req_from_line()`, requirement strings → direct parsing

## Key Functions

### Parsing Functions
- **`parse_editable()`** (L87-139): Parses editable requirements supporting VCS URLs, local paths, and egg fragments. Handles VCS scheme normalization and validates VCS URLs.
- **`parse_req_from_line()`** (L307-383): Main parser for requirement lines supporting URLs, local paths, archives, and requirement specifiers with markers.
- **`parse_req_from_editable()`** (L203-216): Wrapper that converts editable strings to RequirementParts.

### Constructor Functions (The Public API)
- **`install_req_from_editable()`** (L222-251): Creates InstallRequirement from editable requirement strings
- **`install_req_from_line()`** (L386-420): Creates InstallRequirement from requirement lines (most flexible)
- **`install_req_from_req_string()`** (L423-458): Creates InstallRequirement from requirement strings with PyPI domain validation
- **`install_req_from_parsed_requirement()`** (L461-498): Creates InstallRequirement from ParsedRequirement objects
- **`install_req_from_link_and_ireq()`** (L501-516): Clones InstallRequirement with different link
- **`install_req_drop_extras()`** (L519-542): Creates copy without extras
- **`install_req_extend_extras()`** (L545-560): Creates copy with additional extras

### Utility Functions
- **`_strip_extras()`** (L44-53): Extracts extras notation from paths using regex
- **`convert_extras()`** (L56-59): Converts extras string to set using placeholder requirement
- **`_set_requirement_extras()`** (L62-84): Creates new Requirement with different extras using PEP 508 regex parsing
- **`_looks_like_path()`** (L254-270): Heuristic to detect filesystem paths
- **`_get_url_from_path()`** (L273-304): Converts filesystem paths to URLs with validation
- **`check_first_requirement_in_file()`** (L142-167): Validates requirements file format
- **`deduce_helpful_msg()`** (L170-192): Generates user-friendly error messages for invalid requirements

## Critical Dependencies
- `pip._vendor.packaging`: Requirement, Marker, Specifier parsing
- `pip._internal.req.req_install.InstallRequirement`: Target class being constructed
- `pip._internal.models.link.Link`: URL/path representation
- `pip._internal.vcs`: VCS scheme handling

## Key Patterns
- **Error handling**: Extensive validation with helpful error messages using `deduce_helpful_msg()`
- **Requirement parsing**: Uses packaging library with fallback to custom parsing for edge cases
- **URL normalization**: Converts local paths to file:// URLs consistently
- **Extras handling**: Standardized through `_set_requirement_extras()` with PEP 508 compliance

## Critical Invariants
- All constructors return properly initialized InstallRequirement instances
- VCS URLs must have egg fragments or raise InstallationError
- PyPI packages cannot depend on external URLs (L435-450)
- Requirement strings must be valid per packaging library standards