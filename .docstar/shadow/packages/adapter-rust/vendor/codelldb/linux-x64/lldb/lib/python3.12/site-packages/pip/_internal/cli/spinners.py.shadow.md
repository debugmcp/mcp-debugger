# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/cli/spinners.py
@source-hash: 84827cdc67ab7458
@generated: 2026-02-09T18:01:09Z

## Purpose
Provides spinner UI components for pip CLI operations, offering visual feedback during long-running tasks with both interactive terminal spinners and non-interactive logging-based alternatives.

## Core Classes

### SpinnerInterface (L14-20)
Abstract base interface defining spinner contract with `spin()` and `finish(final_status)` methods. All spinners implement this protocol.

### InteractiveSpinner (L22-69)
Terminal-based animated spinner for interactive sessions:
- **Constructor (L23-42)**: Accepts message, output file (defaults to stdout), spin characters ("-\\|/"), and update interval (0.125s = 8 updates/sec)
- **_write() (L43-54)**: Core rendering method using backspace sequences to overwrite previous spinner character in-place
- **spin() (L55-61)**: Updates spinner character if rate limiter allows and spinner not finished
- **finish() (L62-69)**: Writes final status and newline, marks spinner as finished

### NonInteractiveSpinner (L75-99)
Logging-based spinner for non-interactive environments (CI, redirected output):
- **Constructor (L76-81)**: Takes message and update interval (60s default for keepalive)
- **_update() (L82-86)**: Logs status messages via logger.info()
- **spin() (L87-93)**: Logs "still running..." if rate limiter permits
- **finish() (L94-99)**: Logs completion status

### RateLimiter (L101-113)
Time-based update throttling utility:
- **ready() (L106-110)**: Returns true if enough time elapsed since last update
- **reset() (L111-113)**: Records current time as last update timestamp

## Key Functions

### open_spinner() (L115-137)
Context manager factory that:
- Chooses InteractiveSpinner for TTY terminals at INFO+ log level, otherwise NonInteractiveSpinner
- Handles cursor hiding/showing via `hidden_cursor()`
- Auto-finishes spinner on exit: "canceled" for KeyboardInterrupt, "error" for exceptions, "done" for normal completion

### hidden_cursor() (L143-159)
Context manager for cursor visibility control:
- Skips cursor control on Windows (unsupported)
- Skips for non-TTY or quiet output (log level > INFO)
- Uses ANSI escape sequences: `\x1b[?25l` (hide), `\x1b[?25h` (show)

## Dependencies
- `pip._internal.utils.compat.WINDOWS`: Platform detection
- `pip._internal.utils.logging.get_indentation()`: Consistent output formatting

## Architectural Patterns
- Strategy pattern: Different spinner implementations for different environments
- Rate limiting: Prevents excessive updates that could impact performance
- Graceful degradation: Falls back to logging when interactive features unavailable
- Exception safety: Ensures spinners are properly finished even on errors