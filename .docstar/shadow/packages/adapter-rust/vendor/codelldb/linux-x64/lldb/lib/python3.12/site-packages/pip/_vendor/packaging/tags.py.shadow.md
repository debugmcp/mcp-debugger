# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/tags.py
@source-hash: cbc11b85e3aef564
@generated: 2026-02-09T18:01:43Z

## Purpose & Responsibility

Python wheel tag generation module for packaging compatibility. Generates platform/interpreter/ABI-specific tags that determine wheel compatibility across Python installations. Core component of pip's package selection logic.

## Key Components

### Core Tag System
- **Tag class (L42-94)**: Immutable representation of wheel compatibility tags (interpreter-abi-platform triple). Pre-computes hash for performance optimization during set operations.
- **parse_tag() (L96-109)**: Parses compressed tag strings (e.g., "py3-none-any") into frozenset of Tag instances, handling dot-separated expansions.

### Interpreter Detection & ABI Generation
- **INTERPRETER_SHORT_NAMES (L30-36)**: Maps full interpreter names to abbreviated forms (cpython->cp, pypy->pp, etc.)
- **interpreter_name() (L521-529)**: Returns current interpreter's abbreviated name using sys.implementation
- **interpreter_version() (L532-541)**: Gets interpreter version string, preferring config var over sys.version_info

### CPython-Specific Logic
- **_cpython_abis() (L151-181)**: Generates CPython ABI tags considering debug builds, threading (--disable-gil), pymalloc, UCS-4 unicode
- **_is_threaded_cpython() (L125-138)**: Detects threaded builds via 't' flag in abiflags
- **_abi3_applies() (L141-148)**: Determines stable ABI compatibility (Python 3.2+, excludes threaded builds)
- **cpython_tags() (L184-241)**: Main CPython tag generator yielding specific ABI, abi3, and none tags with version fallback

### Generic Interpreter Support
- **_generic_abi() (L244-282)**: Extracts ABI from EXT_SUFFIX, handling various interpreters (CPython, PyPy, GraalPy, etc.)
- **generic_tags() (L285-313)**: Generates tags for non-CPython interpreters
- **compatible_tags() (L331-353)**: Produces broad compatibility tags (py*-none-platform patterns)

### Platform Detection
- **platform_tags() (L509-518)**: Main platform detection dispatcher (Darwin->mac_platforms, Linux->_linux_platforms, else->_generic_platforms)
- **mac_platforms() (L398-483)**: macOS platform tag generation with binary format compatibility (universal, intel, fat32/64)
- **_linux_platforms() (L486-502)**: Linux platform tags integrating manylinux and musllinux compatibility
- **_mac_arch()/_mac_binary_formats() (L356-395)**: macOS architecture normalization and binary format determination

### Utility Functions
- **_normalize_string() (L121-122)**: Standardizes strings by replacing dots, hyphens, spaces with underscores
- **_get_config_var() (L112-118)**: Safe sysconfig variable accessor with optional warnings
- **_version_nodot() (L544-545)**: Converts version tuple to concatenated string (3,8 -> "38")
- **_py_interpreter_range() (L316-328)**: Generates descending Python version sequence for compatibility

### System Integration
- **sys_tags() (L548-567)**: Main entry point returning prioritized tag sequence for current interpreter
- **_32_BIT_INTERPRETER (L39)**: Global flag detecting 32-bit Python via struct.calcsize

## Dependencies
- Standard library: logging, platform, re, struct, subprocess, sys, sysconfig, importlib.machinery
- Internal modules: _manylinux, _musllinux for Linux platform compatibility

## Architecture Notes
- Performance-optimized Tag class with pre-computed hashes for set operations
- Extensive platform-specific logic for macOS version/architecture compatibility
- ABI detection handles complex CPython build configurations (debug, threading, memory allocators)
- Fallback compatibility ensures broad wheel matching across Python versions

## Type Definitions
- **PythonVersion**: Sequence[int] for version tuples
- **MacVersion**: Tuple[int, int] for macOS version pairs