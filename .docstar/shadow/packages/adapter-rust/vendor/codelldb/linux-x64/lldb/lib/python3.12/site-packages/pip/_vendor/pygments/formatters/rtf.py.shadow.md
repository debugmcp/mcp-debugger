# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/rtf.py
@source-hash: 680d2ffe9b16e8a6
@generated: 2026-02-09T17:57:59Z

## RTF Formatter for Pygments Syntax Highlighting

Primary purpose: Converts syntax-highlighted tokens into Rich Text Format (RTF) documents suitable for Microsoft Word and other RTF-compatible applications.

### Key Components

**RtfFormatter Class (L18-146)**
- Inherits from `Formatter` base class
- Converts tokenized source code into RTF markup with color and style formatting
- Automatically generates complete RTF documents with font tables and color tables
- Handles Unicode characters through RTF escape sequences

### Core Methods

**`__init__(self, **options)` (L50-64)**
- Initializes formatter with configurable font face and size options
- Font size specified in half-points (default 24 = 12pt font)
- Supports custom font family specification

**`_escape(self, text)` (L66-69)**
- Escapes RTF special characters: backslash, curly braces
- Essential for proper RTF document structure

**`_escape_text(self, text)` (L71-93)**
- Comprehensive text escaping for RTF output
- Handles ASCII characters (< 128) directly
- Converts Unicode characters to RTF escape sequences `{\u<number>}`
- Handles surrogate pairs for characters > 16-bit (L88-91)
- Converts newlines to RTF paragraph breaks (`\par`)

**`format_unencoded(self, tokensource, outfile)` (L95-146)**
- Main formatting method that generates complete RTF document
- Creates RTF 1.8 document header with font table (L97-101)
- Builds color table from style definitions (L104-116)
- Processes token stream applying appropriate RTF formatting codes:
  - Background color: `\cb<n>`
  - Text color: `\cf<n>`
  - Bold: `\b`
  - Italic: `\i`
  - Underline: `\ul`
  - Border: `\chbrdr\chcfpat<n>`

### Dependencies

- `Formatter` base class from pygments.formatter
- `get_int_opt`, `surrogatepair` utilities from pygments.util

### Key Features

- **Unicode Support**: Handles full Unicode range through RTF escape sequences
- **Style Mapping**: Converts Pygments color styles to RTF color table indices
- **Token Hierarchy**: Walks up token type hierarchy to find applicable styles (L122-123)
- **Complete Document Generation**: Produces ready-to-use RTF files with proper headers

### Configuration Options

- `fontface`: Custom font family name
- `fontsize`: Font size in half-points
- `style`: Color scheme (inherited from Formatter)

The formatter ensures RTF compliance by properly escaping special characters and using standard RTF formatting codes for text styling.