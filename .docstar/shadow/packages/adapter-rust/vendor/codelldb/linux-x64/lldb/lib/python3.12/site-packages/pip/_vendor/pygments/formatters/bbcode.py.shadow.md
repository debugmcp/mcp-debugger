# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/bbcode.py
@source-hash: af56fbc33593268b
@generated: 2026-02-09T17:57:57Z

## Primary Purpose
BBCode formatter for Pygments syntax highlighting. Converts syntax-highlighted tokens into BBCode markup suitable for bulletin boards and forums that support BBCode formatting.

## Key Components

### BBCodeFormatter Class (L18-108)
Main formatter class inheriting from Pygments' base `Formatter`. Transforms tokenized source code into BBCode tags for forum posting.

**Key attributes:**
- `name = 'BBCode'` (L47) - Formatter identifier
- `aliases = ['bbcode', 'bb']` (L48) - Command-line aliases
- `filenames = []` (L49) - No specific file associations

### Configuration Options (L51-54)
- `codetag` - Wraps output in `[code]` tags
- `monofont` - Adds monospace font tags
- Parsed via `get_bool_opt()` utility

### Core Methods

#### `__init__(self, **options)` (L51-57)
Initializes formatter with boolean options and builds style mapping dictionary.

#### `_make_styles(self)` (L59-76)
Builds `self.styles` dictionary mapping token types to BBCode tag pairs. Converts Pygments style definitions into:
- Color: `[color=#XXXXXX]...[/color]`
- Bold: `[b]...[/b]`
- Italic: `[i]...[/i]`
- Underline: `[u]...[/u]`

#### `format_unencoded(self, tokensource, outfile)` (L78-108)
Main formatting logic that:
1. Writes opening wrapper tags (`[code]`, `[font=monospace]`)
2. Processes token stream, consolidating consecutive same-type tokens
3. Applies BBCode formatting tags based on token types
4. Writes closing wrapper tags

## Dependencies
- `pip._vendor.pygments.formatter.Formatter` (L12) - Base formatter class
- `pip._vendor.pygments.util.get_bool_opt` (L13) - Option parsing utility

## Architecture Patterns
- **Template Method**: Extends base `Formatter.format_unencoded()`
- **Strategy Pattern**: Style mapping allows different BBCode representations
- **State Machine**: Token consolidation tracks `lasttype` and `lastval` to optimize output

## Key Constraints
- No background color or border support (L24-25, L74)
- Limited by BBCode standard tag availability
- Token type inheritance via `ttype.parent` fallback (L88-89)

## Notable Implementation Details
- Efficient token consolidation prevents redundant tag pairs for consecutive same-type tokens (L87-97)
- Graceful style resolution using token type hierarchy traversal (L88-89)
- Proper nesting of wrapper tags with newline termination (L103-108)