# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/filepost.py
@source-hash: e5bfeaaa04475652
@generated: 2026-02-09T18:02:01Z

## Primary Purpose
Implements multipart/form-data encoding for HTTP file uploads and form submissions. Core utility for generating RFC 2388-compliant multipart encoded payloads.

## Key Functions

### `choose_boundary()` (L15-22)
Generates random hexadecimal boundary strings for multipart encoding using 16 random bytes. Handles Python 2/3 compatibility for string encoding.

### `iter_field_objects(fields)` (L25-42) 
Primary field iterator that normalizes various input formats (dict, list of tuples, RequestField objects) into consistent RequestField instances. Uses `RequestField.from_tuples()` for conversion when needed.

### `iter_fields(fields)` (L45-60)
**DEPRECATED** (since v1.6) - Simple tuple iterator for backwards compatibility. Returns (key, value) pairs without RequestField wrapping.

### `encode_multipart_formdata(fields, boundary=None)` (L63-98)
Main encoding function that produces RFC 2388-compliant multipart/form-data payloads. Creates BytesIO buffer, iterates through fields, writes headers and data with proper boundary delimiters. Returns tuple of (encoded_body, content_type_header).

## Dependencies
- `.fields.RequestField`: Core field representation class
- `.packages.six`: Python 2/3 compatibility utilities
- Standard library: `binascii`, `codecs`, `os`, `io.BytesIO`

## Key Variables
- `writer` (L12): UTF-8 encoder for text data writing

## Data Flow Pattern
Input fields → Normalize to RequestField objects → Serialize with boundaries → Return encoded bytes + content-type

## Encoding Logic
- Text data: UTF-8 encoded via `writer()`
- Binary data: Written directly to buffer
- Integer data: Converted to string for backwards compatibility (L84-85)
- Boundary format: `--{boundary}` for separators, `--{boundary}--` for termination

## Critical Invariants
- All field data must be serializable (text, bytes, or convertible to string)
- Boundary strings must be unique and not appear in field data
- Output always includes proper CRLF line endings (`\r\n`)