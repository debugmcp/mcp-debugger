# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/certifi/core.py
@source-hash: d92453e6b21c4028
@generated: 2026-02-09T18:01:34Z

## Primary Purpose
Provides cross-Python version access to the system's CA certificate bundle (`cacert.pem`) with lazy loading and proper resource management. Handles different Python versions (3.7+, 3.11+, <3.7) using version-appropriate importlib.resources APIs or filesystem fallbacks.

## Key Functions & Architecture

**Version Detection & Branching (L14, 49, 85):**
- Python 3.11+: Uses modern `importlib.resources.files()` API (L16-47)
- Python 3.7-3.10: Uses older `importlib.resources.path()` API (L51-83)  
- Python <3.7: Filesystem-based fallback using `__file__` (L86-114)

**Core Functions:**

**`where() -> str`** - Returns filesystem path to cacert.pem
- Python 3.11+ implementation (L21-44): Uses `as_file()` context manager with lazy initialization
- Python 3.7+ implementation (L56-80): Uses `get_path()` context manager with lazy initialization  
- Legacy implementation (L108-111): Direct filesystem path resolution via `__file__`

**`contents() -> str`** - Returns cacert.pem file contents as ASCII string
- Python 3.11+ (L46-47): Uses `files().joinpath().read_text()`
- Python 3.7+ (L82-83): Uses `read_text()` function
- Legacy (L113-114): Delegates to custom `read_text()` fallback

**Resource Management:**

**Global State Variables:**
- `_CACERT_CTX` (L18, 53): Stores importlib context manager for cleanup
- `_CACERT_PATH` (L19, 54): Cached file path to avoid re-extraction

**`exit_cacert_ctx()` (L10-11):** Cleanup function registered with `atexit` to properly close context managers

**Legacy Fallback (L85-114):**
- Custom `read_text()` implementation (L97-104) for Python <3.7 compatibility
- Type aliases for Package/Resource (L90-91)
- Direct filesystem access using `os.path` operations

## Key Dependencies
- `importlib.resources` (modern Python versions)
- `os`, `atexit`, `sys` (standard library)
- `typing` (for legacy type hints)

## Critical Patterns
- **Lazy Loading:** Certificate path extraction delayed until first `where()` call
- **Singleton Pattern:** Global caching prevents repeated file extraction
- **Context Manager Lifecycle:** Proper resource cleanup via atexit registration
- **Version Compatibility:** Graceful degradation across Python versions
- **Zipimport Support:** Handles extraction when package is in zip/wheel format