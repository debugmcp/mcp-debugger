# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/segment.py
@source-hash: 854d6e79e5ea23a6
@generated: 2026-02-09T18:01:59Z

## Purpose
Core text rendering infrastructure for Rich library. Provides `Segment` - the fundamental unit of styled text with optional control codes, and utilities for text manipulation, line breaking, and terminal output formatting.

## Key Classes

### ControlType (L35-53)
IntEnum defining terminal control codes (BELL, CURSOR_MOVE, etc.). Maps to ANSI escape sequences for cursor movement, screen clearing, and display control.

### Segment (L64-534) 
NamedTuple representing styled text fragment with:
- `text: str` - The actual text content
- `style: Optional[Style]` - Visual styling (colors, bold, etc.)
- `control: Optional[Sequence[ControlCode]]` - Terminal control sequences

**Key Properties:**
- `cell_length` (L82-89): Terminal cell width accounting for wide characters
- `is_control` (L105-107): Whether segment contains control codes

**Critical Methods:**
- `split_cells()` (L148-168): Split segment at specific column, handles multi-cell characters
- `_split_cells()` (L111-147): Cached implementation with complex wide-character logic

### Segments (L657-680)
Simple renderable wrapper for segment iterables. Converts segments to console output.

### SegmentLines (L682-705)
Renderable for multiple lines of segments. Handles line-by-line output with optional newlines.

## Class Methods (Segment)

**Style Operations:**
- `apply_style()` (L176-214): Apply base/post styles to segment sequences
- `strip_styles()` (L553-563): Remove all styling, keep text/control
- `strip_links()` (L536-550): Remove hyperlinks while preserving other styles
- `remove_color()` (L566-585): Strip color info, cache colorless styles

**Line Processing:**
- `split_lines()` (L236-262): Break segments on `\n` characters
- `split_and_crop_lines()` (L265-309): Split + crop to max length with padding
- `adjust_line_length()` (L312-354): Crop/pad single line to exact width
- `get_line_length()` (L357-367): Calculate total cell width of line
- `get_shape()`/`set_shape()` (L370-417): Get/set rectangular dimensions

**Alignment:**
- `align_top()` (L420-446): Add padding lines below
- `align_bottom()` (L449-475): Add padding lines above  
- `align_middle()` (L478-506): Center with padding above/below

**Utilities:**
- `line()` (L171-173): Create newline segment
- `filter_control()` (L217-233): Filter by control/non-control segments
- `simplify()` (L509-533): Merge adjacent segments with same style
- `divide()` (L588-654): Split segments at specific column positions

## Key Dependencies
- `.cells`: Cell width calculation for Unicode/wide characters
- `.style`: Style objects for text formatting
- `.repr`: Rich representation support

## Architecture Notes
- Heavy use of caching (`@lru_cache`) for performance on `_split_cells()`
- Optimized fast paths for single-cell width text
- Cell-based positioning instead of character-based for proper Unicode support
- Control codes bypass normal text processing logic
- Generator-heavy design for memory efficiency