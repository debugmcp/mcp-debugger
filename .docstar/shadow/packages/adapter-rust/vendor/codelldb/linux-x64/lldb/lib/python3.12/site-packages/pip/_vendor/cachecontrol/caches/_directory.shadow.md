# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/cachecontrol/caches/
@generated: 2026-02-09T18:16:06Z

## Purpose
This directory provides HTTP response caching implementations for pip's vendored cachecontrol library. It offers multiple storage backends (file system and Redis) to support different deployment scenarios and performance requirements, enabling efficient HTTP caching for pip's package installation operations.

## Key Components and Architecture

### Public API Surface (via `__init__.py`)
- **FileCache**: Standard file-based cache storing complete responses
- **SeparateBodyFileCache**: Memory-efficient file cache separating headers from response bodies
- **RedisCache**: Redis-backed cache for distributed/persistent caching

The package follows a unified cache interface pattern, where all implementations conform to the `BaseCache` protocol, enabling interchangeable use across pip's HTTP operations.

### Storage Implementations

**File-Based Caching (`file_cache.py`)**:
- **_FileCacheMixin**: Core file system operations with security-focused design
  - SHA224-based key hashing with hierarchical directory structure
  - Security measures: symlink attack prevention, secure file creation, mandatory file locking
  - Configurable file/directory permissions (default: 0o0600/0o0700)
- **FileCache**: Traditional implementation storing complete responses in single files
- **SeparateBodyFileCache**: Memory-efficient variant storing headers and bodies separately
- **Utility**: `url_to_file_path()` function for URL-to-cache-key conversion

**Redis-Based Caching (`redis_cache.py`)**:
- **RedisCache**: Distributed cache implementation with Redis backend
- Built-in expiration support (datetime/integer TTL)
- Database-wide clear operations
- Connection pooling through Redis client

### Internal Organization and Data Flow

1. **Entry Point**: Consumers import cache classes from the package root via `__init__.py`
2. **Key Generation**: URLs are converted to cache keys using SHA224 hashing
3. **Storage Strategy**: 
   - File caches use hierarchical directory structure based on hash prefixes
   - Redis cache uses direct key-value storage with optional expiration
4. **Security Layer**: File operations employ OS-level security flags and mandatory locking
5. **Memory Management**: SeparateBodyFileCache enables streaming large response bodies without memory overhead

## Important Patterns and Conventions

### Security by Design
- File operations use `O_CREAT|O_EXCL|O_NOFOLLOW` flags to prevent race conditions and symlink attacks
- Restrictive file permissions prevent unauthorized access
- Mandatory file locking prevents concurrent write conflicts

### Polymorphic Cache Interface
All cache implementations follow the same interface pattern:
- `get(key)` â†’ `bytes | None`
- `set(key, value, expires=None)`
- `delete(key)`
- `clear()` (where applicable)

### Backward Compatibility
- Hash-based file naming must remain stable for existing cache compatibility
- "Forever" flag controls actual file deletion behavior

## Integration Context
This module serves as the caching layer for pip's HTTP client operations, supporting both local development (file-based) and production/CI environments (Redis-based). The standardized interface allows pip to switch between cache backends without code changes, supporting various deployment scenarios from single-user installations to distributed build systems.