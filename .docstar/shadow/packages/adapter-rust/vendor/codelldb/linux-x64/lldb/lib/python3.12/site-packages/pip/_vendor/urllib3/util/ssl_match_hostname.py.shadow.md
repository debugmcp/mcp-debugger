# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/ssl_match_hostname.py
@source-hash: 22be1c6551239809
@generated: 2026-02-09T17:58:02Z

## Purpose
SSL hostname verification utility implementing RFC 6125 and RFC 2818 standards. This is a backported version of Python 3.3.3's `match_hostname()` function, providing SSL certificate hostname validation for older Python versions.

## Key Components

### Exception Class
- **CertificateError (L21-22)**: Custom exception inheriting from ValueError, raised when certificate validation fails

### Core Functions

**_dnsname_match(dn, hostname, max_wildcards=1) (L25-76)**
- Implements RFC 6125 section 6.4.3 DNS name matching with wildcard support
- Handles wildcard patterns in leftmost DNS label only
- Enforces security limits: max 1 wildcard per fragment to prevent DoS attacks
- Special handling for internationalized domains (xn-- prefixed)
- Returns regex match object or None

**_to_unicode(obj) (L79-83)**
- Unicode conversion utility for Python 2/3 compatibility
- Handles ASCII encoding for Python 2.x string objects

**_ipaddress_match(ipname, host_ip) (L86-95)**
- Exact IP address matching for certificate validation
- Handles trailing newlines in subjectAltName IP addresses
- Requires ipaddress module (optional dependency)

**match_hostname(cert, hostname) (L98-159)**
- Main entry point for certificate hostname validation
- Processes both DNS names and IP addresses from certificate
- Checks subjectAltName first, falls back to commonName if no SAN entries
- Raises CertificateError with descriptive messages on validation failure

## Dependencies
- `re`: Regular expression support for DNS pattern matching
- `sys`: Python version detection for compatibility
- `ipaddress`: Optional IP address handling (graceful fallback if unavailable)

## Architecture Patterns
- **Graceful Degradation**: Optional ipaddress dependency with fallback behavior
- **Security-First**: Wildcard limits prevent denial-of-service attacks
- **Standards Compliance**: Strict adherence to RFC 6125 and RFC 2818
- **Python 2/3 Compatibility**: Version-aware string handling

## Critical Constraints
- Maximum 1 wildcard per DNS fragment (security measure)
- Wildcards only allowed in leftmost DNS label
- No wildcard matching for internationalized domains
- IP addresses require exact matching (no wildcards)
- Certificate must contain either subjectAltName or commonName fields