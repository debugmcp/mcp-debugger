# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/_securetransport/bindings.py
@source-hash: e1793ae2a2243c1b
@generated: 2026-02-09T17:57:08Z

## Purpose
Low-level ctypes bindings for Apple's SecureTransport and CoreFoundation frameworks. Provides C-level API access for SSL/TLS operations on macOS, enabling secure transport functionality within urllib3. Derived from Will Bond's oscrypto library.

## Platform Requirements & Validation
- **macOS-only**: Platform check enforced (L53-54), raises ImportError on non-Darwin systems
- **Version check**: Requires macOS 10.8+ (L56-62), raises OSError for older versions
- **Library loading**: Custom loader `load_cdll()` (L65-79) handles Big Sur+ path resolution

## Core Framework Bindings

### Library Loading (L81-87)
- `Security`: Apple Security framework for SSL/TLS, certificates, cryptography
- `CoreFoundation`: Apple CoreFoundation for data types and memory management

### Type Definitions (L90-133)
Comprehensive ctypes mapping for Apple frameworks:
- **CoreFoundation types**: Boolean, CFIndex, CFString, CFArray, CFData, CFDictionary, etc. (L90-104)
- **Security types**: SecCertificateRef, SSLContextRef, SecTrustRef, OSStatus, etc. (L105-133)
- All types use appropriate ctypes primitives (c_void_p, c_uint32, POINTER, etc.)

### Function Bindings (L135-421)

#### Security Framework Functions (L136-319)
Key SSL/TLS operations:
- **Certificate handling**: SecItemImport (L136), SecCertificateCreateWithData (L157), SecPKCS12Import (L186)
- **SSL context management**: SSLCreateContext (L282), SSLSetIOFuncs (L198), SSLHandshake (L216)
- **SSL I/O operations**: SSLRead (L219), SSLWrite (L222), SSLClose (L225)
- **Cipher management**: SSLGetSupportedCiphers (L231), SSLSetEnabledCiphers (L238)
- **Trust evaluation**: SecTrustEvaluate (L273), SSLCopyPeerTrust (L264)

#### CoreFoundation Functions (L328-418)
Memory and data structure management:
- **Memory management**: CFRetain (L328), CFRelease (L331)
- **String operations**: CFStringCreateWithCString (L337), CFStringGetCString (L347)
- **Data operations**: CFDataCreate (L355), CFDataGetBytePtr (L361)
- **Collection operations**: CFArrayCreate (L377), CFDictionaryCreate (L364)

### Constants Classes

#### CFConst (L423-429)
CoreFoundation constants, currently only UTF-8 encoding.

#### SecurityConst (L432-519)
Comprehensive SSL/TLS constants:
- **Session options**: kSSLSessionOptionBreakOnServerAuth (L437)
- **Protocol versions**: SSL 2/3, TLS 1.0-1.3 constants (L439-446)
- **Connection types**: kSSLClientSide, kSSLStreamType (L448-449)
- **Trust results**: Various trust evaluation outcomes (L453-461)
- **Error codes**: Extensive SSL error constants (L463-486)
- **Cipher suites**: Modern TLS cipher suite constants (L490-519)

## Architecture Notes
- **Error handling**: Uses OSStatus return codes throughout, with raise_from for ImportError propagation
- **Version compatibility**: Handles ALPN protocol setting availability (L298-303) for macOS 10.12+
- **Memory safety**: Proper ctypes POINTER usage for reference types
- **Fallback loading**: Big Sur+ uses hardcoded framework paths due to library resolution changes

## Critical Dependencies
- `ctypes` and `ctypes.util` for C library binding
- `platform` for macOS version detection
- `...packages.six.raise_from` for Python 2/3 compatible exception chaining