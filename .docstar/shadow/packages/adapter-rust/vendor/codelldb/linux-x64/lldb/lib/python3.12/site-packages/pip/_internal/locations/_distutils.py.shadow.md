# packages/adapter-rust/vendor/codelldb/linux-x64/lldb/lib/python3.12/site-packages/pip/_internal/locations/_distutils.py
@source-hash: 1fd6472bfdf9add0
@generated: 2026-02-09T18:01:16Z

## Purpose
Provides distutils-based installation location schemes for pip packages. Handles platform-specific path resolution and supports various installation modes (user, home, prefix, virtualenv). Critical for pip's internal package installation mechanics.

## Key Components

### Primary Functions

**`distutils_scheme()` (L35-112)**
- Core function that generates installation path mappings using distutils
- Parameters: `dist_name`, `user`, `home`, `root`, `isolated`, `prefix`, `ignore_config_files`
- Returns: Dict mapping scheme keys (platlib, purelib, headers, scripts, data) to absolute paths
- Handles complex logic for virtualenv header paths (L93-111)
- Manages distutils configuration parsing with Unicode error handling (L55-63)

**`get_scheme()` (L115-147)**  
- Wrapper around `distutils_scheme()` that returns typed `Scheme` object
- Well-documented with parameter descriptions and external documentation reference
- Direct mapping from dict keys to Scheme object attributes

**`get_bin_prefix()` (L150-164)**
- Platform-specific binary/script directory resolution
- Windows: prioritizes "Scripts" over "bin" (L154-159)
- macOS: special handling for system framework installs (L162-163)
- Unix: standard "bin" directory

**`get_purelib()` / `get_platlib()` (L167-172)**
- Simple wrappers around distutils `get_python_lib()` for platform-agnostic library paths

## Dependencies
- **distutils**: Core dependency for installation scheme generation
- **pip._internal.models.scheme.Scheme**: Target data structure
- **pip._internal.utils.compat.WINDOWS**: Platform detection
- **pip._internal.utils.virtualenv.running_under_virtualenv**: Environment detection

## Critical Patterns

### Setuptools Shim Removal (L12-15)
- Attempts to remove setuptools-injected distutils modifications
- Gracefully handles import failures - defensive programming pattern

### Assertion-Based Validation (L71-72)
- Enforces mutually exclusive parameters (user/prefix, home/prefix)
- Uses assertions with descriptive error messages

### Virtualenv Special Handling (L93-111)
- Custom header path construction for virtual environments
- Root path rebasing logic with drive letter handling on Windows

## Architecture Notes
- File acts as adapter layer between distutils and pip's internal scheme representation
- Handles cross-platform compatibility concerns
- Defensive against distutils configuration encoding issues
- Side-effect aware: notes that user/home installation triggers directory creation