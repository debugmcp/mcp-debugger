# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/index.py
@source-hash: 9536f0dbaf2b4618
@generated: 2026-02-09T17:59:42Z

**Purpose:** Python package index client for interacting with PyPI-compatible repositories. Handles package registration, file uploads, documentation uploads, GPG signing/verification, and file downloads.

**Core Class:**
- `PackageIndex` (L29-508): Main interface for PyPI operations
  - Defaults to PyPI.org (L25) with realm 'pypi' (L26)
  - Multipart form boundary for HTTP uploads (L35)
  - GPG integration with auto-detection of gpg/gpg2 binaries (L53-64)

**Key Methods:**
- `__init__()` (L37-65): Initialize with URL validation, GPG detection, configuration loading
- `read_configuration()` (L74-85): Load PyPI credentials from .pypirc via distutils
- `save_configuration()` (L87-94): Store credentials to .pypirc
- `check_credentials()` (L96-106): Validate username/password, setup HTTP auth handler
- `register()` (L108-126): Register package metadata with PyPI (verify then submit)
- `upload_file()` (L232-287): Upload release files with optional GPG signing, MD5/SHA256 hashing
- `upload_documentation()` (L289-315): Upload zipped documentation directory
- `sign_file()` (L209-230): GPG sign files using detected GPG binary
- `verify_signature()` (L341-363): Verify GPG signatures
- `download_file()` (L365-441): Download with optional digest verification and progress hooks
- `send_request()` (L442-456): HTTP request handling with auth/SSL support
- `encode_request()` (L458-499): Multipart form encoding for file uploads
- `search()` (L501-508): RPC-based package search using ServerProxy

**Process Execution:**
- `run_command()` (L174-207): Subprocess execution with threaded stdout/stderr capture
- `_reader()` (L128-144): Thread worker for capturing subprocess output streams

**Dependencies:**
- `.compat`: HTTP handlers, URL parsing, request building (cross-Python compatibility)
- `.util`: zip_dir, ServerProxy, pypirc configuration functions
- Standard: hashlib, subprocess, threading, tempfile

**Architecture Patterns:**
- Thread-based subprocess I/O handling to avoid blocking on communicate()
- Lazy GPG binary detection with fallback (gpg preferred over gpg2)
- Configurable authentication via .pypirc files
- Multipart form data encoding for file uploads
- Digest verification during downloads

**Critical Constraints:**
- URL must be HTTP/HTTPS with no params/query/fragment (L47-48)
- GPG operations require detected binary (L262, L355-357)
- Credentials required for upload operations (L92, L101-102, L255, L302)
- File existence validated before upload (L256-257)