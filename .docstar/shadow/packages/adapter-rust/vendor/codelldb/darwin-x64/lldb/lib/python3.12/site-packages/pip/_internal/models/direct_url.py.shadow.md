# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/models/direct_url.py
@source-hash: b81b58d871dddd33
@generated: 2026-02-09T17:59:28Z

## Purpose

Implementation of PEP 610 DirectUrl specification for tracking the origin of Python package installations. Provides data models for representing and validating package source URLs with associated metadata like version control info, archive hashes, or local directory flags.

## Key Classes

**DirectUrl (L159-224)** - Main data class representing a package's direct URL with:
- `url`: source URL 
- `info`: one of VcsInfo/ArchiveInfo/DirInfo
- `subdirectory`: optional subdirectory path
- Key methods: `from_dict`/`to_dict`, `from_json`/`to_json`, `validate`, `is_local_editable`
- `redacted_url` property (L179-189) strips auth credentials except for git users or env vars

**VcsInfo (L70-93)** - Version control system metadata:
- Required: `vcs` (system name), `commit_id` (exact commit)
- Optional: `requested_revision` (branch/tag originally requested)

**ArchiveInfo (L95-137)** - Archive/package file metadata:
- Supports both legacy `hash` format and new `hashes` dict
- Hash setter (L112-127) auto-upgrades legacy format to populate hashes dict
- Validates hash format as "algorithm=value"

**DirInfo (L140-153)** - Local directory metadata:
- Single `editable` boolean flag for development installs

## Utility Functions

- `_get` (L27-38): Type-safe dictionary value extraction with optional defaults
- `_get_required` (L41-47): Required value extraction, raises on missing
- `_exactly_one_of` (L50-61): Validates exactly one info type is present  
- `_filter_none` (L64-66): Creates dict excluding None values

## Constants & Patterns

- `DIRECT_URL_METADATA_NAME = "direct_url.json"` (L19)
- `ENV_VAR_RE` (L20): Regex for environment variable format `${VAR}` or `${VAR1}:${VAR2}`

## Architecture Notes

- Uses dataclasses for VcsInfo/DirInfo, regular class for ArchiveInfo (due to custom hash property logic)
- InfoType union (L155) represents the three possible info types
- Consistent `_from_dict`/`_to_dict` pattern for serialization across all info classes
- Validation occurs through round-trip serialization in `validate()` method