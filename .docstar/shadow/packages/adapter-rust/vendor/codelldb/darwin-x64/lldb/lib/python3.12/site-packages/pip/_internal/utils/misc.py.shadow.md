# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/utils/misc.py
@source-hash: 3cedea55cf7c0ce4
@generated: 2026-02-09T17:59:50Z

**Primary Purpose**: Core utility module for pip providing file system operations, path handling, user interaction, URL manipulation, and build backend integration.

**Key Functions & Classes**:

**File System Operations**:
- `ensure_dir(path)` (L100-107): Creates directories with EEXIST/ENOTEMPTY handling for Windows compatibility
- `rmtree(dir, ignore_errors, onexc)` (L125-144): Robust directory removal with retry logic (3 sec, 0.5s intervals) and Python 3.12+ compatibility
- `rmtree_errorhandler()` (L155-193): Force-removes read-only files by changing permissions, handles various error scenarios
- `renames(old, new)` (L349-363): Cross-device file moves with directory cleanup
- `backup_dir(dir, ext)` (L205-213): Generates backup directory names with incremental suffixes

**Path & URL Utilities**:
- `normalize_path(path, resolve_symlinks)` (L327-337): Canonical absolute path normalization with symlink resolution control
- `display_path(path)` (L196-202): Makes paths relative to cwd for display
- `splitext(path)` (L340-346): Extended splitext handling .tar.gz files correctly
- `remove_auth_from_url(url)` (L528-532): Strips authentication from URLs
- `split_auth_from_netloc(netloc)` (L439-465): Parses netloc into (netloc, (user, pass)) tuple
- `redact_netloc(netloc)` (L468-485): Replaces passwords with "****" for safe logging

**User Interaction**:
- `ask(message, options)` (L231-243): Interactive prompts with validation, respects PIP_NO_INPUT
- `ask_path_exists(message, options)` (L216-220): Path conflict resolution using PIP_EXISTS_ACTION
- `ask_password(message)` (L252-255): Secure password input via getpass

**Data Formatting & Processing**:
- `format_size(bytes)` (L274-282): Human-readable byte size formatting (MB/kB/bytes)
- `tabulate(rows)` (L285-296): Column-aligned text table formatting
- `strtobool(val)` (L258-271): String to boolean conversion with multiple accepted formats

**Environment & Security**:
- `check_externally_managed()` (L603-615): Detects PEP 668 externally managed environments via EXTERNALLY-MANAGED marker
- `protect_pip_from_modification_on_windows()` (L577-600): Prevents pip.exe self-modification on Windows
- `warn_if_run_as_root()` (L750-780): Unix root user warning outside virtualenv
- `is_local(path)` (L366-377): Virtualenv path locality check

**Build System Integration**:
- `ConfiguredBuildBackendHookCaller` (L660-747): Extends BuildBackendHookCaller with config_settings injection for all build methods (build_wheel, build_sdist, build_editable, etc.)

**Data Classes & Types**:
- `HiddenText` (L547-565): Secure string container with redacted display, equality based on secret value
- `StreamWrapper` (L384-397): StringIO wrapper preserving original stream encoding

**Helper Functions**:
- `get_pip_version()` (L74-78): Formatted pip version string with path and Python version
- `normalize_version_info()` (L81-97): Standardizes Python version tuples to length 3
- `hash_file(path, blocksize)` (L623-632): SHA256 hash and length calculation for files
- `pairwise(iterable)` (L635-643): Pairs adjacent elements from iterable
- `partition(pred, iterable)` (L646-657): Splits iterable into false/true partitions

**Dependencies**: Relies on standard library modules (os, sys, shutil, urllib.parse, etc.), pip internals (locations, exceptions, virtualenv utils), and external packages (tenacity for retries, pyproject_hooks for build backends).

**Key Patterns**: Extensive error handling for file operations, Windows-specific compatibility code, security-conscious URL/credential handling, and environment-aware behavior (virtualenv detection, externally managed environments).