# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/util.py
@source-hash: 004558d2aa27cb21
@generated: 2026-02-09T17:59:57Z

## Purpose
Utility module for Pygments syntax highlighter providing text analysis, option parsing, encoding detection, and format utilities.

## Key Components

### Regular Expressions (L15-27)
- `split_path_re` (L15): Splits paths on forward slash, backslash, or space characters
- `doctype_lookup_re` (L16-24): Complex regex for extracting DOCTYPE declarations from HTML/XML
- `tag_re` (L25-26): Matches HTML/XML tags with optional attributes  
- `xml_decl_re` (L27): Matches XML declaration headers

### Exception Classes
- `ClassNotFound` (L30-31): ValueError subclass for failed class lookups
- `OptionError` (L34-38): Exception for invalid option types or values

### Option Processing Functions
- `get_choice_opt()` (L40-51): Validates option value is in allowed list, with optional case normalization
- `get_bool_opt()` (L54-82): Converts string/int to boolean with support for "yes/no", "true/false", "on/off", "1/0" 
- `get_int_opt()` (L85-97): Converts option value to integer with proper error handling
- `get_list_opt()` (L99-113): Converts string to whitespace-split list or validates existing list/tuple

### Text Analysis Functions
- `docstring_headline()` (L116-125): Extracts first paragraph from docstring, stopping at empty line
- `make_analysator()` (L128-142): Higher-order function that wraps text analysis functions to return normalized 0.0-1.0 float values
- `shebang_matches()` (L145-187): Checks if shebang line matches regex pattern, handles Windows executables and ignores flags
- `doctype_matches()` (L190-200): Tests if DOCTYPE declaration matches regex
- `html_doctype_matches()` (L203-205): Specific check for HTML doctypes
- `looks_like_xml()` (L211-224): Detects XML content via declaration, DOCTYPE, or tag presence; uses caching for performance

### Unicode and Formatting Utilities
- `surrogatepair()` (L227-233): Converts Unicode codepoints >16 bits to UTF-16 surrogate pairs
- `format_lines()` (L236-252): Formats string sequences as Python tuple literals with proper indentation
- `duplicates_removed()` (L255-268): Removes duplicates from iterable while preserving order

### Encoding Detection
- `guess_decode()` (L281-299): Multi-stage fallback encoding detection (UTF-8 → locale → latin-1)
- `guess_decode_from_terminal()` (L302-316): Terminal-aware version that tries terminal encoding first
- `terminal_encoding()` (L319-324): Extracts encoding from terminal object or falls back to locale

### Special Classes
- `Future` (L271-278): Abstract base for deferred computation, used by RegexLexerMeta
- `UnclosingTextIOWrapper` (L327-330): TextIOWrapper subclass that doesn't close underlying buffer

## Architecture Notes
- Heavy use of caching (`_looks_like_xml_cache`) for performance optimization
- Defensive programming with extensive try/catch blocks for encoding operations
- Regex compilation happens at module load time for efficiency
- Option functions follow consistent error handling pattern with descriptive OptionError messages