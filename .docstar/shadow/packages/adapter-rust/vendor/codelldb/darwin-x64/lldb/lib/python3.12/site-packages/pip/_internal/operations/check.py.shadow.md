# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/operations/check.py
@source-hash: 429c3b17064c1b56
@generated: 2026-02-09T17:59:32Z

## Purpose
Validates package dependency consistency in pip installations. Detects missing dependencies and version conflicts between packages, supporting both installed package analysis and pre-installation conflict checking.

## Core Data Structures
- **PackageDetails** (L18-20): NamedTuple storing package version and dependencies list
- **PackageSet** (L24): Dict mapping normalized package names to PackageDetails
- **Type Aliases** (L25-31): Missing/Conflicting tuples and result dictionaries for dependency issues

## Key Functions

### create_package_set_from_installed (L34-48)
Scans installed packages in the environment and builds a PackageSet. Returns tuple of (package_set, problems_flag). Handles metadata parsing errors gracefully by logging warnings and continuing.

### check_package_set (L51-93)
Core validation logic that analyzes a PackageSet for dependency issues. Returns (missing_deps, conflicting_deps) dictionaries. For each package:
- Checks if dependencies exist in package set
- Evaluates requirement markers for conditional dependencies (L77-78)
- Validates version specifiers against installed versions
- Supports optional ignore function for filtering packages

### check_install_conflicts (L96-113)
Main entry point for pre-installation validation. Simulates installation of new requirements, then checks resulting package set for conflicts. Only reports issues for "whitelisted" packages that are directly affected by the installation.

### _simulate_installation_of (L116-132)
Updates PackageSet with metadata from packages that would be installed, using make_distribution_for_install_requirement to get package details.

### _create_whitelist (L135-149)
Builds set of packages affected by installation - includes packages being installed plus any existing packages that depend on them.

## Dependencies
- pip._vendor.packaging: For requirement parsing and name canonicalization
- pip._internal.distributions: For package metadata extraction
- pip._internal.metadata: For environment introspection

## Architecture Notes
- Uses normalized package names throughout for consistent comparison
- Handles optional dependencies via marker evaluation
- Separates simulation logic from validation logic for modularity
- Error-resilient design continues processing despite individual package metadata issues