# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/vcs/mercurial.py
@source-hash: a142ce8732765227
@generated: 2026-02-09T17:59:36Z

**Purpose:** Pip's Mercurial VCS adapter implementing version control operations for `hg` repositories.

**Core Class:**
- `Mercurial` (L20-161): Extends VersionControl to provide Mercurial-specific operations
  - Identifies as "hg" with `.hg` directory marker and "clone" repo name
  - Supports schemes: hg+file, hg+http, hg+https, hg+ssh, hg+static-http

**Key Operations:**

**Repository Management:**
- `fetch_new()` (L36-58): Clones new repo with verbosity-based flags, performs `hg clone --noupdate` followed by `hg update`
- `switch()` (L60-72): Changes repository URL by modifying `.hg/hgrc` config file, updates to new revision
- `update()` (L74-77): Pulls latest changes and updates working directory with `hg pull -q` + `hg update -q`

**Information Retrieval:**
- `get_remote_url()` (L79-89): Extracts default path from `hg showconfig paths.default`, converts local paths to URLs
- `get_revision()` (L91-102): Returns local changeset revision number using `hg parents --template={rev}`
- `get_requirement_revision()` (L104-116): Returns 40-char changeset hash using `hg parents --template={node}`
- `get_subdirectory()` (L124-135): Finds Python project root relative to repo root using `hg root`
- `get_repository_root()` (L137-160): Determines repo root with fallback error handling

**Utilities:**
- `get_base_rev_args()` (L32-34): Static method formatting revision arguments as `--rev={rev}`
- `is_commit_id_equal()` (L118-121): Always returns False (conservative assumption)

**Dependencies:**
- Inherits from `pip._internal.vcs.versioncontrol.VersionControl`
- Uses `configparser` for `.hg/hgrc` manipulation
- Leverages pip's subprocess utilities and URL handling
- Registered with global VCS registry (L163)

**Architecture:** Follows pip's VCS adapter pattern, translating generic version control operations into Mercurial-specific command sequences.