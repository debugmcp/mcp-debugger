# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/utils/wheel.py
@source-hash: 6f8e368e4c9d1478
@generated: 2026-02-09T17:59:38Z

This module provides utilities for parsing and validating Python wheel files (.whl) within pip's internal infrastructure. It ensures wheel files conform to basic standards and extracts essential metadata for package installation.

## Core Constants
- `VERSION_COMPATIBLE = (1, 0)` (L14): Defines the wheel specification version that pip supports

## Primary Functions

**`parse_wheel(wheel_zip: ZipFile, name: str) -> Tuple[str, Message]` (L20-35)**
Entry point function that orchestrates complete wheel validation and metadata extraction. Returns the .dist-info directory name and parsed WHEEL metadata. Wraps exceptions in UnsupportedWheel with contextual information about the wheel name.

**`wheel_dist_info_dir(source: ZipFile, name: str) -> str` (L38-66)**
Locates and validates the .dist-info directory within the wheel archive. Ensures exactly one .dist-info directory exists and its name matches the canonical package name. Critical for wheel structure validation.

**`read_wheel_metadata_file(source: ZipFile, path: str) -> bytes` (L69-75)**
Robust file reader that handles common ZipFile exceptions (corruption, missing files, password protection) and converts them to UnsupportedWheel exceptions with descriptive error messages.

**`wheel_metadata(source: ZipFile, dist_info_dir: str) -> Message` (L78-94)**
Extracts and parses the WHEEL metadata file from the .dist-info directory. Handles UTF-8 decoding and uses email.parser.Parser to parse RFC 2822-style metadata format. Note: Ignores parser defects for backward compatibility.

**`wheel_version(wheel_data: Message) -> Tuple[int, ...]` (L97-110)**
Extracts and parses the Wheel-Version field from WHEEL metadata into a tuple of integers for version comparison. Validates presence and format of version string.

**`check_compatibility(version: Tuple[int, ...], name: str) -> None` (L113-134)**
Enforces wheel version compatibility policy. Raises UnsupportedWheel for major version incompatibility (e.g., 2.0 vs 1.x), warns for minor version differences (e.g., 1.2 vs 1.1). Implements pip's conservative wheel version support strategy.

## Dependencies
- Standard library: zipfile, email.parser, email.message, logging, typing
- pip._vendor.packaging.utils: canonicalize_name for package name normalization
- pip._internal.exceptions: UnsupportedWheel custom exception

## Architecture Notes
- Uses ZipFile abstraction throughout for wheel file access
- Consistent error handling pattern: catches specific exceptions and re-raises as UnsupportedWheel
- Follows principle of failing fast on invalid wheel structure
- Maintains backward compatibility by ignoring email parser defects
- All path operations use forward slashes per ZIP file specification