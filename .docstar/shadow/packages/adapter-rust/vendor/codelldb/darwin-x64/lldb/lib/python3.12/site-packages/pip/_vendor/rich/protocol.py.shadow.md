# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/protocol.py
@source-hash: e611c70c33477247
@generated: 2026-02-09T18:00:01Z

**Primary Purpose**: Protocol utilities for Rich's rendering system, providing object type checking and safe casting for renderable objects.

**Key Functions**:
- `is_renderable(check_object)` (L10-16): Determines if an object can be rendered by Rich by checking for string type or `__rich__`/`__rich_console__` methods
- `rich_cast(renderable)` (L19-42): Safely converts objects to Rich renderables by recursively calling `__rich__` methods with cycle detection

**Core Logic**:
The `rich_cast` function implements a safe casting mechanism that:
1. Uses a visited set (L30) to prevent infinite loops during recursive `__rich__` calls
2. Employs a "gibberish" string sentinel (L7, L33-34) to detect malicious objects that claim to have all attributes
3. Breaks cycles by tracking visited types and stopping when a type is encountered twice
4. Falls back to `repr()` for objects with suspicious attribute behavior

**Dependencies**: 
- typing module for type annotations
- inspect.isclass for class detection  
- Rich console types (TYPE_CHECKING import)

**Architectural Patterns**:
- Protocol-based duck typing for renderable detection
- Defensive programming against infinite recursion and attribute spoofing
- Lazy import of RenderableType to avoid circular dependencies

**Critical Invariants**:
- Objects claiming to have the gibberish attribute are treated as suspicious and converted to repr
- Type-based cycle detection prevents infinite loops in `__rich__` method chains
- Class objects are excluded from rich casting to avoid unintended behavior