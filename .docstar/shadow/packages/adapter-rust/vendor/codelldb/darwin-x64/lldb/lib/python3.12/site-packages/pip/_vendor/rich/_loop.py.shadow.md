# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_loop.py
@source-hash: 855ffa08b7683e6d
@generated: 2026-02-09T17:59:55Z

## Purpose
Utility module providing iterator enhancement functions for identifying first/last elements in sequences. Part of the Rich library's internal utilities for terminal formatting where position-aware rendering is needed.

## Key Functions

### `loop_first(values)` (L6-15)
- **Role**: Augments iteration with first-element detection
- **Returns**: `Iterable[Tuple[bool, T]]` where bool indicates if element is first
- **Implementation**: Uses lookahead pattern - extracts first element separately, yields `(True, first_value)`, then `(False, remaining_values)`
- **Edge case**: Returns immediately on empty iterables (L12)

### `loop_last(values)` (L18-28) 
- **Role**: Augments iteration with last-element detection
- **Returns**: `Iterable[Tuple[bool, T]]` where bool indicates if element is last
- **Implementation**: Uses lookbehind pattern - maintains `previous_value`, yields `(False, previous)` until iterator exhausted, then `(True, final_value)`
- **Edge case**: Returns immediately on empty iterables (L24)

### `loop_first_last(values)` (L31-43)
- **Role**: Combines both first and last element detection
- **Returns**: `Iterable[Tuple[bool, bool, T]]` where bools indicate (is_first, is_last)
- **Implementation**: Hybrid approach using `first` flag (L38-41) and lookbehind for last detection
- **Edge case**: Returns immediately on empty iterables (L37)

## Type System
- Generic type variable `T` (L3) enables type-safe iteration over any iterable type
- All functions preserve element type while adding positional metadata

## Architectural Patterns
- **Lazy evaluation**: All functions are generators, processing elements on-demand
- **Consistent error handling**: All functions handle empty iterables gracefully via early return
- **Single-pass iteration**: Each function consumes input iterable exactly once
- **Memory efficient**: O(1) space complexity using generator pattern

## Use Cases
Primarily used in Rich's rendering pipeline for applying different formatting to boundary elements (e.g., different borders for first/last table rows, special handling of list item separators).