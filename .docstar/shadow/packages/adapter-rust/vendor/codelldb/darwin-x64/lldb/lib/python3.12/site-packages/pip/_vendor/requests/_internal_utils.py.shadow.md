# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/requests/_internal_utils.py
@source-hash: 9cc4329abe21b37d
@generated: 2026-02-09T17:59:48Z

**Purpose**: Internal utility module for the Requests library providing low-level string handling and HTTP header validation functions with minimal external dependencies.

**Key Functions**:
- `to_native_string(string, encoding="ascii")` (L25-35): Converts any string type to native string representation, decoding bytes to string using specified encoding (defaults to ASCII). Uses `builtin_str` from compat module for type checking.
- `unicode_is_ascii(u_string)` (L38-50): Validates if a Unicode string contains only ASCII characters by attempting ASCII encoding. Includes assertion to ensure input is str type.

**Header Validation Infrastructure** (L12-22):
- Pre-compiled regex patterns for HTTP header validation in both byte and string formats
- `_VALID_HEADER_NAME_RE_*`: Validates header names (no colons, spaces, or line breaks at start)
- `_VALID_HEADER_VALUE_RE_*`: Validates header values (non-space start or empty, no line breaks)
- `HEADER_VALIDATORS` dict maps data types (bytes/str) to appropriate validator tuples

**Dependencies**:
- `re` module for regex compilation
- `.compat.builtin_str` for cross-Python version string type compatibility

**Architectural Notes**:
- Designed for minimal dependencies as stated in module docstring
- Type-aware validation supporting both bytes and string HTTP headers
- ASCII-centric string handling with configurable encoding fallback