# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/utils/hashes.py
@source-hash: 68b8409435de100f
@generated: 2026-02-09T17:59:39Z

## Primary Purpose
Hash validation utility for pip package verification, providing cryptographic integrity checking for downloads and installations.

## Key Components

### Constants (L11-18)
- `FAVORITE_HASH = "sha256"`: Default hash algorithm, can be changed as cryptographic standards evolve
- `STRONG_HASHES`: List of collision-resistant algorithms allowed for `--hash` option and `pip hash` command

### Hashes Class (L21-129)
Core hash validation class that manages multiple hash algorithms simultaneously.

**Key Methods:**
- `__init__(hashes)` (L27-37): Accepts dict mapping algorithm names to lists of allowed hex digests, sorts values for consistent equality checks
- `__and__(other)` (L39-56): Intersection operation for combining hash requirements; returns union if either is empty, otherwise intersection of common algorithms
- `digest_count` (L59-60): Property returning total number of allowed hash digests across all algorithms
- `is_hash_allowed(hash_name, hex_digest)` (L62-64): Validates if specific hash digest is in allowed set
- `check_against_chunks(chunks)` (L66-87): Core validation - computes hashes from data chunks, raises `HashMismatch` if none match allowed values
- `check_against_file(file)` (L92-98): Convenience wrapper using `read_chunks` utility
- `check_against_path(path)` (L100-102): File path validation wrapper
- `has_one_of(hashes)` (L104-109): Checks if any provided hash is in allowed set
- `_raise(gots)` (L89-90): Error helper raising `HashMismatch` with computed vs expected hashes

**Special Methods:**
- `__bool__()` (L111-113): Returns True if any hashes are configured
- `__eq__()` (L115-118): Equality based on internal `_allowed` dict
- `__hash__()` (L120-129): Creates deterministic hash from sorted algorithm:digest pairs

### MissingHashes Class (L132-147)
Specialized subclass for handling missing hash requirements.

**Purpose:** When no hash is provided for a requirement, computes actual hash and raises `HashMissing` to show user what the hash should be.

**Key Methods:**
- `__init__()` (L140-144): Initializes with empty list for `FAVORITE_HASH`, ensuring validation always fails
- `_raise(gots)` (L146-147): Overrides parent to raise `HashMissing` with computed hash

## Dependencies
- `hashlib`: Core cryptographic operations
- `pip._internal.exceptions`: `HashMismatch`, `HashMissing`, `InstallationError`
- `pip._internal.utils.misc.read_chunks`: File reading utility

## Architecture Notes
- Supports multiple hash algorithms simultaneously for compatibility
- Hash intersection operation enables combining requirements from different sources
- Error handling distinguishes between hash mismatches and missing hashes
- Deterministic hashing and sorting ensures consistent behavior across runs