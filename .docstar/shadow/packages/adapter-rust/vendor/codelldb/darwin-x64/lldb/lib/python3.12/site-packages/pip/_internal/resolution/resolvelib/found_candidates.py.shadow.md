# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py
@source-hash: f61ad3c90a85be5f
@generated: 2026-02-09T17:57:32Z

## Primary Purpose
Provides lazy candidate iteration utilities for pip's dependency resolver. Optimizes performance by deferring expensive operations (fetching, extracting, building) until candidates are actually needed, avoiding "downloading the world" for resolution.

## Key Components

### Type Definitions
- `IndexCandidateInfo` (L24): Type alias for `Tuple[_BaseVersion, Callable[[], Optional[Candidate]]]` - pairs version with lazy candidate factory
- `SequenceCandidate` (L27-39): Compatibility type alias for `Sequence[Candidate]`, handling Python <3.9 subscripting limitations

### Core Iterator Functions
- `_iter_built()` (L42-71): Iterates candidates when no package is installed. Handles duplicate version deduplication and `MetadataInvalid` exceptions with user-friendly warnings
- `_iter_built_with_prepended()` (L73-93): Yields installed candidate first, then index candidates. Used when resolver prefers existing installation over upgrades
- `_iter_built_with_inserted()` (L95-125): Strategically inserts installed candidate based on version ordering. Used when resolver prefers upgrades - installed candidate appears before older/equal versions

### Main Class
`FoundCandidates` (L127-174): Lazy sequence implementing `SequenceCandidate` protocol
- Constructor (L136-146): Takes candidate info getter, optional installed candidate, preference flag, and incompatible candidate IDs
- `__iter__()` (L154-162): Routes to appropriate iterator function based on installation state and preferences, filters incompatible candidates
- `__getitem__()` and `__len__()` (L148-168): Intentionally raise `NotImplementedError` for performance - resolver shouldn't use indexing
- `__bool__()` (L170-174): Cached check for candidate existence, optimized for installed-preferred scenarios

## Key Dependencies
- `pip._vendor.packaging.version._BaseVersion`: Version comparison and deduplication
- `pip._internal.exceptions.MetadataInvalid`: Exception handling for corrupted package metadata
- `.base.Candidate`: Core candidate abstraction

## Architectural Patterns
- **Lazy Evaluation**: All candidate creation deferred until iteration
- **Strategy Pattern**: Three different iteration strategies based on resolver preferences
- **Generator Pattern**: Memory-efficient streaming of candidates
- **Deduplication**: Version-based duplicate prevention across all iterators

## Critical Invariants
- Candidates with same version are deduplicated within single iteration
- Installed candidates appear exactly once in iteration sequence
- MetadataInvalid exceptions don't halt entire resolution process
- Iterator selection based on `_installed` existence and `_prefers_installed` flag