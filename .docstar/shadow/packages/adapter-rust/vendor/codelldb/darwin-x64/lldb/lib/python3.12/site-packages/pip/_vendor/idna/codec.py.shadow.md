# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/idna/codec.py
@source-hash: 3d2ea6f9799d493e
@generated: 2026-02-09T17:59:47Z

## Primary Purpose

Provides Python codec implementations for IDNA (Internationalized Domain Names in Applications) encoding/decoding. Registers the 'idna2008' codec with Python's codecs module to enable IDNA domain name handling through standard Python text encoding mechanisms.

## Key Classes and Functions

### Codec (L8-26)
Base codec class inheriting from `codecs.Codec`. Provides simple encode/decode methods that delegate to core IDNA functions.
- `encode()` (L10-17): Converts Unicode strings to bytes using IDNA encoding, only supports 'strict' error handling
- `decode()` (L19-26): Converts bytes to Unicode strings using IDNA decoding, only supports 'strict' error handling

### IncrementalEncoder (L28-59) 
Inherits from `codecs.BufferedIncrementalEncoder` for streaming IDNA encoding with label boundary handling.
- `_buffer_encode()` (L29-59): Handles partial domain name encoding by splitting on Unicode dots, preserving incomplete labels between calls when `final=False`
- Uses `_unicode_dots_re` to split on various Unicode dot characters
- Processes labels individually with `alabel()` function

### IncrementalDecoder (L61-94)
Inherits from `codecs.BufferedIncrementalDecoder` for streaming IDNA decoding.
- `_buffer_decode()` (L62-94): Similar label-by-label processing but uses `ulabel()` for decoding
- Handles ASCII input conversion and preserves trailing dots

### Stream Classes (L97-102)
- `StreamWriter` (L97-98): Multiple inheritance from Codec and `codecs.StreamWriter`
- `StreamReader` (L101-102): Multiple inheritance from Codec and `codecs.StreamReader`

### Registration Function (L105-116)
- `search_function()` (L105-116): Codec discovery function that returns `CodecInfo` for 'idna2008' codec name
- Registers all codec components with Python's codec system

## Dependencies and Relationships

- **Core Module**: Imports `encode`, `decode`, `alabel`, `ulabel`, `IDNAError` from `.core`
- **Standard Library**: Uses `codecs` for codec framework, `re` for Unicode dot pattern matching
- **Unicode Dot Regex** (L6): Matches various Unicode dot characters: U+002E (.), U+3002 (。), U+FF0E (．), U+FF61 (｡)

## Architectural Patterns

- **Codec Framework Integration**: Follows Python's standard codec protocol with encode/decode methods returning (result, consumed_length) tuples
- **Incremental Processing**: Implements buffered incremental codecs for handling streaming data with proper label boundary preservation
- **Error Handling**: Only supports 'strict' error handling mode, raises `IDNAError` for other modes
- **Label-Based Processing**: Splits domain names on dot separators and processes each label independently

## Critical Invariants

- All codec methods only accept 'strict' error handling
- Empty input returns empty result with 0 consumed length
- Incremental codecs preserve incomplete labels when `final=False` to handle streaming scenarios
- Size calculations track original input length, not encoded output length
- Trailing dots are preserved in both encoding and decoding operations