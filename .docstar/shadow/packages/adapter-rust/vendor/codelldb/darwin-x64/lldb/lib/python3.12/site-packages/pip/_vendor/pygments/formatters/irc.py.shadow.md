# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/irc.py
@source-hash: 129fa6f23777be81
@generated: 2026-02-09T17:57:38Z

## Purpose and Responsibility

Implements IRC color sequence formatting for code syntax highlighting. Converts Pygments token types into IRC control codes for colorized output in IRC clients and terminals.

## Key Components

### Constants and Mappings

- **IRC_COLORS (L22-51)**: Primary token-to-color mapping dictionary. Maps Pygments token types to tuples of (light background, dark background) color names. Supports special formatting prefixes (* for bold, _ for italic).

- **IRC_COLOR_MAP (L54-74)**: Maps color names to IRC numeric color codes (0-15). Includes ANSI compatibility mappings (e.g., 'green': 7, 'cyan': 10).

### Core Functions

- **ircformat(color, text) (L76-94)**: Converts color names and text into IRC control sequences. Handles formatting modifiers:
  - '_' prefix/suffix for italic (\x1D)
  - '*' prefix/suffix for bold (\x02) 
  - Color codes using \x03 + zero-padded numeric code
  - Returns formatted string with opening and closing control sequences

### Main Formatter Class

- **IRCFormatter (L97-154)**: Main formatter class inheriting from Pygments Formatter base class.

#### Key Methods:
- **__init__(options) (L122-128)**: Configures formatter with background mode (light/dark), custom colorscheme, and line numbering options.
- **_write_lineno(outfile) (L130-133)**: Writes formatted line numbers when enabled.
- **format_unencoded(tokensource, outfile) (L135-154)**: Core formatting logic that processes token stream and writes IRC-formatted output.

#### Configuration Options:
- `bg`: 'light' or 'dark' background mode selection
- `colorscheme`: Custom token-to-color mapping override
- `linenos`: Enable/disable line numbering

## Architecture Patterns

- **Token Type Resolution**: Uses hierarchical token type lookup - if exact token type not found, strips rightmost component until match found (L140-142)
- **Newline Handling**: Splits multi-line values and applies formatting per line while managing line number output (L145-152)
- **Dual Color Scheme**: Maintains separate color sets for light/dark backgrounds accessed via boolean index (L144)

## Dependencies

- `pygments.formatter.Formatter`: Base formatter class
- `pygments.token`: Token type definitions for syntax elements
- `pygments.util.get_choice_opt`: Option validation utility

## Critical Constraints

- IRC color codes limited to 0-15 range
- Control sequences must be properly paired (open/close)
- Line number formatting requires careful newline handling to maintain synchronization