# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/msgpack/ext.py
@source-hash: 7caa74d01a832e35
@generated: 2026-02-09T17:59:47Z

## Purpose
Extension types implementation for msgpack protocol, providing two core classes for handling custom data types in msgpack serialization: `ExtType` for generic extension data and `Timestamp` for precise time representation.

## Key Classes

### ExtType (L6-16)
Namedtuple-based immutable container for msgpack extension types with validation:
- **Fields**: `code` (0-127 integer), `data` (bytes)
- **Constructor validation**: Type checks for int/bytes, range validation for code
- Used to represent arbitrary extension data in msgpack format

### Timestamp (L19-168)
Immutable precision timestamp class supporting nanosecond resolution:
- **Attributes**: `seconds` (since UNIX epoch), `nanoseconds` (0-999,999,999)
- **Slots optimization**: Memory-efficient with `__slots__` declaration (L29)

## Core Methods

### Serialization/Deserialization (L71-116)
- `from_bytes()` (L71-95): Static method unpacking 4/8/12-byte formats into Timestamp
- `to_bytes()` (L97-116): Instance method packing to variable-length format (32/64/96-bit)
- Handles three msgpack timestamp formats based on value ranges

### Unix Timestamp Conversion (L119-152)
- `from_unix()` (L119-127): Creates from floating-point seconds
- `to_unix()` (L129-135): Returns float seconds with nanosecond precision
- `from_unix_nano()` (L138-144): Creates from nanosecond integer
- `to_unix_nano()` (L146-152): Returns nanosecond integer

### DateTime Integration (L154-168)
- `to_datetime()` (L154-160): Converts to UTC datetime object
- `from_datetime()` (L163-168): Creates from datetime with timezone

### Standard Object Protocol (L53-68)
- `__repr__()`, `__eq__()`, `__ne__()`, `__hash__()` for proper object behavior
- Equality based on both seconds and nanoseconds comparison

## Dependencies
- `collections.namedtuple` for ExtType base class
- `datetime` module for timezone-aware conversions  
- `struct` module for binary packing/unpacking

## Architecture Notes
- Designed for dual-mode operation: Cython (C methods) vs pure Python
- Timestamp uses variable-length encoding for space efficiency
- Immutable design prevents accidental modification of time values
- Comprehensive validation in constructors prevents invalid states