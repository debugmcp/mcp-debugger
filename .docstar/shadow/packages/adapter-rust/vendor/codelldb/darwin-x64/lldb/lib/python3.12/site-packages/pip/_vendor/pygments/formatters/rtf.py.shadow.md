# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/rtf.py
@source-hash: 680d2ffe9b16e8a6
@generated: 2026-02-09T17:57:37Z

## Purpose
RTF (Rich Text Format) output formatter for Pygments syntax highlighting. Converts tokenized source code into RTF markup with color, font styling, and formatting suitable for copying into Microsoft Word and other RTF-compatible applications.

## Key Components

### RtfFormatter Class (L18-146)
Main formatter class inheriting from `Formatter`. Generates complete RTF documents with embedded color tables and styling information.

**Constructor** (L50-64):
- Accepts `fontface` option for custom font family specification
- Accepts `fontsize` option in half-points (default 24 = 12pt font)
- Ignores encoding options as RTF handles Unicode via escape sequences

**Core Methods**:
- `_escape(text)` (L66-69): Escapes RTF special characters (`\`, `{`, `}`)
- `_escape_text(text)` (L71-93): Comprehensive text escaping with Unicode handling
  - ASCII characters (< 128): passed through unchanged
  - Unicode BMP characters (128-65535): converted to `{\u####}` format
  - Higher Unicode planes (>65535): converted to surrogate pairs via `surrogatepair()` utility
  - Newlines converted to RTF paragraph breaks (`\par`)

- `format_unencoded(tokensource, outfile)` (L95-146): Main formatting logic
  - Writes RTF 1.8 header with font table and character set declarations
  - Builds color table from style definitions (L104-116)
  - Maps Pygments token types to RTF formatting commands
  - Supports: background color (`\cb`), text color (`\cf`), bold (`\b`), italic (`\i`), underline (`\ul`), borders (`\chbrdr`)

## Dependencies
- `pip._vendor.pygments.formatter.Formatter`: Base formatter class
- `pip._vendor.pygments.util.get_int_opt`: Integer option parsing utility  
- `pip._vendor.pygments.util.surrogatepair`: Unicode surrogate pair generation

## Architecture Notes
- RTF format is ASCII-native but handles Unicode through escape sequences
- Color mapping system assigns sequential indices to unique colors for RTF color table
- Token type hierarchy traversal finds applicable styles when direct matches unavailable
- Output is self-contained RTF document requiring no external dependencies

## Key Constraints
- RTF Unicode support limited to 16-bit values, requiring surrogate pairs for higher planes
- Font specification uses RTF's `\fmodern` family designation for monospace fonts
- All colors must be pre-registered in RTF color table before use