# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/resolution/legacy/resolver.py
@source-hash: dc766224145dd454
@generated: 2026-02-09T17:57:39Z

## Legacy Dependency Resolver for pip

This file implements pip's legacy dependency resolution algorithm with a "first found, wins" breadth-first strategy. The resolver handles package installation conflicts, version constraints, and dependency ordering.

### Core Resolution Algorithm (L1-11)
- Top-level requirements: Only one spec per project allowed; overrides sub-dependencies
- Sub-dependencies: "first found, wins" with breadth-first traversal
- Double requirements raise exceptions for conflicting top-level specs

### Key Components

**Resolver Class (L109-596)**
Main dependency resolver inheriting from BaseResolver. Manages the complete resolution process including conflict detection, upgrade strategies, and installation ordering.

Constructor (L116-153): Configures resolution behavior with upgrade strategies ("eager", "only-if-needed", "to-satisfy-only"), Python version compatibility, and installation flags.

**Core Resolution Methods**
- `resolve()` (L154-189): Main entry point that processes root requirements, discovers dependencies, and handles hash validation
- `_resolve_one()` (L487-568): Resolves a single requirement, extracts its dependencies, and validates Python compatibility
- `_add_requirement_to_set()` (L191-304): Adds requirements to the resolution set with conflict detection and constraint handling

**Installation Strategy Methods**
- `_is_upgrade_allowed()` (L306-313): Determines upgrade eligibility based on configured strategy
- `_check_skip_installed()` (L326-378): Evaluates whether to skip already-installed packages
- `_set_req_to_reinstall()` (L315-324): Marks requirements for reinstallation

**Link Resolution and Caching**
- `_find_requirement_link()` (L380-400): Locates download links for requirements, handles yanked packages
- `_populate_link()` (L402-439): Ensures requirements have download links, integrates wheel caching
- `_get_dist_for()` (L441-485): Prepares distributions for installation (editable, installed, or linked)

**Dependency Management**
- `get_installation_order()` (L570-596): Creates topological installation order, breaks cycles arbitrarily
- `_discovered_dependencies` (L152): Tracks dependency relationships for ordering

### Utility Functions

**_check_dist_requires_python() (L55-106)**
Validates Python version compatibility against distribution's Requires-Python metadata. Handles invalid specifiers gracefully and respects ignore flags.

### Key Dependencies
- Uses `PackageFinder` for locating packages and versions
- Integrates with `RequirementPreparer` for package preparation
- Leverages `WheelCache` for performance optimization
- Handles various pip exceptions (DistributionNotFound, HashError, etc.)

### Data Structures
- `DiscoveredDependencies` (L52): Type alias for dependency tracking
- `RequirementSet`: Container for managing requirements during resolution
- Breadth-first dependency discovery with cycle detection