# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/requests/auth.py
@source-hash: 905ef9b6a9cb72d6
@generated: 2026-02-09T17:59:59Z

## Primary Purpose
Authentication handlers module for the Requests library, providing HTTP Basic, Proxy, and Digest authentication implementations.

## Key Classes and Functions

### AuthBase (L69-73)
Abstract base class for all authentication handlers. Defines the callable interface that auth implementations must follow. Raises NotImplementedError to enforce subclass implementation.

### _basic_auth_str(username, password) (L25-66)
Utility function that creates HTTP Basic Authentication header strings. Handles backward compatibility for non-string credentials with deprecation warnings (L35-53). Encodes credentials to latin1 and base64 format per RFC standards.

### HTTPBasicAuth (L76-96)
Basic HTTP authentication handler that inherits from AuthBase. Stores username/password credentials and adds "Authorization" header to requests. Implements equality comparison methods.

### HTTPProxyAuth (L99-104)
Proxy authentication handler extending HTTPBasicAuth. Sets "Proxy-Authorization" header instead of "Authorization" for proxy authentication.

### HTTPDigestAuth (L107-314)
Complex HTTP Digest authentication handler supporting:
- Thread-safe state management via threading.local (L114)
- Multiple hash algorithms: MD5, SHA, SHA-256, SHA-512 (L143-174)
- Nonce counting and challenge-response generation (L195-234)
- Automatic retry logic for 401 responses (L241-283)
- Request body position tracking for retries (L254-257)

#### Key Methods:
- `init_per_thread_state()` (L116-124): Initializes thread-local authentication state
- `build_digest_header(method, url)` (L126-234): Constructs digest authentication header
- `handle_401(r, **kwargs)` (L241-283): Processes 401 responses and retries with digest auth
- `handle_redirect(r, **kwargs)` (L236-239): Resets auth counters on redirects

## Dependencies
- Standard library: hashlib, os, re, threading, time, warnings, base64
- Internal modules: _internal_utils, compat, cookies, utils
- External: Requests library components

## Architectural Patterns
- Template method pattern: AuthBase defines interface, subclasses implement __call__
- Thread-local storage: HTTPDigestAuth maintains per-thread state for concurrent safety
- Hook-based event handling: Digest auth registers response hooks for automatic retry
- Decorator pattern: Auth handlers wrap requests with authentication headers

## Critical Invariants
- All auth handlers must be callable and return the modified request
- Digest auth maintains nonce counting per thread to prevent replay attacks
- Basic/Proxy auth credentials are latin1 encoded per HTTP standards
- Digest auth supports algorithm negotiation with fallback to MD5

## Constants
- CONTENT_TYPE_FORM_URLENCODED = "application/x-www-form-urlencoded" (L21)
- CONTENT_TYPE_MULTI_PART = "multipart/form-data" (L22)