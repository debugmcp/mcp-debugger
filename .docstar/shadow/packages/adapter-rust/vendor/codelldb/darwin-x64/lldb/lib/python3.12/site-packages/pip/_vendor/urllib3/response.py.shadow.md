# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/response.py
@source-hash: 7e60c9005906ef5b
@generated: 2026-02-09T18:00:24Z

## Primary Purpose
HTTP response processing module for urllib3, providing content decompression, chunked transfer encoding support, and compatibility with Python's `http.client.HTTPResponse` and `io.IOBase` interfaces.

## Key Classes and Functions

### Decompression Classes
- **DeflateDecoder (L35-64)**: Handles deflate decompression with automatic fallback for raw deflate vs zlib-wrapped deflate
- **GzipDecoder (L74-101)**: Processes gzip-compressed content with multi-member support and trailing garbage tolerance
- **BrotliDecoder (L106-121)**: Optional Brotli decompression when brotli module available (conditional on L104)
- **MultiDecoder (L123-141)**: Chains multiple decoders for content with multiple encodings per RFC7231

### Response Class
- **HTTPResponse (L157-879)**: Main response container extending `io.IOBase`
  - **Constructor (L195-260)**: Initializes response state, handles body preloading, detects chunked encoding
  - **Content Reading**:
    - `read()` (L529-599): Primary read method with decode/cache options
    - `stream()` (L601-625): Generator for streaming reads
    - `read_chunked()` (L783-851): Specialized chunked transfer encoding reader
  - **Connection Management**:
    - `release_conn()` (L275-280): Returns connection to pool
    - `drain_conn()` (L282-291): Discards remaining response data
  - **Compatibility Methods**:
    - `from_httplib()` (L627-657): Factory method from `http.client.HTTPResponse`
    - `getheaders()`/`getheader()` (L660-676): Deprecated compatibility methods

### Utility Functions
- **_get_decoder() (L144-154)**: Factory function for appropriate decoder based on encoding type

## Key Architecture Patterns

### Content Decoding Pipeline
- Lazy decoder initialization via `_init_decoder()` (L369-386)
- Robust error handling in `_decode()` (L392-412) with custom exception wrapping
- Support for multiple encodings in single Content-Encoding header

### Chunked Transfer Encoding
- State tracking with `chunk_left` and chunked flags
- Specialized chunk parsing in `_update_chunk_length()` (L747-759) and `_handle_chunk()` (L761-781)
- Protocol compliance with CRLF handling

### Error Management
- Context manager `_error_catcher()` (L425-479) converts low-level exceptions to urllib3 variants
- Connection cleanup on errors with automatic release to pool
- Large read protection in `_fp_read()` (L481-527) for 32-bit integer overflow prevention

## Critical Dependencies
- `zlib` for deflate/gzip decompression
- Optional `brotli` module (L12, conditionally imported)
- `._collections.HTTPHeaderDict` for header management
- `.exceptions` module for urllib3-specific exception types
- `.util.response` for response utility functions

## Important Constraints
- Content-Length vs Transfer-Encoding conflicts handled per RFC 7230 (L324-334)
- 32-bit integer overflow protection for large reads (L496-504)
- Automatic connection release and cleanup on errors
- Chunked encoding requires `http.client.HTTPResponse`-like interface with `fp` attribute