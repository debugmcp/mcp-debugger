# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/cli/cmdoptions.py
@source-hash: d17c87635090f6d1
@generated: 2026-02-09T17:59:33Z

## Purpose
This module defines shared command-line options and option groups for pip's CLI interface. It follows a pattern of defining option factories (functions that create Option instances) rather than global instances to avoid state sharing between command parses.

## Key Components

### Core Classes
- **PipOption (L110-115)**: Extended Option class with custom type support for "path" and "package_name" types, using custom type checkers for validation and transformation.

### Utility Functions
- **raise_option_error (L36-47)**: Standardized error handler for option parsing, formats and raises parser errors with consistent messaging.
- **make_option_group (L50-59)**: Creates OptionGroup instances from dictionaries containing group metadata and option factory functions.
- **check_dist_restriction (L62-100)**: Validates compatibility between platform-specific options and dependency installation modes, enforcing pip's distribution compatibility rules.

### Type Checkers
- **_path_option_check (L102-103)**: Expands user home directory in path values using os.path.expanduser.
- **_package_name_option_check (L106-107)**: Canonicalizes package names using packaging.utils.canonicalize_name.

### Version Handling
- **_convert_python_version (L548-574)**: Parses Python version strings into tuples, supporting formats like "3", "37", or "3.7.3".
- **_handle_python_version (L577-588)**: Option callback that validates and stores Python version specifications.

### Format Control Handlers
- **_handle_no_binary (L474-482)** and **_handle_only_binary (L485-493)**: Manage mutual exclusion between binary/source package preferences using FormatControl.
- **_handle_config_settings (L821-838)**: Parses KEY=VALUE configuration settings for PEP 517 builds.

### Special Option Handlers
- **_handle_no_cache_dir (L688-714)**: Processes --no-cache-dir with backward compatibility for environment variable values.
- **_handle_no_use_pep517 (L765-797)**: Validates PEP 517 disabling, checking for required setuptools/wheel dependencies.
- **_handle_merge_hash (L910-931)**: Parses and validates cryptographic hash specifications in "algo:digest" format.

### Option Factory Functions
The module defines numerous option factories (L121-1028) as partial function applications, including:
- **Basic options**: help_, debug_mode, isolated_mode, verbose, quiet, version
- **Network options**: proxy, retries, timeout, cert, client_cert
- **Index options**: index_url, extra_index_url(), no_index, find_links()
- **Installation options**: src, platforms, python_version, implementation, abis
- **Build options**: use_pep517, no_use_pep517, config_settings, build_options
- **Security options**: hash, require_hashes, trusted_host()

### Option Groups
- **general_group (L1035-1064)**: Collection of general-purpose CLI options
- **index_group (L1066-1074)**: Package index and repository options

### Helper Functions
- **add_target_python_options (L646-650)**: Adds platform targeting options to command option groups
- **make_target_python (L653-661)**: Creates TargetPython instances from parsed options
- **check_list_path_option (L971-973)**: Validates path option combinations for list commands

## Architecture Patterns
- **Factory Pattern**: All options are defined as factory functions to prevent state sharing
- **Callback Pattern**: Complex option validation uses optparse callbacks for custom processing
- **Mutual Exclusion**: Format control options enforce mutually exclusive binary/source preferences
- **Type Extension**: Custom option types extend optparse's built-in validation capabilities

## Dependencies
- Uses pip's internal modules for configuration parsing, exceptions, and utility functions
- Integrates with pip._vendor.packaging for name canonicalization
- Relies on importlib.util for dynamic package availability checking

## Critical Constraints
- Options with action='append' must not carry state between parses (L4-7)
- Distribution restriction options require either --no-deps or --only-binary=:all: (L82-92)
- Platform-specific options require --target or --dry-run when not in dry-run mode (L94-99)
- Hash algorithms must be from STRONG_HASHES set for security (L925-930)