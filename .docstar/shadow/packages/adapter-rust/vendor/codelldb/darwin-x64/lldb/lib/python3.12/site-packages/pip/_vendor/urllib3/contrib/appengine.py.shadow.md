# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/appengine.py
@source-hash: 551ebc780544d77e
@generated: 2026-02-09T17:57:41Z

## Purpose
Provides Google App Engine URLFetch-based HTTP connection management for urllib3 in sandboxed GAE environments. Adapts URLFetch API to urllib3's interface while handling GAE-specific limitations and error conditions.

## Key Components

### Exception Classes
- `AppEnginePlatformWarning` (L71-72): Warning for URLFetch-specific issues
- `AppEnginePlatformError` (L75-76): Error for URLFetch platform limitations

### Core Manager Class
- `AppEngineManager` (L79-306): Main connection manager implementing RequestMethods interface
  - Inherits from RequestMethods for standard HTTP method support
  - Uses Google App Engine's URLFetch service instead of sockets
  - Enforces URLFetch limitations (10MB request, 32MB response, limited methods)

### Key Methods
- `__init__` (L99-123): Initializes manager with validation and retry configuration
  - Validates URLFetch availability, issues platform warning
  - Configures certificate validation and retry behavior
- `urlopen` (L131-243): Main HTTP request method
  - Translates urllib3 parameters to URLFetch API
  - Handles URLFetch-specific exceptions and error mapping
  - Manages redirects and retries with URLFetch constraints
- `_urlfetch_response_to_http_response` (L245-279): Response adaptation
  - Converts URLFetch response to urllib3 HTTPResponse
  - Handles encoding header cleanup for production GAE
  - Creates file-like body objects from URLFetch content
- `_get_absolute_timeout` (L281-292): Timeout conversion for URLFetch
- `_get_retries` (L294-305): Retry configuration validation

### Exception Mapping (L157-187)
Maps URLFetch exceptions to urllib3 equivalents:
- `DeadlineExceededError` → `TimeoutError`
- `InvalidURLError` → `AppEnginePlatformError` (size) or `ProtocolError`
- `DownloadError` → `MaxRetryError` (redirects) or `ProtocolError`
- `ResponseTooLargeError` → `AppEnginePlatformError`
- `SSLCertificateError` → `SSLError`
- `InvalidMethodError` → `AppEnginePlatformError`

### Environment Detection
- Public API aliases (L308-314): Re-exports environment detection functions from `_appengine_environ`
  - `is_appengine`, `is_appengine_sandbox`, `is_local_appengine`, `is_prod_appengine`, `is_prod_appengine_mvms`

## Dependencies
- `google.appengine.api.urlfetch`: GAE URLFetch service (optional import)
- urllib3 core components: exceptions, request/response, retry/timeout utilities
- `_appengine_environ`: Environment detection module

## Architecture Notes
- Designed as drop-in replacement for urllib3.PoolManager in GAE sandbox
- Maintains urllib3 API compatibility while adapting to URLFetch constraints
- Uses context manager protocol for resource management
- Implements recursive retry/redirect logic respecting URLFetch limitations