# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/bbcode.py
@source-hash: af56fbc33593268b
@generated: 2026-02-09T17:57:33Z

## BBCode Formatter for Pygments

This file implements a Pygments formatter that converts syntax-highlighted tokens into BBCode markup for bulletin boards and forums.

### Primary Purpose
Transforms Pygments token streams into BBCode-formatted text with support for color, bold, italic, and underline formatting. Designed specifically for posting highlighted code on bulletin board systems.

### Key Components

**BBCodeFormatter Class (L18-108)**
- Inherits from `Formatter` base class
- Name: 'BBCode', aliases: ['bbcode', 'bb'] (L47-48)
- Supports three boolean options: `codetag`, `monofont`, and `style` (L33-46)

**Constructor `__init__` (L51-58)**
- Extracts boolean options using `get_bool_opt()` utility
- `self._code`: wraps output in `[code]` tags when True
- `self._mono`: adds monospace font tags when True  
- Initializes empty `self.styles` dict and calls `_make_styles()`

**Style Generation `_make_styles` (L59-77)**
- Iterates through `self.style` token type definitions
- Builds BBCode tag pairs (start/end) for each token type:
  - Color: `[color=#XXXXXX]` / `[/color]` (L62-64)
  - Bold: `[b]` / `[/b]` (L65-67)
  - Italic: `[i]` / `[/i]` (L68-70)
  - Underline: `[u]` / `[/u]` (L71-73)
- Note: No support for background colors or borders (L74)
- Stores tag pairs in `self.styles[ttype]` mapping

**Main Formatting `format_unencoded` (L78-108)**
- Writes opening tags based on options (`[code]`, `[font=monospace]`) (L79-82)
- Processes token stream with optimization: consecutive tokens of same type are batched (L84-98)
- Uses parent token type lookup when exact type not found (L88-89)
- Writes closing tags in reverse order (L103-108)

### Dependencies
- `pip._vendor.pygments.formatter.Formatter`: Base formatter class
- `pip._vendor.pygments.util.get_bool_opt`: Boolean option extraction utility

### Architectural Decisions
- Token type inheritance: Falls back to parent types when specific styles unavailable (L88-89)
- Batching optimization: Combines consecutive same-type tokens to reduce tag overhead
- Nested tag structure: Properly closes tags in LIFO order
- Limited BBCode support: Only implements widely-supported formatting options

### Key Constraints
- No background color or border support due to BBCode limitations
- Token type styles must exist in formatter's style definition
- Output requires file-like object with `write()` method