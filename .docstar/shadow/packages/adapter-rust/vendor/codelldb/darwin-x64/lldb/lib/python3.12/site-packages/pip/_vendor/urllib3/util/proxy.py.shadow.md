# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/proxy.py
@source-hash: cd4bcf3c226ba7a7
@generated: 2026-02-09T17:57:39Z

## Purpose
Utility module for HTTP proxy handling in urllib3, specifically for determining when HTTP tunneling is required and creating SSL contexts for proxy connections.

## Key Functions

### connection_requires_http_tunnel (L4-34)
Primary decision function that determines whether an HTTP CONNECT tunnel is needed through a proxy based on:
- **Proxy presence**: Returns False if no proxy_url provided (L18-19)
- **HTTP destinations**: Never requires tunneling for HTTP schemes (L22-23)  
- **HTTPS forwarding**: Supports direct forwarding for HTTPS proxies when `proxy_config.use_forwarding_for_https` is enabled (L26-31)
- **Default behavior**: Returns True for all other cases, enforcing tunneling (L34)

**Parameters:**
- `proxy_url`: URL object of the proxy server
- `proxy_config`: ProxyConfig object from poolmanager.py with forwarding settings
- `destination_scheme`: Target protocol scheme (http/https)

### create_proxy_ssl_context (L37-56)
SSL context factory for proxy connections that:
- Creates urllib3 SSL context with resolved version/cert requirements (L44-47)
- Auto-loads default certificate store when no custom certs provided (L49-55)
- Returns configured SSLContext for proxy authentication/encryption

**Parameters:**
- `ssl_version`: SSL/TLS version specification
- `cert_reqs`: Certificate verification requirements
- `ca_certs/ca_cert_dir/ca_cert_data`: Optional custom certificate sources

## Dependencies
- `.ssl_`: Imports `create_urllib3_context`, `resolve_cert_reqs`, `resolve_ssl_version` for SSL handling

## Architecture Notes
- Encapsulates proxy tunneling logic with clear decision tree
- Supports both traditional CONNECT tunneling and newer HTTPS proxy forwarding
- Provides sensible SSL defaults while allowing customization
- Designed as utility functions for higher-level connection pooling