# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/pretty.py
@source-hash: e682073ff0865a71
@generated: 2026-02-09T18:00:14Z

## Primary Purpose

Rich pretty printing implementation that generates formatted, syntax-highlighted representations of Python objects. Integrates with IPython/Jupyter and provides extensible pretty printing with configurable depth limits, string truncation, and container abbreviation.

## Key Classes and Functions

**Pretty (L244-346)**: Main renderable class for pretty printing objects. Extends `JupyterMixin` to provide rich console rendering. Key methods:
- `__init__` (L264-293): Configures formatting options (indent_size, max_length, max_string, max_depth, expand_all, etc.)
- `__rich_console__` (L295-328): Generates formatted text using `pretty_repr()` and applies highlighting
- `__rich_measure__` (L330-345): Calculates text width for layout

**Node (L390-472)**: Tree node representing object structure for pretty printing
- `iter_tokens` (L405-425): Generates string tokens for rendering
- `check_length` (L427-442): Validates if representation fits within width limits
- `render` (L448-471): Main rendering logic that expands nodes based on width constraints

**_Line (L474-540)**: Internal class representing individual output lines during rendering
- `expandable` (L488-490): Property indicating if line can be expanded
- `expand` (L500-531): Expands container nodes into multiple indented lines

## Core Functions

**traverse (L561-854)**: Main object traversal function that builds Node tree structure
- Handles special cases: dataclasses (L744-773), namedtuples (L774-797), attrs objects (L695-743), rich repr protocol (L645-694)
- Detects circular references using `visited_ids` set (L598-600)
- Respects max_depth, max_length, max_string limits
- Supports custom `__rich_repr__` protocol for objects

**pretty_repr (L857-894)**: High-level function that combines traversal and rendering
- Creates Node tree via `traverse()`
- Renders to string with width/indentation constraints

**install (L164-242)**: Installs pretty printing as default display hook
- Detects IPython environment and integrates with formatters (L214-241)
- Falls back to `sys.displayhook` replacement for standard Python REPL (L217)

## Utility Functions

**_is_dataclass_repr (L68-82)**: Detects if dataclass uses default `__repr__`
**_is_namedtuple (L542-558)**: Heuristic detection of namedtuple objects
**_has_default_namedtuple_repr (L88-105)**: Checks if namedtuple has default repr
**_safe_isinstance (L154-161)**: Safe isinstance check that handles objects without `__class__`
**is_expandable (L379-386)**: Determines if object can be expanded in pretty print

## Key Data Structures

**_BRACES (L360-374)**: Mapping of container types to their bracket representations
**_CONTAINERS (L375)**: Tuple of supported container types for pretty printing
**_MAPPING_CONTAINERS (L376)**: Subset of containers that are mappings

## Integration Points

- **IPython/Jupyter**: Custom formatter integration (L214-241)
- **attrs library**: Optional support via `_has_attrs` flag (L30-35, L58-65)
- **Rich ecosystem**: Uses highlighter, text, console components from rich library

## Notable Patterns

- Defensive programming with try/catch blocks around repr operations (L592-595)
- Circular reference detection using object ID tracking
- Lazy evaluation of object expansion based on width constraints
- Special handling for various Python types (dataclasses, namedtuples, containers)
- Support for custom repr protocols (`__rich_repr__`)

## Critical Constraints

- Max depth prevents infinite recursion in nested structures
- Max length abbreviates large containers with "... +N" notation
- Max string truncates long strings with "+N" suffix
- Width-based expansion only occurs when content exceeds available space