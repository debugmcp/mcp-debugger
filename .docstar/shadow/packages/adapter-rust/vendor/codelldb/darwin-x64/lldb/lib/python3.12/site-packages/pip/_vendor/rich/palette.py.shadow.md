# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/palette.py
@source-hash: 9489ef4753830d3d
@generated: 2026-02-09T18:00:02Z

## Purpose
Color palette management and color matching functionality for Rich terminal library. Provides efficient nearest-color lookup using weighted Euclidean distance calculation optimized for human color perception.

## Core Classes

### Palette (L11-72)
Main palette class storing RGB color sequences with color matching capabilities.

**Key Methods:**
- `__init__(colors)` (L14-15): Accepts sequence of RGB triplets
- `__getitem__(number)` (L17-18): Returns ColorTriplet for indexed access
- `__rich__()` (L20-41): Renders palette as Rich Table with visual color swatches
- `match(color)` (L44-72): Finds closest palette color using perceptually-weighted distance

### ColorBox (L83-97)
Demonstration class for displaying HLS color gradients as terminal output.

## Key Dependencies
- `ColorTriplet` from `.color_triplet`: RGB color representation
- `pip._vendor.rich.*`: Rich library components (Table, Color, Style, Text)
- Standard library: `math.sqrt`, `functools.lru_cache`, `colorsys`

## Performance Optimizations
- **LRU Cache (L44)**: 1024-entry cache for `match()` method to avoid redundant distance calculations
- **Local variable optimization (L55-56)**: Caches `sqrt` function and `__getitem__` method references
- **Perceptual color distance (L61-69)**: Uses red-mean weighted formula accounting for human eye sensitivity differences across RGB channels

## Color Matching Algorithm
Uses modified Euclidean distance with red-channel weighting based on average red value:
- Higher weight for red differences when red_mean > 256
- Standard green weighting (4x multiplier)
- Lower weight for blue differences when red_mean < 256
- Bit-shifting operations for performance optimization

## Architecture Notes
- Immutable design: Colors stored as private `_colors` attribute
- Rich protocol integration via `__rich__()` method
- Demo code isolated in `if __name__ == "__main__"` block (L75-100)