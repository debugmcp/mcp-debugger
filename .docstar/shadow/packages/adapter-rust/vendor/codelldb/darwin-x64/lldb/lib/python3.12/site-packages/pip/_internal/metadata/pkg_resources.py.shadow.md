# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/metadata/pkg_resources.py
@source-hash: 534ec44c020d4867
@generated: 2026-02-09T17:59:38Z

## Primary Purpose
Implements a pip metadata adapter that uses the `pkg_resources` library to provide package distribution information. This is one of pip's metadata backend implementations, providing a concrete implementation of the base metadata interfaces for working with installed Python packages.

## Key Classes and Functions

### EntryPoint (L42-46)
Simple NamedTuple representing a package entry point with name, value, and group attributes.

### InMemoryMetadata (L48-81)
Implements IMetadataProvider interface for reading metadata from an in-memory dictionary. Key responsibilities:
- `get_metadata(name)` (L61-68): Decodes metadata bytes to string, wrapping UnicodeDecodeError as UnsupportedWheel
- `has_metadata(name)` (L58-59): Checks if metadata key exists
- `get_metadata_lines(name)` (L70-71): Returns metadata as iterable lines using pkg_resources.yield_lines

### Distribution (L83-251)
Core class wrapping `pkg_resources.Distribution` to implement BaseDistribution interface. Key functionality:

**Class Methods:**
- `from_directory(directory)` (L100-117): Creates distribution from .egg-info or .dist-info directory
- `from_metadata_file_contents(metadata_contents, filename, project_name)` (L120-134): Creates distribution from raw metadata bytes
- `from_wheel(wheel, name)` (L137-155): Extracts metadata from wheel file, handles zipfile errors

**Properties:**
- `location` (L158-159): Distribution file location
- `installed_location` (L162-170): Resolved installation path, considering egg-link files
- `canonical_name` (L187-188): Normalized package name
- `version` (L191-192): Parsed version object
- `installed_by_distutils` (L177-184): Detects distutils-installed packages via provider introspection

**Core Methods:**
- `read_text(path)` (L204-211): Reads metadata file content, raises appropriate exceptions
- `iter_entry_points()` (L213-217): Yields EntryPoint objects from distribution's entry map
- `_metadata_impl()` (L219-239): Parses METADATA/PKG-INFO using email.parser, handles missing metadata gracefully
- `iter_dependencies(extras)` (L241-247): Returns requirements with optional extras filtering
- `_extra_mapping` (L91-97): Lazy-loaded mapping of normalized to original extra names

### Environment (L253-301)
Wraps `pkg_resources.WorkingSet` to implement BaseEnvironment interface:

**Class Methods:**
- `default()` (L258-259): Returns environment using global working_set
- `from_paths(paths)` (L262-263): Creates environment from custom path list

**Core Methods:**
- `_iter_distributions()` (L265-267): Yields Distribution objects from working set
- `_search_distribution(name)` (L269-279): Finds distribution by canonical name comparison
- `get_distribution(name)` (L281-301): Searches distribution with fallback to working_set.require() for edge cases like double installation scenarios

## Dependencies
- `pkg_resources`: Core dependency for distribution management
- `packaging`: For requirement parsing, name canonicalization, and version handling  
- `email`: For parsing package metadata format
- `pip._internal.utils`: For wheel parsing, egg-link handling, path utilities
- `pip._internal.exceptions`: Custom exception types (InvalidWheel, UnsupportedWheel, NoneMetadataError)

## Architectural Patterns
- **Adapter Pattern**: Wraps pkg_resources classes to implement pip's internal metadata interfaces
- **Lazy Loading**: Extra mappings are computed on first access (L92)
- **Factory Methods**: Multiple class methods for creating Distribution instances from different sources
- **Error Translation**: Maps external exceptions to pip's internal exception hierarchy

## Critical Invariants
- Distribution names are always canonicalized for comparison (L187, L275)
- Metadata encoding errors are wrapped as UnsupportedWheel exceptions (L66-68)
- Missing metadata files result in empty string rather than failure (L236)
- Working set is refreshed if initial distribution lookup fails (L298)