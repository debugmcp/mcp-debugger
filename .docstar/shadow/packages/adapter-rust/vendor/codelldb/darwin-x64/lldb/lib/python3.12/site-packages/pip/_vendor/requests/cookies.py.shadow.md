# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/requests/cookies.py
@source-hash: 6cd8be8aa123e0d3
@generated: 2026-02-09T18:00:06Z

## Purpose
Provides compatibility layer for using Python's `http.cookiejar.CookieJar` with the requests library. Bridges the interface gap between requests' Request/Response objects and the urllib2-style objects expected by the standard library's cookie handling.

## Key Classes

### MockRequest (L23-101)
Adapter that wraps a `requests.Request` to mimic `urllib2.Request` interface required by `http.cookiejar.CookieJar`. Key methods:
- `__init__(request)` (L35): Stores request and initializes new headers tracking
- `get_full_url()` (L49): Handles Host header override by reconstructing URL with custom host
- `add_unredirected_header(name, value)` (L84): Accumulates new headers without affecting original request
- Properties `host`, `origin_req_host`, `unverifiable` (L94-101): Expose required urllib2 interface

### MockResponse (L103-122)
Simple wrapper around HTTP response headers to provide the interface expected by cookiejar's `extract_cookies()` method.
- `info()` (L117): Returns the wrapped headers object
- `getheaders(name)` (L120): **Missing return statement** - calls but doesn't return result

### RequestsCookieJar (L176-438)
Main cookie container that extends `http.cookiejar.CookieJar` with dict-like interface and requests-specific functionality:

#### Dict Interface Methods (L194-347)
- `get(name, default, domain, path)` (L194): O(n) lookup with optional domain/path filtering
- `set(name, value, **kwargs)` (L206): Handles None values as deletion, Morsel conversion
- `keys()`, `values()`, `items()` and iter variants (L225-275): Standard dict methods
- `__getitem__`, `__setitem__`, `__delitem__` (L327-347): Dict operators

#### Cookie Management (L277-413)
- `list_domains()`, `list_paths()` (L277-291): Utility methods for introspection
- `multiple_domains()` (L293): Boolean check for multi-domain usage
- `get_dict(domain, path)` (L306): Extract filtered name-value dict
- `_find()` (L366): Internal method that arbitrarily picks first match on conflict
- `_find_no_duplicates()` (L386): Strict lookup that raises `CookieConflictError` on duplicates

#### Serialization Support (L415-437)
- `__getstate__`, `__setstate__` (L415-426): Pickle support by handling non-serializable threading lock
- `copy()` (L428): Deep copy with policy preservation

### CookieConflictError (L170-173)
Exception raised when multiple cookies match the same name/domain/path criteria.

## Key Functions

### Cookie Extraction & Application
- `extract_cookies_to_jar(jar, request, response)` (L124): Extracts cookies from urllib3 response into jar using Mock adapters
- `get_cookie_header(jar, request)` (L140): Generates Cookie header string for outgoing request

### Cookie Manipulation
- `remove_cookie_by_name(cookiejar, name, domain, path)` (L151): O(n) removal with optional filtering
- `create_cookie(name, value, **kwargs)` (L455): Factory for `http.cookiejar.Cookie` objects with sensible defaults
- `morsel_to_cookie(morsel)` (L492): Converts `http.cookies.Morsel` to Cookie, handles expires/max-age conversion

### Jar Operations
- `cookiejar_from_dict(cookie_dict, cookiejar, overwrite)` (L521): Creates/populates jar from dict
- `merge_cookies(cookiejar, cookies)` (L542): Merges dict or CookieJar into existing jar
- `_copy_cookie_jar(jar)` (L440): Smart copy that handles both RequestsCookieJar and generic CookieJar

## Dependencies
- `http.cookiejar` (via `compat.cookielib`): Core cookie functionality
- `requests.compat`: Compatibility imports for Morsel, MutableMapping
- `_internal_utils.to_native_string`: String encoding utilities
- `threading`/`dummy_threading`: Lock management for thread safety

## Architecture Notes
- Uses adapter pattern extensively (MockRequest, MockResponse) to bridge interface gaps
- RequestsCookieJar provides both CookieJar and dict interfaces for different client expectations  
- All dict operations are O(n) due to linear cookie iteration - warned in docstrings
- Thread-safe via inherited CookieJar locking, with special pickle handling
- Graceful fallbacks for missing optional dependencies (threading â†’ dummy_threading)