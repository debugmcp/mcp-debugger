# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/utils/logging.py
@source-hash: c520df20745fcbde
@generated: 2026-02-09T17:59:39Z

## Purpose
Comprehensive logging configuration for pip's internal operations, providing enhanced console output with Rich formatting, indentation support, broken pipe handling, and multi-handler logging setup.

## Core Components

### Threading-Safe Indentation System
- `_log_state` (L31): Thread-local storage for indentation state
- `indent_log()` (L55-66): Context manager for hierarchical log indentation
- `get_indentation()` (L69-70): Retrieves current thread's indentation level

### Custom Formatters
- `IndentingFormatter` (L73-122): Extends logging.Formatter with indentation and timestamp support
  - Adds "WARNING: " and "ERROR: " prefixes based on log level
  - Handles deprecation message formatting specially
  - Optional timestamp formatting with default ISO format

### Rich Console Integration
- `IndentedRenderable` (L124-138): Dataclass wrapping Rich renderables with indentation
- `RichPipStreamHandler` (L140-198): Custom Rich handler for pip-specific formatting
  - Supports both regular log messages and Rich renderables
  - Color coding: red for errors, yellow for warnings
  - Broken pipe detection and special error handling

### Specialized Handlers & Filters
- `BetterRotatingFileHandler` (L200-204): Auto-creates log directories before file operations
- `MaxLevelFilter` (L206-212): Excludes records above specified level
- `ExcludeLoggerFilter` (L214-223): Excludes records from specific loggers (inverts base Filter behavior)

### Exception Handling
- `BrokenStdoutLoggingError` (L35-38): Custom exception for stdout pipe breaks
- `_is_broken_pipe_error()` (L41-52): Cross-platform broken pipe detection (handles Windows EINVAL quirks)

### Main Configuration Function
- `setup_logging()` (L225-347): Primary logging configuration orchestrator
  - Maps verbosity levels (-3 to 2+) to logging levels
  - Creates complex handler topology with filtering
  - Configures separate handlers for console output, errors, subprocess logs, and optional user log files
  - Uses dictConfig for comprehensive logging setup

## Dependencies
- Rich library for enhanced console output and formatting
- pip._internal utilities for compatibility, deprecation handling, and directory management
- Standard logging with custom extensions

## Architecture Patterns
- Thread-local state management for indentation
- Strategy pattern for different log formatters and handlers
- Composite pattern for Rich renderable wrapping
- Factory pattern in setup_logging for handler creation

## Key Constants
- `subprocess_logger` (L32): Dedicated logger for subprocess operations
- Default timestamp format: `%Y-%m-%dT%H:%M:%S` (L74)