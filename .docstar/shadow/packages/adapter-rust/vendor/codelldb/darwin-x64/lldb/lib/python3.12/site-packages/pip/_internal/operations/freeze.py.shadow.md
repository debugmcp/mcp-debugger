# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/operations/freeze.py
@source-hash: 579f72132092cff6
@generated: 2026-02-09T17:59:33Z

## Primary Purpose
Implements pip's "freeze" functionality for generating requirements files from installed packages. Provides the core logic to enumerate installed distributions and format them as pip-installable requirement specifications.

## Key Components

### Main Functions
- **`freeze()` (L26-145)**: Primary entry point that generates requirement strings from installed packages. Accepts filters for local-only, user-only, and path-specific installations. Handles requirement files processing and deduplication.
- **`_format_as_name_version()` (L147-155)**: Formats distribution as "name==version" string, handling legacy versions with "===" operator.
- **`_get_editable_info()` (L157-221)**: Extracts VCS information for editable installs, handling various failure modes (no VCS, remote errors, command failures).

### Core Classes
- **`_EditableInfo` (L21-24)**: NamedTuple containing requirement string and comment list for editable packages.
- **`FrozenRequirement` (L223-258)**: Represents a frozen package requirement with name, requirement string, editable flag, and comments. Factory method `from_dist()` (L237-252) creates instances from BaseDistribution objects.

### Key Processing Logic

#### Requirement File Processing (L48-140)
- Parses requirement files line by line
- Handles pip options (--index-url, --find-links, etc.) and emits them once
- Processes editable (-e/--editable) and regular requirements
- Tracks requirement occurrences across files for duplicate warnings
- Removes processed requirements from installations dict to avoid duplication

#### Editable Package Handling (L157-221)
- Detects VCS backend for editable locations
- Generates appropriate requirement strings based on VCS availability
- Handles error cases: RemoteNotFoundError, RemoteNotValidError, BadCommand, InstallationError
- Falls back to file path when VCS operations fail

#### Output Generation (L141-144)
- Sorts remaining installations alphabetically
- Applies skip filter to exclude specified packages
- Formats as requirement strings with comments

## Dependencies
- `pip._vendor.packaging`: Name canonicalization and version handling
- `pip._internal.metadata`: Distribution enumeration via `get_environment()`
- `pip._internal.req.constructors`: Requirement object creation
- `pip._internal.vcs`: Version control system detection and operations
- `pip._internal.utils.direct_url_helpers`: PEP 610 direct URL handling

## Critical Invariants
- Canonical names used consistently for package identification and deduplication
- Editable packages preserve VCS information when available
- Requirement file options emitted only once regardless of repetition
- Installation order preserved through sorted output

## Architectural Patterns
- Generator-based streaming output for memory efficiency
- Factory pattern for FrozenRequirement creation
- Error handling with graceful degradation for VCS operations
- Separation of concerns: requirement parsing, formatting, and VCS handling