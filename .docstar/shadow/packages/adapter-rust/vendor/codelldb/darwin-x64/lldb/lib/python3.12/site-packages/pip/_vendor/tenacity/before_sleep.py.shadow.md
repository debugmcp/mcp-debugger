# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/tenacity/before_sleep.py
@source-hash: 626a6037d63b1c69
@generated: 2026-02-09T18:00:09Z

## Purpose
Provides "before sleep" callback strategies for the Tenacity retry library, allowing customizable actions to be executed between retry attempts.

## Core Components

### `before_sleep_nothing()` (L27-28)
A no-op callback function that serves as the default/null strategy. Takes a `RetryCallState` parameter but performs no action.

### `before_sleep_log()` (L31-71)
Factory function that creates a logging callback strategy. Returns a closure that logs retry attempt details.

**Parameters:**
- `logger`: Python logging.Logger instance
- `log_level`: Integer log level (e.g., logging.INFO)
- `exc_info`: Boolean to control exception info inclusion in logs

**Returns:** Callable that takes `RetryCallState` and returns None

### Inner `log_it()` function (L38-71)
The actual logging implementation created by the factory:
- **State validation** (L41-45): Ensures `outcome` and `next_action` are set before logging
- **Outcome analysis** (L47-57): Determines if retry was due to exception or return value
- **Function name resolution** (L59-63): Uses `_utils.get_callback_name()` for readable function identification
- **Log message formatting** (L65-69): Creates descriptive retry messages with timing and reason

## Dependencies
- `typing`: Type hints and TYPE_CHECKING conditional imports
- `pip._vendor.tenacity._utils`: Utility functions for callback name resolution
- `logging` and `RetryCallState`: Type-only imports for annotations

## Key Patterns
- **Factory pattern**: `before_sleep_log()` returns configured callback functions
- **Closure usage**: Inner function captures logger configuration from outer scope
- **Defensive programming**: Runtime checks ensure retry state is properly initialized
- **Conditional type imports**: Uses TYPE_CHECKING to avoid runtime import overhead

## Integration Points
This module provides callback functions that integrate with Tenacity's retry mechanism, specifically executed during the sleep phase between retry attempts. The callbacks receive rich state information about the retry context including the function being retried, the outcome, and the next planned action.