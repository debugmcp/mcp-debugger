# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/html.py
@source-hash: 89ab919942bb2a70
@generated: 2026-02-09T17:57:41Z

**Primary Purpose**: HTML formatter for Pygments syntax highlighting library that converts tokenized source code into styled HTML output.

**Core Architecture**: Uses a layered generator pattern where formatting occurs through nested generators that wrap and transform token streams. The main flow: tokens → HTML spans → optional line numbers → optional wrapping divs → final output.

**Key Classes**:
- `HtmlFormatter` (L113-990): Main formatter class extending `Formatter` base class
  - Extensive configuration via constructor options (L411-458) 
  - CSS class/inline style generation from token types
  - Multiple wrapping modes (nowrap, table line numbers, inline line numbers)

**Core Methods**:
- `__init__` (L411-458): Initialize formatter with extensive option processing for layout, styling, line numbers, CSS handling
- `_create_stylesheet` (L484-506): Build CSS class mappings from style definitions
- `get_style_defs` (L508-520): Generate CSS rules for syntax highlighting
- `format_unencoded` (L953-990): Main formatting orchestrator applying generator chain
- `_format_lines` (L831-907): Core token-to-HTML conversion with span generation
- `wrap` (L938-951): Customizable wrapping point for subclasses

**Key Utility Functions**:
- `escape_html` (L38-40): HTML entity escaping using translation table
- `webify` (L43-47): CSS color value formatting  
- `_get_ttype_class` (L50-59): Convert token types to CSS class names

**Wrapping Generators** (Applied conditionally based on options):
- `_wrap_inlinelinenos` (L725-766): Add line numbers inline with code
- `_wrap_tablelinenos` (L657-722): Create table layout with separate line number column
- `_wrap_lineanchors` (L768-778): Add anchor tags for line linking
- `_wrap_linespans` (L780-788): Add span IDs for JavaScript access
- `_wrap_div` (L790-802): Outer div container with CSS classes/styles
- `_wrap_pre` (L804-819): Pre tag wrapper with optional filename header
- `_wrap_code` (L821-824): Code tag wrapper (HTML5 compliance)
- `_wrap_full` (L616-655): Complete HTML document generation

**Configuration Options**: 30+ options controlling output format including:
- Layout: `nowrap`, `full`, `linenos` (table/inline/false)
- Styling: `noclasses`, `cssclass`, `cssstyles`, `prestyles`
- Line features: `hl_lines`, `lineanchors`, `linespans`, `linenostart`
- Integration: `tagsfile` (ctags), `cssfile`, `filename`

**Dependencies**:
- `pip._vendor.pygments.formatter.Formatter`: Base formatter class
- `pip._vendor.pygments.token`: Token type system and constants
- Optional `ctags`: For hyperlink generation to symbol definitions

**Templates**:
- `CSSFILE_TEMPLATE` (L62-69): CSS file wrapper
- `DOC_HEADER` (L71-90): Full HTML document header with embedded CSS
- `DOC_HEADER_EXTERNALCSS` (L92-105): HTML header with external CSS link
- `DOC_FOOTER` (L107-110): HTML document footer

**Performance Features**:
- `@functools.lru_cache` on `_translate_parts` (L826) for HTML escaping
- `span_element_openers` cache (L426) for CSS span generation
- Generator pattern minimizes memory usage for large files