# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/cmdline.py
@source-hash: bdb972686abbf4e2
@generated: 2026-02-09T17:59:55Z

This file implements the command-line interface for Pygments, a Python syntax highlighting library. It serves as the entry point for the `pygmentize` command-line tool, handling argument parsing, lexer/formatter selection, and text highlighting operations.

## Core Architecture

**Main Entry Point**: `main()` (L528-668) - Sets up argument parser and delegates to `main_inner()`
**Core Logic**: `main_inner()` (L182-515) - Processes all command-line options and performs highlighting operations
**Custom Help Formatter**: `HelpFormatter` (L517-525) - Extends argparse formatter to respect terminal width

## Key Utility Functions

**Option Parsing**: 
- `_parse_options()` (L33-51) - Converts comma-separated key=value pairs into dictionary
- `_parse_filters()` (L54-64) - Parses filter specifications with optional parameters

**Information Display**:
- `_print_help()` (L67-84) - Shows detailed help for specific lexers/formatters/filters
- `_print_list()` (L87-136) - Lists available lexers, formatters, filters, or styles in human-readable format  
- `_print_list_as_json()` (L138-181) - Outputs component information as JSON

## Command Processing Flow

The tool supports several operation modes handled in `main_inner()`:

1. **Help/Version** (L183-190): `-h`, `--help`, `-V` flags
2. **Listing Components** (L196-224): `-L` flag with optional component types
3. **Component Help** (L227-235): `-H` flag for detailed documentation
4. **Lexer Identification** (L254-271): `-N` (by filename) and `-C` (by content) flags
5. **Style Sheet Generation** (L274-293): `-S` flag with formatter
6. **Main Highlighting** (L306-515): Core syntax highlighting functionality

## Lexer Selection Logic (L306-388)

Priority order:
1. Explicit lexer via `-l` flag (supports custom .py files with `-x`)
2. Filename-based detection for input files
3. Content-based guessing (with `-g` flag or fallback)
4. Default to TextLexer

## Formatter Selection Logic (L403-454)

Priority order:  
1. Explicit formatter via `-f` flag (supports custom .py files with `-x`)
2. Output filename-based detection
3. Auto-detect terminal capabilities (truecolor > 256-color > basic)

## Input/Output Handling

**Input Sources**:
- File specified as positional argument (L343-374)
- Standard input in full-file mode (L376-387) 
- Standard input in streaming mode with `-s` flag (L498-514)

**Output Destinations**:
- File specified with `-o` flag (L434-445)
- Standard output with terminal formatting (L446-454)

## Special Features

**Windows Colorama Integration** (L466-477): Automatic color support detection and stream wrapping
**LaTeX Escape Processing** (L479-486): Special lexer wrapping for LaTeX formatter with `escapeinside` option
**Streaming Mode** (L498-514): Line-by-line processing for real-time highlighting (e.g., `tail -f`)

## Error Handling

Comprehensive exception handling with:
- Graceful BrokenPipeError handling (L641-643)
- Detailed tracebacks with `-v` flag (L644-656)  
- Simplified error messages for user-facing issues (L657-668)
- Consistent error reporting to stderr throughout

## Dependencies

Heavy reliance on Pygments ecosystem:
- Core highlighting via `pygments.highlight`
- Dynamic component discovery via `get_all_*` functions
- Lexer/formatter loading with fallback mechanisms
- Terminal encoding detection and stream wrapping utilities