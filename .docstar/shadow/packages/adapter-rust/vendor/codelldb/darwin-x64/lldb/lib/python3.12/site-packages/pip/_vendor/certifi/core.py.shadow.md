# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/certifi/core.py
@source-hash: d92453e6b21c4028
@generated: 2026-02-09T17:59:41Z

## Purpose
Certificate bundle access module for pip's vendored certifi package. Provides standardized interface to locate and read CA certificate bundle (`cacert.pem`) across different Python versions and packaging environments.

## Key Functions

### `exit_cacert_ctx()` (L10-11)
Cleanup handler for certificate context manager. Registered with `atexit` to ensure proper resource cleanup on program termination.

### Version-Specific Implementations

**Python 3.11+ Implementation (L14-47)**
- `where()` (L21-44): Returns filesystem path to cacert.pem using modern `importlib.resources.as_file()` and `files()` APIs
- `contents()` (L46-47): Returns certificate bundle contents as string using `files().read_text()`
- Uses lazy initialization with global caching (`_CACERT_CTX`, `_CACERT_PATH`)

**Python 3.7-3.10 Implementation (L49-83)**  
- `where()` (L56-80): Similar to 3.11+ but uses older `importlib.resources.path()` API
- `contents()` (L82-83): Uses `read_text()` function from importlib.resources
- Same global caching pattern

**Python <3.7 Fallback (L85-114)**
- `read_text()` (L97-104): Custom implementation that delegates to `where()` for file access
- `where()` (L108-111): Simple filesystem-based approach using `__file__` directory + "cacert.pem"  
- `contents()` (L113-114): Wrapper around custom `read_text()`

## Architecture Patterns

**Version Compatibility Strategy**: Three-tier conditional imports based on `sys.version_info` checks to handle API evolution in importlib.resources

**Resource Management**: Context manager pattern for Python 3.7+ to handle temporary file extraction in zip/package scenarios, with atexit cleanup registration

**Global Caching**: Lazy initialization pattern prevents repeated file extraction while maintaining singleton access to certificate path

**Fallback Chain**: Graceful degradation from modern APIs to filesystem-based access for older Python versions

## Dependencies
- `sys`: Version detection
- `atexit`: Cleanup registration  
- `importlib.resources`: Modern resource access (3.7+)
- `os`: Filesystem operations (fallback)
- `types`, `typing`: Type hints (fallback)

## Critical Constraints
- Certificate bundle must be accessible as "cacert.pem" in pip._vendor.certifi package
- Global state management requires proper cleanup to avoid resource leaks
- Fallback implementation assumes `__file__` is available (fails in some packaged environments like PyOxidizer)