# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_win32_console.py
@source-hash: 3f4bf12367dc9ddc
@generated: 2026-02-09T18:00:03Z

## Purpose
Windows Console API wrapper for rich terminal formatting on legacy Windows systems. Provides ctypes-based bindings to Win32 console functions and a high-level terminal interface for systems without virtual terminal processing support.

## Platform Constraints
- **Windows-only module** (L10-13): Raises ImportError if imported on non-Windows platforms
- Uses ctypes.WinDLL loader via windll global (L9-11)

## Core Structures
- **WindowsCoordinates** (L32-53): NamedTuple wrapping (row, col) coordinates with automatic COORD conversion via from_param classmethod
- **CONSOLE_SCREEN_BUFFER_INFO** (L56-63): ctypes Structure for screen buffer metadata
- **CONSOLE_CURSOR_INFO** (L66-67): ctypes Structure for cursor properties

## Low-Level API Functions (L70-327)
Direct ctypes wrappers for Win32 console functions:
- **GetStdHandle** (L77-86): Retrieve standard device handles (default: stdout)
- **GetConsoleMode** (L94-113): Get console input/output mode with error handling
- **FillConsoleOutputCharacter** (L127-154): Write character patterns to screen buffer
- **FillConsoleOutputAttribute** (L168-192): Set character attributes in regions
- **SetConsoleTextAttribute** (L203-216): Change text color attributes
- **GetConsoleScreenBufferInfo** (L227-240): Query screen buffer properties
- **SetConsoleCursorPosition** (L251-263): Move cursor to coordinates
- **GetConsoleCursorInfo/SetConsoleCursorInfo** (L274-310): Cursor visibility/size control
- **SetConsoleTitle** (L318-327): Change console window title

## High-Level Terminal Interface
**LegacyWindowsTerm** (L330-574): Main terminal abstraction class
- **Color mapping** (L342-359): ANSI_TO_WINDOWS array converts ANSI color codes to Windows console values
- **Initialization** (L361-373): Captures default console attributes and wraps file I/O
- **Properties**: cursor_position (L376-383), screen_size (L386-395)
- **Text output**: write_text (L397-404), write_styled (L406-443) with color/style conversion
- **Cursor control**: move_cursor_* methods (L445-546) for positioning and navigation
- **Line editing**: erase_line/erase_end_of_line/erase_start_of_line (L455-492)
- **Cursor visibility**: hide_cursor/show_cursor (L548-558)
- **Window management**: set_title (L560-567)

## Dependencies
- Rich library: ColorSystem, Style classes for color handling
- Standard library: ctypes, sys, time, typing

## Key Constants
- STDOUT = -11 (L22): Standard output handle identifier
- ENABLE_VIRTUAL_TERMINAL_PROCESSING = 4 (L23): Console mode flag
- BRIGHT_BIT = 8 (L339): Intensity bit for bright colors

## Demo Code (L576-662)
Comprehensive example demonstrating color output, cursor movement, and line erasing capabilities with visual feedback and timing delays.