# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/socks.py
@source-hash: 6918bd7965e8f591
@generated: 2026-02-09T17:57:40Z

**Primary Purpose:**
SOCKS proxy support module for urllib3, providing SOCKS4/4A/5 proxy connectivity with full urllib3 feature compatibility. Requires PySocks dependency and handles proxy authentication, DNS resolution modes, and connection pooling.

**Key Classes and Functions:**

- `SOCKSConnection` (L75-141): HTTP connection class that routes through SOCKS proxy
  - `__init__` (L80-82): Extracts `_socks_options` from kwargs and delegates to parent
  - `_new_conn` (L84-140): Core connection establishment via `socks.create_connection()`, handles timeouts and proxy errors

- `SOCKSHTTPSConnection` (L147-148): HTTPS variant inheriting from both SOCKSConnection and HTTPSConnection

- `SOCKSHTTPConnectionPool` (L151-152): HTTP connection pool using SOCKSConnection
- `SOCKSHTTPSConnectionPool` (L155-156): HTTPS connection pool using SOCKSHTTPSConnection

- `SOCKSProxyManager` (L159-216): Main proxy manager class extending PoolManager
  - `pool_classes_by_scheme` (L165-168): Maps HTTP/HTTPS schemes to SOCKS pool classes
  - `__init__` (L170-214): Parses proxy URL, determines SOCKS version and DNS resolution mode, configures connection options

**Dependencies:**
- `socks` module (PySocks library) - required, warns and raises on import failure (L43-58)
- urllib3 core modules: connection, connectionpool, exceptions, poolmanager, util.url
- Standard library: socket, ssl (optional), warnings

**Key Patterns:**
- Proxy URL scheme parsing determines SOCKS version: `socks4`→SOCKS4, `socks4a`→SOCKS4+RDNS, `socks5`→SOCKS5, `socks5h`→SOCKS5+RDNS (L185-198)
- Authentication extraction from proxy URL auth component (L181-184)
- Exception translation from PySocks to urllib3 exceptions (ConnectTimeoutError, NewConnectionError) (L108-138)
- Connection options passed via `_socks_options` parameter containing proxy configuration (L202-210)

**Critical Constraints:**
- PySocks dependency is mandatory - module fails fast with DependencyWarning if missing
- SOCKS version determination is strict - ValueError for unsupported schemes
- DNS resolution mode (rdns) controlled by URL scheme suffix ('h' indicates remote DNS)
- Fragile error handling noted for PySocks ProxyError socket_err attribute (L116-117)