# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/_elffile.py
@source-hash: fcb7095b860d2b2c
@generated: 2026-02-09T17:59:42Z

## Primary Purpose
ELF file parser providing read-only access to ELF executable format files. Mimics ZipFile interface for binary analysis of Linux executables, libraries, and object files.

## Core Classes & Functions

**ELFInvalid (L19-20)**: Exception class for ELF parsing errors, extends ValueError.

**Enums (L23-39)**:
- `EIClass`: Defines 32-bit (C32=1) and 64-bit (C64=2) architecture formats
- `EIData`: Defines endianness - Little (Lsb=1) and Big (Msb=2) endian
- `EMachine`: Architecture types including I386(3), ARM(40), x86_64(62), AArch64(183), S390(22)

**ELFFile (L41-110)**: Main parser class
- `__init__(L46-91)`: Parses ELF header, validates magic bytes (0x7fELF), extracts bitness/endianness, configures struct formats for different architectures
- `_read(L92-93)`: Internal helper for struct unpacking from file stream
- `interpreter property (L95-110)`: Extracts PT_INTERP section path (dynamic linker/loader path)

## Key Dependencies
- `struct`: Binary data parsing
- `enum`: Type-safe constants
- `os.fsdecode`: Path string conversion
- `typing.IO`: File handle type annotations

## Architecture Patterns
- Format string lookup table (L64-69) maps (bitness, endianness) to struct formats
- Supports 4 combinations: 32/64-bit Ã— LSB/MSB endian
- Index tuples (p_idx) provide field positions for different formats
- Stream-based parsing with seek operations for section traversal

## Critical Invariants
- ELF magic bytes must be exactly `b"\x7fELF"` (L54)
- Capacity/encoding must map to supported format combinations (L70-74)
- PT_INTERP section type identifier is 3 (L106)
- File stream must remain valid throughout object lifetime

## Implementation Notes
Based on Linux Foundation ELF specification and community gist. Read-only implementation focuses on header parsing and interpreter path extraction for platform compatibility detection.