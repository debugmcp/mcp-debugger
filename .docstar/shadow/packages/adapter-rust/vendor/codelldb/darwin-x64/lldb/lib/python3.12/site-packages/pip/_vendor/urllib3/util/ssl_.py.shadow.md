# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/ssl_.py
@source-hash: 5f8f80a96f756983
@generated: 2026-02-09T17:57:46Z

## SSL/TLS Utility Module for urllib3

Provides SSL/TLS configuration and socket wrapping utilities for urllib3, with cross-platform compatibility and fallbacks for older Python versions. Handles certificate validation, cipher selection, and secure connection establishment.

### Key Components

**Global SSL Configuration (L19-27)**
- Module-level SSL feature detection flags: `HAS_SNI`, `IS_PYOPENSSL`, `IS_SECURETRANSPORT`
- `HASHFUNC_MAP`: Maps digest lengths to hash functions (32→md5, 40→sha1, 64→sha256)
- `ALPN_PROTOCOLS`: Default HTTP/1.1 protocol list for ALPN negotiation

**Security Utilities**
- `_const_compare_digest_backport()` (L30-40): Timing-safe digest comparison for older Python versions
- `assert_fingerprint()` (L182-208): Validates certificate fingerprints using configurable hash algorithms

**SSL Context Management**
- `SSLContext` fallback class (L133-179): Compatibility shim for Python 2, provides basic SSL context functionality
- `create_urllib3_context()` (L250-352): Creates secure SSL contexts with hardened defaults
  - Disables SSLv2/SSLv3/compression by default
  - Uses `DEFAULT_CIPHERS` cipher suite (L110-127) prioritizing forward secrecy
  - Configures post-handshake auth for TLS 1.3
  - Supports SSL key logging via `SSLKEYLOGFILE` environment variable

**Protocol Version Management (L62-90)**
- Progressive fallbacks for SSL protocol constants
- Handles `PROTOCOL_TLS_CLIENT` preference over deprecated `PROTOCOL_TLS`
- Defines SSL option flags with fallback values

**Socket Wrapping**
- `ssl_wrap_socket()` (L355-454): Main interface for creating SSL sockets
  - Supports client certificates, CA validation, SNI
  - Handles TLS-in-TLS via `SSLTransport`
  - Automatically detects encrypted private keys
- `_ssl_wrap_socket_impl()` (L481-495): Low-level socket wrapping implementation

**Utility Functions**
- `resolve_cert_reqs()` (L211-231): Converts string cert requirement names to SSL constants
- `resolve_ssl_version()` (L234-247): Converts string protocol names to SSL constants
- `is_ipaddress()` (L457-467): Detects IPv4/IPv6 addresses for SNI handling
- `_is_key_file_encrypted()` (L470-478): Checks if private key files are encrypted

### Dependencies
- Core: `ssl`, `hmac`, `hashlib`, `warnings`
- Internal: `..exceptions`, `..packages.six`, `.url`, `.ssltransport`
- Optional imports with graceful fallbacks for missing SSL features

### Security Features
- Secure cipher suite defaults emphasizing perfect forward secrecy
- Automatic disabling of weak protocols (SSLv2/SSLv3)
- Certificate fingerprint validation with timing-safe comparison
- SNI support with IP address detection
- Encrypted private key detection and password handling