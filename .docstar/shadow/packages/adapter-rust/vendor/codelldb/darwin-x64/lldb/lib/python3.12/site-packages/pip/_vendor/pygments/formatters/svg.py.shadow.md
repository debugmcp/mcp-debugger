# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/svg.py
@source-hash: 75038d5b2a5bcdfb
@generated: 2026-02-09T17:57:38Z

## SVG Formatter for Pygments

Primary purpose: Converts syntax-highlighted code tokens to SVG graphics format. Part of Pygments' formatter ecosystem, specifically handling SVG output with customizable visual options.

### Key Components

**SvgFormatter Class (L29-188)**
- Main formatter inheriting from `Formatter`
- Converts token streams to SVG `<text>` elements with styled `<tspan>` children
- Supports both wrapped (full SVG document) and unwrapped (bare elements) output modes

**Core Methods:**
- `__init__(self, **options)` (L93-112): Configures formatter with extensive options for font, positioning, line numbers, and spacing
- `format_unencoded(self, tokensource, outfile)` (L114-171): Main formatting logic that processes token stream and writes SVG output
- `_get_style(self, tokentype)` (L173-188): Converts Pygments token styles to SVG attributes, with caching

**Utility Functions:**
- `escape_html(text)` (L18-24): HTML entity escaping for SVG content safety

### Configuration Options

Extensive customization through constructor options:
- Layout: `nowrap`, `xoffset`, `yoffset`, `ystep` 
- Typography: `fontfamily`, `fontsize`, `spacehack`
- Line numbers: `linenos`, `linenostart`, `linenostep`, `linenowidth`

### Key Dependencies
- `pip._vendor.pygments.formatter.Formatter`: Base class
- `pip._vendor.pygments.token.Comment`: Token type for line number styling
- `pip._vendor.pygments.util`: Option parsing utilities

### Architecture Notes
- Uses style caching (`_stylecache`) to avoid repeated style lookups
- Handles newlines by closing/opening `<text>` elements for proper line positioning
- Implements space preservation workaround (`spacehack`) for SVG viewer compatibility
- Line numbering integrated into main formatting loop with configurable stepping

### Critical Behaviors
- Font size parsing attempts integer extraction from pixel values, falls back to 20px
- Token style inheritance walks up token type hierarchy until styled parent found
- SVG coordinate system requires Y-offset adjustment since text coordinates reference baseline