# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/commands/inspect.py
@source-hash: 3c6ad8f534534423
@generated: 2026-02-09T17:59:24Z

## Primary Purpose
Implements pip's `inspect` command to analyze Python environments and generate structured JSON reports about installed packages.

## Core Components

### InspectCommand Class (L19-92)
Main command implementation inheriting from `Command`. Provides JSON-formatted environment inspection with configurable filtering options.

**Key Methods:**
- `add_options()` (L28-46): Configures CLI options including `--local`, `--user`, and path filtering
- `run()` (L48-63): Main execution logic that gathers package data and outputs JSON report
- `_dist_to_dict()` (L65-92): Converts distribution objects to dictionary representation for JSON serialization

## Dependencies & Integration
- **pip._internal.metadata**: Uses `get_environment()` and `BaseDistribution` for package discovery (L12)
- **pip._vendor.packaging.markers**: Leverages `default_environment()` for environment markers (L5)
- **pip._vendor.rich**: Uses `print_json()` for formatted output (L6)
- **pip._internal.utils.compat**: Imports `stdlib_pkgs` to filter standard library packages (L13)

## Key Features & Behavior

### Environment Scanning (L50-54)
Iterates through installed distributions with filtering options:
- `local_only`: Excludes globally-installed packages in virtualenvs
- `user_only`: Restricts to user-site packages
- Automatically skips standard library packages

### JSON Output Structure (L55-61)
Generates structured report containing:
- Schema version ("1")
- pip version
- Array of installed packages
- Environment markers
- TODO comment suggests future addition of tags/scheme (L60)

### Package Metadata Extraction (L65-92)
Each package entry includes:
- **Core metadata**: Package metadata dict and location (L67-68)
- **Direct URL handling**: PEP 610 direct_url or emulated direct_url for legacy editable installs (L72-84)
- **Installation metadata**: Installer tool and requested status (L86-91)

## Architectural Patterns
- Command pattern implementation with option configuration and execution phases
- JSON serialization with rich formatting for human-readable output
- Conditional metadata inclusion based on package installation method
- Legacy compatibility handling for editable installs without PEP 610 metadata

## Configuration
- `ignore_require_venv = True`: Command can run outside virtual environments (L24)
- Supports path-based environment inspection via `--path` option integration