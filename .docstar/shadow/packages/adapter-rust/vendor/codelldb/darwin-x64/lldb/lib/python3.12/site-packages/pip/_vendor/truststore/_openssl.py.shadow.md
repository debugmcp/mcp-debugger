# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/truststore/_openssl.py
@source-hash: 2cb519ed919a8a8f
@generated: 2026-02-09T18:00:07Z

## Purpose
OpenSSL-specific certificate verification module for the truststore package. Provides platform-agnostic SSL context configuration by automatically discovering system certificate authorities across different Linux distributions and Unix-like systems.

## Key Components

### Constants
- `_CA_FILE_CANDIDATES` (L8-17): Prioritized list of common CA certificate file locations across major Linux distributions (Alpine, Arch, Fedora, RHEL, Debian, Ubuntu, SUSE, BSD)
- `_HASHED_CERT_FILENAME_RE` (L19): Regex pattern matching OpenSSL's hashed certificate filename format (8 hex digits + dot + digit)

### Functions
- `_configure_context()` (L22-46): Context manager that configures SSL context with system CA certificates. First attempts OpenSSL's default paths via `ssl.get_default_verify_paths()`, falls back to iterating through `_CA_FILE_CANDIDATES` if defaults unavailable
- `_capath_contains_certs()` (L49-56): Validates whether a certificate directory contains properly formatted certificate files by checking for OpenSSL hashed filename pattern
- `_verify_peercerts_impl()` (L59-66): No-op implementation that delegates verification to SSL context's built-in `CERT_REQUIRED` mode

## Dependencies
- Standard library modules: `contextlib`, `os`, `re`, `ssl`, `typing`
- Relies on system-installed CA certificate bundles

## Architecture Notes
- Follows defense-in-depth approach: tries OpenSSL defaults first, then common system locations
- Cross-platform compatibility through hardcoded path candidates
- Minimal verification implementation leverages SSL context's native capabilities
- Context manager pattern ensures proper resource cleanup

## Usage Pattern
Designed as backend implementation for truststore's certificate verification, abstracting platform-specific certificate location discovery from higher-level SSL operations.