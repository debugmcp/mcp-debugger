# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/metadata/importlib/_compat.py
@source-hash: 1807bfa6b21f084e
@generated: 2026-02-09T17:57:24Z

**Primary Purpose**: Compatibility layer for importlib.metadata operations in pip's internal metadata handling, providing type-safe wrappers and protocols for distribution metadata access.

**Key Components**:

- `BadMetadata` (L5-12): Custom exception for distribution metadata parsing errors. Stores the problematic distribution object and error reason, with formatted string representation showing distribution and reason.

- `BasePath` (L14-32): Protocol defining common interface for path-like objects. Unifies `pathlib.Path` and `zipfile.Path` APIs with minimal required properties (`name` and `parent`). Created to work around linter limitations with Union types for newer zipfile.Path.

- `get_info_location()` (L34-43): Retrieves distribution metadata directory path by accessing private `_path` attribute. Acknowledges this is a hack due to importlib.metadata not exposing paths publicly (since not all distributions exist on disk). Returns None for distributions without filesystem presence.

- `get_dist_name()` (L46-55): Type-safe extraction of distribution project name. Uses cast to work around Mypy limitations with the `name` attribute (available in Python 3.10+). Validates return type and raises `BadMetadata` for invalid names.

**Dependencies**: 
- `importlib.metadata` for distribution objects
- `typing` for Protocol and type annotations

**Architectural Patterns**:
- Protocol-based duck typing for path compatibility
- Defensive programming with custom exceptions
- Explicit acknowledgment of implementation hacks
- Type casting to handle evolving stdlib APIs

**Critical Constraints**:
- Relies on private importlib.metadata attributes (fragile)
- Assumes Python 3.10+ for distribution.name attribute
- BasePath protocol intentionally minimal, not exhaustive