# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_ratio.py
@source-hash: 66de7c6a9b3323a8
@generated: 2026-02-09T17:59:58Z

## Purpose
Space allocation and ratio-based distribution utilities for Rich terminal layouts. Provides algorithms to divide available space among layout edges while respecting size constraints and ratios.

## Key Components

### Edge Protocol (L12-18)
Protocol defining layout edge interface with three attributes:
- `size`: Optional fixed size constraint
- `ratio`: Proportional weight for flexible sizing (default 1)  
- `minimum_size`: Minimum space requirement (default 1)

### Core Functions

#### ratio_resolve(total, edges) → List[int] (L20-78)
**Primary space allocation algorithm.** Distributes total space among edges while satisfying all constraints:
- Honors fixed `size` values first
- Allocates remaining space proportionally by `ratio`
- Enforces `minimum_size` constraints
- Uses iterative approach: fixes edges that violate minimums, recalculates remaining space
- Returns sizes that may exceed `total` if constraints impossible to satisfy
- Uses `Fraction` for precise arithmetic to avoid rounding errors during intermediate calculations

#### ratio_reduce(total, ratios, maximums, values) → List[int] (L81-110)
Reduces values proportionally while respecting maximum constraints:
- Zeroes ratios where maximum is 0
- Distributes reduction proportionally across non-zero ratios
- Maintains running totals to ensure exact sum
- Returns `values[i] - distributed_amount[i]` for each slot

#### ratio_distribute(total, ratios, minimums) → List[int] (L113-146)
Simple proportional distribution with minimum constraints:
- Zeroes ratios where minimum is 0
- Uses `ceil()` for distribution to ensure minimums met
- Processes sequentially, updating remaining total and ratios
- Asserts total ratio > 0 to prevent division by zero

## Architecture Patterns
- **Constraint satisfaction**: Iterative refinement in `ratio_resolve`
- **Exact arithmetic**: Uses `Fraction` to avoid floating-point errors
- **Sequential processing**: Maintains running totals for exact sums
- **Protocol-based**: Flexible edge interface supports various layout objects

## Dependencies
- `fractions.Fraction`: Precise rational arithmetic
- `typing_extensions`: Protocol backport for Python < 3.8
- `math.ceil`: Ceiling function for minimum enforcement

## Test Code (L149-159)
Simple demonstration with three equal-ratio edges, validates sum preservation.