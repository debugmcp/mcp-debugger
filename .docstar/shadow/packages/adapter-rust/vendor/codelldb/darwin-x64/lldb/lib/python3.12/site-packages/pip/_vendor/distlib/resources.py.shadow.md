# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/resources.py
@source-hash: 2f06cf92c7340352
@generated: 2026-02-09T17:59:57Z

## Primary Purpose
Resource management system for Python packages, providing unified access to files and data within packages whether they're stored in the filesystem or ZIP archives. Part of the distlib library for package distribution utilities.

## Key Classes and Functions

### ResourceCache (L27-68)
Caching mechanism for package resources with filesystem storage.
- `__init__(base=None)` (L28-32): Creates cache directory in system cache location
- `is_stale(resource, path)` (L34-43): Always returns True (cache invalidation disabled)
- `get(resource)` (L45-68): Retrieves/caches resource to filesystem, creates directories as needed

### ResourceBase (L71-74)
Abstract base class for all resource types.
- Stores finder reference and resource name

### Resource (L77-108)
Represents individual files/data within packages.
- `as_stream()` (L85-92): Returns new stream for each call
- `file_path` (L94-99): Cached property using global cache instance
- `bytes` (L101-103): Cached property for resource content
- `size` (L105-107): Cached property for resource size
- `is_container = False` (L83): Backward compatibility flag

### ResourceContainer (L110-115)
Represents directories/containers within packages.
- `resources` (L113-115): Cached property listing contained resources
- `is_container = True` (L111): Backward compatibility flag

### ResourceFinder (L118-205)
Filesystem-based resource finder for regular package installations.
- `skipped_extensions` (L123-126): Platform-specific file extensions to ignore
- `__init__(module)` (L128-131): Initializes from module object
- `_make_path(resource_name)` (L136-146): Constructs filesystem paths, handles bytes vs strings
- `find(resource_name)` (L154-164): Locates resource, returns Resource or ResourceContainer
- `get_stream(resource)` (L166-167): Opens file stream
- `get_bytes(resource)` (L169-171): Reads entire file content
- `get_resources(resource)` (L176-180): Lists directory contents, filters system files
- `iterator(resource_name)` (L187-205): Breadth-first traversal of resource hierarchy

### ZipResourceFinder (L208-283)
ZIP archive-based resource finder for packaged distributions.
- `__init__(module)` (L212-221): Initializes from ZIP loader, builds file index
- `_find(path)` (L226-242): Uses binary search on sorted index for efficient lookup
- `get_cache_info(resource)` (L244-247): Returns archive path and relative resource path
- `get_bytes(resource)` (L249-250): Delegates to ZIP loader
- `get_stream(resource)` (L252-253): Wraps bytes in BytesIO
- `get_size(resource)` (L255-257): Extracts size from ZIP directory info
- `_is_directory(path)` (L274-283): Checks if path represents directory in ZIP

## Key Dependencies
- `os`, `sys`: Filesystem and system operations
- `zipimport`: ZIP file handling
- `bisect`: Binary search for ZIP file lookups  
- `pkgutil`: Package utilities
- `io`: Stream handling
- `.util`: Cache utilities and cached_property decorator

## Architecture Patterns
- **Strategy Pattern**: Different finder implementations (filesystem vs ZIP) with common interface
- **Registry Pattern**: `_finder_registry` (L286-303) maps loader types to finder classes
- **Caching**: Global cache instance and cached properties for performance
- **Factory Pattern**: `finder(package)` and `finder_for_path(path)` functions create appropriate finder instances

## Global State
- `cache = None` (L24): Lazy-initialized global ResourceCache instance
- `_finder_registry` (L286): Maps loader types to finder classes
- `_finder_cache` (L310): Caches finder instances per package

## Key Functions
- `register_finder(loader, finder_maker)` (L306-307): Extends registry with custom finders
- `finder(package)` (L313-335): Main entry point, returns cached finder for package name
- `finder_for_path(path)` (L341-357): Creates finder for arbitrary filesystem path

## Critical Invariants
- Resources maintain reference to their finder for delegation
- ZIP finders maintain sorted index for binary search efficiency
- Cache always writes to temporary location then moves (atomic operations)
- Path handling preserves bytes vs string types for Python 2.x compatibility