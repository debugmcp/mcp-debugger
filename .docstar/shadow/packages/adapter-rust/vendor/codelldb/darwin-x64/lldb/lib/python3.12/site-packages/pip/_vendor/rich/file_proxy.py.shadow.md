# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/file_proxy.py
@source-hash: 4e5f531cc0d9f8f9
@generated: 2026-02-09T18:00:01Z

## Primary Purpose
FileProxy (L11-57) is a wrapper class that intercepts writes to a file (typically sys.stdout) and redirects them to a Rich Console for formatted output. It acts as a transparent proxy that enables ANSI escape sequence processing and Rich's text rendering system.

## Core Architecture
- Inherits from `io.TextIOBase` to provide standard file interface
- Uses composition pattern with private Console and file references
- Implements line-buffering strategy to handle partial writes correctly
- Delegates unknown attributes to wrapped file via `__getattr__` (L25-26)

## Key Components

### Initialization (L14-18)
- `__console`: Rich Console instance for formatted output
- `__file`: Original file being proxied  
- `__buffer`: List buffer for accumulating partial line content
- `__ansi_decoder`: AnsiDecoder for processing ANSI escape sequences

### Core Methods
- `write(text)` (L28-48): Main interception point that buffers text until complete lines are formed, then processes through ANSI decoder and Rich Console
- `flush()` (L50-54): Forces output of buffered content to Console
- `rich_proxied_file` (L20-23): Property accessor for original file reference
- `fileno()` (L56-57): Delegates to wrapped file's file descriptor

## Critical Behavior Patterns
1. **Line Buffering**: Accumulates text in `__buffer` until newline encountered, enabling proper line-by-line processing
2. **ANSI Processing**: Each complete line is decoded through `AnsiDecoder.decode_line()` before Console output
3. **Transparent Delegation**: Unknown attributes automatically forwarded to wrapped file
4. **Context Management**: Uses Console context manager during output operations

## Dependencies
- `rich.ansi.AnsiDecoder`: For processing ANSI escape sequences
- `rich.text.Text`: For Rich's text representation and joining
- `rich.console.Console`: Target for redirected output (TYPE_CHECKING import)

## Implementation Notes
- Write method returns original text length, not actual bytes written to Console
- Buffer clearing uses `del self.__buffer[:]` pattern for efficiency
- Type checking enforced in write() method with descriptive error messages