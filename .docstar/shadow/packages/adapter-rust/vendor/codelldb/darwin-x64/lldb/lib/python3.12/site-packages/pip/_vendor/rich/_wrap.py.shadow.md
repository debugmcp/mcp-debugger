# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_wrap.py
@source-hash: 1654aca26e445f42
@generated: 2026-02-09T17:59:59Z

## Primary Purpose
Text wrapping utility module for the Rich library that handles word-based text splitting with Unicode-aware cell width calculations. Provides intelligent line breaking algorithms that respect terminal display width constraints and support folding/cropping of oversized words.

## Key Functions

**`words(text: str)` (L12-23)**
- Generator that tokenizes text into words using regex pattern matching
- Yields tuples of (start_index, end_index, word) where word includes trailing whitespace
- Uses compiled regex `re_word` (L9) pattern `\s*\S+\s*` to match word boundaries
- Core building block for text wrapping operations

**`divide_line(text: str, width: int, fold: bool = True)` (L26-78)**
- Primary text wrapping algorithm that determines optimal line break positions
- Returns list of character indices where line breaks should be inserted
- Uses cell-based width calculations via `cell_len()` for Unicode support
- Implements three wrapping strategies:
  - Simple case: word fits in remaining line space (L49-51)
  - Folding mode: splits oversized words across multiple lines using `chop_cells()` (L57-66)
  - Cropping mode: truncates oversized words when folding disabled (L68-71)
- Handles edge case where word fits on next line but not current line (L72-76)

## Dependencies
- `._loop.loop_last`: Iterator utility for identifying last iteration
- `.cells.cell_len, chop_cells`: Unicode-aware cell width calculations and text chopping
- `re` module for word boundary detection

## Key Patterns
- Performance optimization: caches `cell_len` as local variable `_cell_len` (L42)
- Performance optimization: caches `append` method reference (L40)
- Maintains running `cell_offset` to track current line position
- Uses generator pattern in `words()` for memory efficiency

## Test/Demo Code (L81-93)
- Demonstrates usage with Rich Console for various text scenarios
- Tests Unicode text wrapping with Japanese characters
- Shows both folding and cropping behaviors