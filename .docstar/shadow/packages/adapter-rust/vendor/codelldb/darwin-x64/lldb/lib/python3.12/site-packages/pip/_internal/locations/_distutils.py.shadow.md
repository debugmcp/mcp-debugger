# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/locations/_distutils.py
@source-hash: 1fd6472bfdf9add0
@generated: 2026-02-09T17:59:29Z

**Purpose**: Provides installation directory schemes using Python's distutils module. Handles location resolution for different installation contexts (user, home, prefix, virtualenv) and platform-specific binary paths.

**Key Dependencies**:
- `distutils.command.install`: Core installation command and scheme keys (L20-22)
- `pip._internal.models.scheme.Scheme`: Pip's internal scheme representation (L26)
- `pip._internal.utils.compat.WINDOWS`: Platform detection (L27)
- `pip._internal.utils.virtualenv.running_under_virtualenv`: Virtual environment detection (L28)

**Core Functions**:

- `distutils_scheme()` (L35-112): Main scheme resolution function. Creates distutils Distribution object, configures installation parameters (user/home/prefix/root), handles config file parsing with Unicode error recovery, and applies virtualenv-specific header path logic. Returns raw dictionary of installation paths.

- `get_scheme()` (L115-147): Public API wrapper that converts distutils scheme dictionary into pip's Scheme object. Provides comprehensive parameter documentation for installation modes.

- `get_bin_prefix()` (L150-164): Platform-specific binary directory resolution. Handles Windows Scripts vs bin directories, macOS system framework special case (/usr/local/bin), and standard Unix bin paths.

- `get_purelib()`/`get_platlib()` (L167-172): Simple wrappers for distutils library paths (platform-independent vs platform-specific).

**Architectural Patterns**:
- Defensive setuptools shim removal (L12-15) to avoid environment conflicts
- Unicode-safe config file parsing with graceful degradation (L56-63)
- Mutual exclusivity assertions for installation modes (L71-72)
- Special virtualenv header path handling with root rebasing (L93-111)

**Critical Constraints**:
- User and prefix modes are mutually exclusive
- Home and prefix modes are mutually exclusive
- Installation lib config takes precedence over purelib/platlib
- Root installation requires drive-aware path manipulation on Windows