# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/_securetransport/
@generated: 2026-02-09T18:16:09Z

## SecureTransport Integration Module for urllib3 on macOS

This directory implements a complete SecureTransport backend for urllib3 on macOS systems, providing native SSL/TLS functionality through Apple's Security and CoreFoundation frameworks. It serves as a platform-specific alternative to OpenSSL-based implementations.

## Architecture Overview

The module is organized in three layers:

### Framework Bindings Layer (`bindings.py`)
- **Purpose**: Low-level ctypes bindings to macOS Security.framework and CoreFoundation.framework
- **Platform Requirements**: macOS 10.8+ with special handling for Big Sur+ (10.16+)
- **Coverage**: Complete API surface for SSL/TLS operations, certificate handling, keychain management, and CoreFoundation data structures
- **Key Components**:
  - Dynamic framework loading with fallback paths
  - 200+ function signatures matching Apple's native APIs
  - Comprehensive type definitions (CFData, SecCertificateRef, SSLContextRef, etc.)
  - Constants for SSL protocols, cipher suites, and error codes

### Helper Utilities Layer (`low_level.py`)
- **Purpose**: Memory-safe Python wrappers around raw ctypes bindings
- **Focus**: Data conversion, certificate processing, keychain management, error handling
- **Key Functions**:
  - `_cert_array_from_pem()`: PEM certificate bundle parsing
  - `_temporary_keychain()`: Temporary keychain creation for credential storage
  - `_load_client_cert_chain()`: Client certificate trust chain building
  - `_assert_no_error()`: OSStatus to Python exception conversion
- **Memory Management**: Enforces CoreFoundation retain/release semantics

### Package Interface (`__init__.py`)
- **Purpose**: Minimal package marker enabling import of the SecureTransport namespace
- **Integration Point**: Allows urllib3 to import from `urllib3.contrib._securetransport`

## Public API Surface

The module provides urllib3 with:
- **SSL Context Creation**: Native SecureTransport SSL context management
- **Certificate Handling**: PEM/DER certificate parsing and validation
- **Client Authentication**: Certificate chain loading and keychain integration
- **Protocol Support**: TLS 1.2/1.3 with modern cipher suites (AES-GCM, ChaCha20-Poly1305)
- **Error Reporting**: Native macOS SSL error codes converted to Python ssl module exceptions

## Data Flow and Integration

1. **Initialization**: Framework loading with version-aware path resolution
2. **Certificate Processing**: PEM bundles → CFArray of SecCertificateRef objects
3. **SSL Setup**: Python SSL context parameters → SecureTransport SSL contexts
4. **Runtime Operations**: SSL handshake, read/write operations through native APIs
5. **Cleanup**: Automatic memory management following CoreFoundation patterns

## Critical Design Patterns

- **Memory Safety**: All CoreFoundation objects require explicit CFRelease by caller
- **Error Propagation**: OSStatus codes converted to standard Python ssl exceptions
- **Resource Management**: Temporary keychains and file handles properly cleaned up
- **Platform Isolation**: Strict Darwin-only operation with graceful import fallbacks
- **API Compatibility**: Maintains urllib3's standard SSL interface while using native macOS implementations

## Context in urllib3 Ecosystem

This SecureTransport backend allows urllib3 to leverage macOS's native SSL/TLS stack instead of OpenSSL, providing:
- Better integration with macOS security policies
- Access to system keychain and certificates
- Compliance with platform-specific security requirements
- Potential performance benefits from native implementation

The module is part of pip's vendored urllib3 copy, ensuring consistent SSL behavior across macOS environments where system OpenSSL may be outdated or unavailable.