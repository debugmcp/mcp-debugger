# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/_securetransport/bindings.py
@source-hash: e1793ae2a2243c1b
@generated: 2026-02-09T17:57:06Z

## Core Purpose
Low-level ctypes bindings for macOS SecureTransport and CoreFoundation frameworks. Provides C-level API access for SSL/TLS operations, certificate handling, and keychain management on Darwin systems.

## Platform Requirements
- **macOS-only**: Strict Darwin platform check (L53-54) with macOS 10.8+ requirement (L56-62)
- **Version-aware loading**: Big Sur+ (10.16+) uses hardcoded framework paths due to library discovery issues (L65-78)

## Key Components

### Framework Loading (L65-87)
- `load_cdll()` (L65-78): Dynamic library loader with fallback paths for macOS 10.16+
- `Security`: Security.framework binding for SSL/TLS and certificate operations
- `CoreFoundation`: CoreFoundation.framework binding for data structures and memory management

### Type Definitions (L90-133)
Comprehensive ctypes type aliases for:
- **CoreFoundation types**: CFData, CFString, CFArray, CFDictionary, etc. (L90-114)  
- **Security types**: SecCertificateRef, SSLContextRef, SecTrustRef, etc. (L116-133)
- **Callback types**: SSLReadFunc, SSLWriteFunc function pointers (L193-196)

### API Bindings (L135-420)
Extensive function signature definitions for:

**Security Framework Functions**:
- Certificate operations: SecItemImport, SecCertificateCreateWithData (L136-161)
- SSL context management: SSLCreateContext, SSLHandshake, SSLRead/Write (L282-226) 
- Trust evaluation: SecTrustEvaluate, SecTrustSetAnchorCertificates (L267-280)
- Keychain operations: SecKeychainCreate/Delete, SecPKCS12Import (L173-191)

**CoreFoundation Functions**:
- Memory management: CFRetain/CFRelease (L328-332)
- String operations: CFStringCreateWithCString, CFStringGetCString (L337-353)
- Data structures: CFArrayCreate, CFDictionaryCreate (L364-399)

### Constants (L423-519)
- `CFConst` (L423-430): CoreFoundation constants (UTF-8 encoding)
- `SecurityConst` (L432-519): SSL/TLS protocols, cipher suites, error codes, and trust result types

## Architectural Patterns
- **Namespace classes**: CFConst and SecurityConst organize related constants
- **Comprehensive error handling**: Extensive SSL/TLS error code definitions (L463-486)
- **Modern cipher suite support**: TLS 1.2/1.3 cipher suites with AES-GCM, ChaCha20-Poly1305 (L488-519)
- **Graceful API evolution**: Optional ALPN protocol support with AttributeError handling (L298-303)

## Critical Invariants
- All framework loading wrapped in try/catch with ImportError fallback (L419-420)
- Function signatures must match Apple's SecureTransport/CoreFoundation APIs exactly
- Memory management follows CoreFoundation retain/release semantics
- SSL context operations are stateful and order-dependent