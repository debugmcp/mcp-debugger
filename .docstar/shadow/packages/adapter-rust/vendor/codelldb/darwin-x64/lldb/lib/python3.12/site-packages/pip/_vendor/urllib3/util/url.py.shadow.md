# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/url.py
@source-hash: 942004ecce66c80f
@generated: 2026-02-09T17:57:48Z

## Purpose
URL parsing and normalization module for urllib3, providing RFC 3986 and RFC 6874 compliant URL handling with percent-encoding support.

## Core Data Structures

### Url namedtuple (L82-173)
- **Fields**: scheme, auth, host, port, path, query, fragment (L9)
- **Constructor** (L91-107): Normalizes scheme to lowercase, ensures paths start with "/"
- **Properties**:
  - `hostname` (L110-112): Backward-compatible alias for host
  - `request_uri` (L115-122): Returns absolute path + query string
  - `netloc` (L125-129): Network location (host:port format)
  - `url` (L132-169): Reconstructs complete URL string from components
- **String representation** (L171-172): Returns URL string via `url` property

## Key Functions

### parse_url(url) (L333-427)
- **Purpose**: Main URL parsing function, returns Url namedtuple
- **Logic**: Uses URI_RE regex (L19-26) to extract components
- **Features**:
  - Handles scheme-less URLs by prepending "//"
  - Validates port range (0-65535)
  - Applies normalization for HTTP(S) schemes
  - Backward compatibility for empty paths
- **Error handling**: Raises LocationParseError for invalid URLs

### Helper Functions
- `split_first(s, delims)` (L175-207): **DEPRECATED** - finds first delimiter occurrence
- `_encode_invalid_chars(component, allowed_chars)` (L210-241): Percent-encodes URI components
- `_remove_path_dot_segments(path)` (L244-271): Normalizes path by removing "." and ".." segments
- `_normalize_host(host, scheme)` (L274-302): Handles IPv6, IPv4, and IDNA hostname normalization
- `_idna_encode(name)` (L305-320): Encodes international domain names
- `_encode_target(target)` (L323-330): Encodes request targets
- `get_host(url)` (L430-435): **DEPRECATED** - extracts host info

## Regular Expressions & Patterns

### Core URL Parsing (L17-71)
- `URI_RE` (L19-26): Main URL parsing regex with capture groups
- `SCHEME_RE` (L18): Detects URLs with schemes
- `TARGET_RE` (L58): Parses path and query from request targets

### IP Address Patterns (L28-64)
- IPv4: `IPV4_RE` (L60)
- IPv6: Complex pattern with variations for different formats (L32-51)
- IPv6 with zone ID support: `IPV6_ADDRZ_RE` (L62)
- Host/port validation: `_HOST_PORT_RE` (L71)

### Character Sets (L73-79)
- `NORMALIZABLE_SCHEMES` (L13): http, https, None
- Character sets for different URL components (unreserved, path, query, etc.)

## Dependencies
- **Internal**: `..exceptions.LocationParseError`, `..packages.six`
- **Optional**: `pip._vendor.idna` (for international domain names)

## Architectural Notes
- Prioritizes RFC compliance while maintaining urllib3 backward compatibility
- Handles both Python 2/3 compatibility via six library
- Implements comprehensive IPv6 support including zone IDs
- Graceful degradation for missing IDNA module