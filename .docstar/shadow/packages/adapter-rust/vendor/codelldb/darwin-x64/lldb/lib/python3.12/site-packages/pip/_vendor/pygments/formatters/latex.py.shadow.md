# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/latex.py
@source-hash: 146cc9f98a924c4f
@generated: 2026-02-09T17:57:40Z

**Primary Purpose**: LaTeX formatter for Pygments syntax highlighting system. Converts tokenized code into LaTeX markup using the `fancyvrb` and `color` packages, with support for full documents or code snippets.

**Key Classes and Functions**:

- `LatexFormatter` (L147-438): Main formatter class inheriting from `Formatter`. Converts syntax tokens to LaTeX commands with extensive customization options including line numbering, colors, fonts, and document generation.
- `LatexEmbeddedLexer` (L440-521): Specialized lexer for handling escaped LaTeX code within other languages. Processes text to find escape sequences while preserving string/comment contexts.
- `escape_tex()` (L22-40): Core text escaping function that converts LaTeX special characters to safe command sequences using temporary placeholders.
- `_get_ttype_name()` (L135-144): Token type name resolver that maps Pygments token types to LaTeX style names using `STANDARD_TYPES`.

**Key Templates and Constants**:
- `DOC_TEMPLATE` (L43-58): Complete LaTeX document template with configurable sections
- `STYLE_TEMPLATE` (L98-132): LaTeX macro definitions for token styling system with escape character mappings
- Comment block (L60-96): Detailed explanation of the LaTeX macro system architecture

**Architecture Patterns**:
- **Two-phase escaping**: Uses temporary null bytes to avoid double-escaping LaTeX special characters
- **Hierarchical token styling**: Mimics HTML/CSS approach where token styles inherit from parent types with `+` separation
- **Magic macro system**: Uses `\PY` command with class-based styling resolution via `\PY@tok@classname` commands
- **Conditional rendering**: Supports multiple output modes (snippet vs full document, with/without line numbers)

**Key Dependencies**:
- `pip._vendor.pygments.formatter.Formatter`: Base formatter class
- `pip._vendor.pygments.token`: Token types and `STANDARD_TYPES` mapping
- `pip._vendor.pygments.lexer`: `Lexer` base class and `do_insertions` utility
- `pip._vendor.pygments.util`: Option parsing utilities

**Critical Configuration Options**:
- `commandprefix` (default 'PY'): LaTeX command prefix for all generated macros
- `nowrap`: Disables Verbatim environment wrapping
- `full`: Generates complete LaTeX document vs code snippet
- `texcomments`/`mathescape`/`escapeinside`: Different comment handling modes
- Style inheritance through `ttype2name` and `cmd2def` mappings (L280-322)

**Processing Flow**:
1. `__init__` processes options and calls `_create_stylesheet()` (L277)
2. Style creation builds token-to-command mappings from current style
3. `format_unencoded()` (L336-437) processes token stream with context-aware escaping
4. Different escaping strategies for comments vs regular code based on options