# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/terminal.py
@source-hash: 146faba634691663
@generated: 2026-02-09T17:57:36Z

## Purpose
Terminal output formatter for syntax-highlighted code using ANSI color sequences. Part of Pygments library within pip's vendor dependencies.

## Key Components

### TERMINAL_COLORS Dictionary (L23-53)
Maps Pygments token types to color tuples (lightbg, darkbg). Comprehensive color scheme covering:
- Basic tokens: keywords, strings, numbers, comments
- Names: functions, classes, variables, attributes
- Generic tokens: diffs, headings, errors
- Uses underscores for bold formatting, asterisks for emphasis

### TerminalFormatter Class (L56-127)
Main formatter implementation extending Pygments' base Formatter.

**Configuration (L83-89)**:
- `darkbg`: Boolean for dark/light background detection
- `colorscheme`: Custom color mapping or defaults to TERMINAL_COLORS
- `linenos`: Line numbering toggle
- `_lineno`: Internal line counter

**Core Methods**:
- `format()` (L91-92): Delegates to parent implementation
- `_write_lineno()` (L94-96): Outputs formatted line numbers with newline handling
- `_get_color()` (L98-106): Token type color resolution via parent traversal
- `format_unencoded()` (L108-127): Main formatting logic with ANSI sequence generation

## Key Dependencies
- `pip._vendor.pygments.formatter.Formatter`: Base formatter class
- `pip._vendor.pygments.token.*`: Token type definitions
- `pip._vendor.pygments.console.ansiformat`: ANSI color sequence generator
- `pip._vendor.pygments.util.get_choice_opt`: Option validation utility

## Architecture Pattern
Token-based formatting pipeline:
1. Receives token stream from lexer
2. Maps tokens to colors via hierarchical lookup
3. Applies ANSI formatting per line
4. Handles newlines and optional line numbering

## Critical Behavior
- Color sequences terminated at newlines for pager compatibility
- Hierarchical token type resolution (walks parent chain when color not found)
- Line-by-line processing preserves original line structure
- Strips trailing newlines before applying ANSI, re-adds after