# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_internal/locations/base.py
@source-hash: 45088f8b57781553
@generated: 2026-02-09T17:59:28Z

## Purpose
Base module for handling installation locations and path management in pip. Provides platform-agnostic utilities for determining where Python packages should be installed and how paths should be manipulated.

## Key Functions

### `get_major_minor_version()` (L19-24)
Returns current Python version as "X.Y" string format. Simple utility using `sys.version_info`.

### `change_root(new_root, pathname)` (L27-52)
Cross-platform path manipulation function that prepends a new root to a pathname. Handles platform differences:
- **POSIX**: Strips leading slash from absolute paths before joining
- **Windows**: Uses `os.path.splitdrive()` to handle drive letters properly
- **Unknown platforms**: Raises `InstallationError`

Borrowed from Python's distutils module for compatibility.

### `get_src_prefix()` (L55-68)
Determines source directory location based on environment:
- **Virtual environment**: Uses `sys.prefix/src`
- **System Python**: Uses current working directory + "src"
- **Error handling**: Exits gracefully if CWD is deleted/renamed
- **macOS fix**: Uses `os.path.abspath()` to resolve virtualenv prefix issues

### `is_osx_framework()` (L79-81)
Cached function that detects macOS framework Python installations by checking `PYTHONFRAMEWORK` config variable. Uses `@functools.lru_cache` for performance.

## Key Variables

### `USER_CACHE_DIR` (L13)
Global cache directory for pip using `appdirs.user_cache_dir()`.

### `site_packages` (L16)
Path to site-packages directory from `sysconfig.get_path("purelib")`.

### `user_site` (L71-76)
User site-packages directory with fallback handling:
- Primary: `site.getusersitepackages()` if available
- Fallback: `site.USER_SITE` for older Python versions

## Dependencies
- **Standard library**: `os`, `sys`, `sysconfig`, `site`, `functools`, `typing`
- **Internal pip modules**: `exceptions`, `utils.appdirs`, `utils.virtualenv`

## Architecture Notes
- Handles cross-platform path operations with explicit OS detection
- Uses caching for expensive operations (`is_osx_framework`)
- Graceful degradation for missing attributes (`user_site` fallback)
- Environment-aware logic (virtualenv vs system Python)