# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/platformdirs/windows.py
@source-hash: 205a62a21501c313
@generated: 2026-02-09T17:59:52Z

## Windows Platform Directory Provider

**Primary Purpose**: Implements Windows-specific directory path resolution following Microsoft's MSDN guidelines for application data storage locations.

### Core Class

**Windows (L16-141)**: Concrete implementation of `PlatformDirsABC` that provides Windows-specific directory paths using CSIDL constants and Windows API calls.

#### Key Properties:
- `user_data_dir` (L28-36): Returns user-specific data directory, toggles between roaming/local AppData based on `roaming` flag
- `site_data_dir` (L54-57): Returns system-wide shared data directory (`CSIDL_COMMON_APPDATA`)
- `user_config_dir` (L60-62): Aliases to `user_data_dir` (Windows doesn't distinguish config from data)
- `user_cache_dir` (L70-76): Local AppData with optional "Cache" subfolder when opinionated
- `user_log_dir` (L90-96): User data directory with optional "Logs" subfolder when opinionated
- `user_runtime_dir` (L129-135): Temp directory under Local AppData
- User media directories (L99-126): Documents, Downloads, Pictures, Videos, Music, Desktop

#### Core Method:
- `_append_parts` (L38-51): Constructs directory paths by appending appauthor/appname/version components, handles directory creation

### Windows Folder Resolution System

**Three-tier fallback strategy for CSIDL resolution:**

1. **get_win_folder_via_ctypes (L213-249)**: Primary method using Windows Shell API via ctypes
   - Maps CSIDL names to numeric constants (L221-231)
   - Uses `SHGetFolderPathW` for path resolution
   - Handles Unicode path downgrading for compatibility

2. **get_win_folder_from_registry (L183-210)**: Registry-based fallback
   - Queries `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders`
   - Maps CSIDL names to registry keys

3. **get_win_folder_from_env_vars (L143-161)**: Environment variable fallback
   - Maps common CSIDL names to environment variables (APPDATA, LOCALAPPDATA, etc.)
   - Delegates to `get_win_folder_if_csidl_name_not_env_var` for user directories

**Helper Functions:**
- `get_win_folder_if_csidl_name_not_env_var` (L164-180): Handles user directories by constructing paths from USERPROFILE
- `_pick_get_win_folder` (L252-265): Strategy selector that chooses resolution method based on available imports
- `get_win_folder` (L268): LRU-cached function using selected strategy

### Dependencies
- Inherits from `.api.PlatformDirsABC`
- Uses `os`, `sys`, `functools.lru_cache`
- Conditionally imports `ctypes`, `winreg` for Windows-specific functionality

### Architecture Notes
- Implements graceful degradation across three folder resolution strategies
- Uses CSIDL constants for Windows Shell folder identification
- Caches folder resolution results for performance
- Handles Unicode path compatibility issues on Windows