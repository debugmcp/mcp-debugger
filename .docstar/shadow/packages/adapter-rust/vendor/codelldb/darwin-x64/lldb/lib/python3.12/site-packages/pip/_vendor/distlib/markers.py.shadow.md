# packages/adapter-rust/vendor/codelldb/darwin-x64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/markers.py
@source-hash: 9f70df3a1d72bd9f
@generated: 2026-02-09T17:59:38Z

## Purpose
Parser and evaluator for PEP 508 environment markers micro-language, used to conditionally specify package dependencies based on environment characteristics.

## Key Components

### Main Entry Point
- `interpret(marker, execution_context=None)` (L147-167): Primary public API function that parses and evaluates a marker string against current or provided execution context

### Core Classes
- `Evaluator` (L45-98): Expression evaluator that handles marker AST evaluation
  - `operations` (L50-63): Dictionary mapping operators to lambda functions for comparison and logical operations
  - `evaluate(expr, context)` (L65-98): Recursive expression evaluator supporting literals, variables, and nested operations

### Utility Functions
- `_is_version_marker(s)` (L31-32): Checks if string is a version-related marker ('python_version', 'python_full_version')
- `_is_literal(o)` (L35-38): Identifies quoted string literals
- `_get_versions(s)` (L41-42): Extracts version objects from version strings using regex
- `default_context()` (L104-138): Generates environment context dictionary with platform/Python information

### Constants and Patterns
- `_VERSION_PATTERN` (L26-27): Regex for matching version strings in various quote formats
- `_VERSION_MARKERS` (L28): Set of marker names that represent version information
- `DEFAULT_CONTEXT` (L141): Pre-computed default environment context
- `evaluator` (L144): Global Evaluator instance

## Dependencies
- External: `os`, `re`, `sys`, `platform` (standard library)
- Internal: `.compat.string_types`, `.util.{in_venv, parse_marker}`, `.version.LegacyVersion`

## Key Patterns
- **Version Handling**: Special logic for version comparisons using LegacyVersion wrapper (L90-96)
- **Context Merging**: Default context can be overridden with execution_context parameter
- **Expression AST**: Handles both string literals and dict-based expression trees
- **Error Handling**: Converts parsing exceptions to SyntaxError with descriptive messages

## Critical Behaviors
- Quoted strings are treated as literals with quotes stripped (L71-72)
- Version markers trigger special comparison logic using LegacyVersion objects
- Unknown variables in context raise SyntaxError
- Literal-to-literal comparisons are forbidden as invalid syntax (L84-86)