# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_loop.py
@source-hash: 855ffa08b7683e6d
@generated: 2026-02-09T18:00:46Z

## Purpose
Utility module providing iterator enhancement functions that augment iteration with positional metadata (first/last element flags). Part of the Rich library's internal utilities for formatting and display logic.

## Key Functions

### `loop_first(values: Iterable[T])` (L6-15)
- **Purpose**: Wraps an iterable to identify the first element during iteration
- **Returns**: Generator yielding `(is_first: bool, value: T)` tuples
- **Logic**: Uses iterator protocol to peek at first element, yields `(True, first_value)` then `(False, remaining_values)`
- **Edge case**: Returns immediately for empty iterables (L11-12)

### `loop_last(values: Iterable[T])` (L18-28)
- **Purpose**: Wraps an iterable to identify the last element during iteration
- **Returns**: Generator yielding `(is_last: bool, value: T)` tuples
- **Logic**: Uses lookahead technique - maintains `previous_value` and only yields when next value is available
- **Final yield**: Last element marked with `(True, last_value)` (L28)

### `loop_first_last(values: Iterable[T])` (L31-43)
- **Purpose**: Combines both first and last detection in a single pass
- **Returns**: Generator yielding `(is_first: bool, is_last: bool, value: T)` tuples
- **Logic**: Similar lookahead pattern with additional `first` flag tracking
- **State management**: `first` flag set to `False` after first iteration (L41)

## Architecture Notes
- All functions handle empty iterables gracefully by early return
- Uses generic `TypeVar("T")` (L3) for type safety across different value types
- Employs iterator protocol and lookahead patterns for efficient single-pass processing
- No external dependencies beyond Python typing system

## Common Usage Pattern
These utilities enable Rich's formatting components to apply special styling to boundary elements (first/last items in lists, tables, etc.) without requiring multiple passes over data.