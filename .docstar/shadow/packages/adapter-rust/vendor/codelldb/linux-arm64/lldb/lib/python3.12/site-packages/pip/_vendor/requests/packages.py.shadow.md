# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/requests/packages.py
@source-hash: fd94030894c9f123
@generated: 2026-02-09T18:00:44Z

## Purpose
Backwards compatibility shim that creates aliased module imports for vendored packages within the pip/requests ecosystem. Manipulates `sys.modules` to establish multiple import paths for the same modules.

## Key Components

**Package Aliasing Loop (L8-16)**: Iterates through `urllib3` and `idna` packages to create dual import paths:
- Imports vendored versions from `pip._vendor.{package}`
- Creates aliases in local namespace and `sys.modules`
- Maps `pip._vendor.requests.packages.{package}` to the same module objects as `pip._vendor.{package}`

**Character Detection Handling (L18-25)**: Conditionally handles `chardet` package if available:
- Dynamically determines target module name from `chardet.__name__`
- Creates aliases under `requests.packages.{mod}` namespace
- Replaces module name prefixes to maintain compatibility

## Dependencies
- `sys` module for `sys.modules` manipulation
- `.compat.chardet` for character detection library
- Dynamic imports of `pip._vendor.urllib3` and `pip._vendor.idna`

## Architecture Patterns
- **Module Aliasing**: Uses `sys.modules` dictionary manipulation to create multiple import paths
- **Dynamic Import**: Leverages `__import__()` and `locals()` for runtime module binding
- **Backwards Compatibility**: Maintains legacy import paths while using vendored dependencies

## Critical Invariants
- Identity preservation: `requests.packages.urllib3.*` must be identical to `urllib3.*` objects
- Module traversal must handle nested submodules (startswith pattern matching)
- Conditional execution prevents errors when `chardet` is unavailable