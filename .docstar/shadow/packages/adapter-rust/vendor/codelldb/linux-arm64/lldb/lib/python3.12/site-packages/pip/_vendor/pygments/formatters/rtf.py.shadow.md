# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/rtf.py
@source-hash: 680d2ffe9b16e8a6
@generated: 2026-02-09T17:57:50Z

**RTF Formatter Module for Pygments**

This module implements Rich Text Format (RTF) output generation for syntax-highlighted code. It converts tokenized source code into RTF documents suitable for Microsoft Word and other RTF-compatible applications.

**Primary Components:**

- **RtfFormatter class (L18-146)**: Main formatter that extends Pygments' base `Formatter` class
  - Generates complete RTF documents with color tables, font specifications, and formatting
  - Handles ASCII natively but properly escapes Unicode characters using RTF escape sequences
  - Supports configurable font face and size options

**Key Methods:**

- **`__init__` (L50-64)**: Initializes formatter with optional `fontface` and `fontsize` parameters
  - `fontface`: Custom font family name (defaults to RTF's `\fmodern`)  
  - `fontsize`: Font size in half-points (default 0 = use RTF default)

- **`_escape` (L66-69)**: Basic RTF character escaping for backslashes and braces
- **`_escape_text` (L71-93)**: Comprehensive text escaping with Unicode handling
  - ASCII characters (< 127): passed through unchanged
  - Unicode BMP (127-65535): converted to `{\u####}` sequences
  - Surrogate pairs (> 65535): split using `surrogatepair()` utility
  - Newlines converted to RTF paragraph breaks (`\par`)

- **`format_unencoded` (L95-146)**: Core formatting logic that generates complete RTF output
  - Writes RTF 1.8 header with font table
  - Builds color table from style definitions (L104-115)
  - Processes token stream and applies formatting (L121-144)
  - Maps Pygments styles to RTF formatting codes (bold=`\b`, italic=`\i`, underline=`\ul`)

**Dependencies:**
- `pip._vendor.pygments.formatter.Formatter`: Base class
- `pip._vendor.pygments.util`: Provides `get_int_opt()` and `surrogatepair()` utilities

**Architecture Notes:**
- Color mapping strategy builds lookup table to reference colors by index in RTF
- Token type inheritance traversal (L122-123) finds applicable styles for tokens
- RTF format constraints: Unicode limited to 16-bit values, requiring surrogate pair handling
- Output encoding ignored since RTF is ASCII-based with escape sequences for Unicode