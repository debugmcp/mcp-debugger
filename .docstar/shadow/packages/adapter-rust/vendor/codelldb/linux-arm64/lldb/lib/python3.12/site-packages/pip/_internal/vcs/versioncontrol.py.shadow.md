# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/vcs/versioncontrol.py
@source-hash: 72f7fffa19d30234
@generated: 2026-02-09T18:00:40Z

## VCS (Version Control) Support Module

This module provides the core infrastructure for pip's VCS support, handling repository operations, URL parsing, and backend management for various version control systems like Git, SVN, Mercurial, and Bazaar.

### Key Classes & Functions

**VcsSupport (L172-250)**: Registry and factory for VCS backends
- `_registry` (L173): Dict mapping VCS names to VersionControl instances
- `schemes` (L174): Supported URL schemes for VCS operations
- `register()` (L200-206): Registers VCS backend classes
- `get_backend_for_dir()` (L212-233): Detects VCS type from directory contents
- `get_backend_for_scheme()` (L235-242): Returns backend for URL scheme
- `backends`, `dirnames`, `all_schemes` properties provide aggregated backend info

**VersionControl (L255-688)**: Abstract base class for VCS implementations
- Class attributes: `name`, `dirname`, `repo_name`, `schemes` (L256-260)
- URL processing: `get_url_rev_and_auth()` (L378-406) parses VCS URLs with revision info
- Repository operations: `obtain()` (L490-578) handles clone/update with user prompts
- Abstract methods: `fetch_new()` (L447-459), `switch()` (L461-468), `update()` (L470-477)
- Command execution: `run_command()` (L609-664) wraps subprocess calls with VCS-specific handling

**RevOptions (L117-170)**: Immutable dataclass encapsulating VCS revision options
- `vc_class`, `rev`, `extra_args`, `branch_name` fields
- `to_args()` (L144-154): Converts to command-line arguments
- `make_new()` (L162-169): Creates new instance with different revision

### Utility Functions

**URL & Path Utilities**:
- `is_url()` (L50-57): Detects if string is a valid URL
- `make_vcs_requirement_url()` (L60-75): Constructs VCS requirement URLs
- `find_path_to_project_root_from_repo_root()` (L78-104): Locates Python project within repo

### Exception Classes

- `RemoteNotFoundError` (L107): Repository has no configured remote
- `RemoteNotValidError` (L111-114): Invalid repository URL

### Global Registry

**vcs** (L252): Global VcsSupport instance used throughout pip for VCS operations

### Key Patterns

1. **Plugin Architecture**: VCS backends register themselves with the global `vcs` registry
2. **Command Abstraction**: All VCS operations go through `run_command()` with unified error handling
3. **Interactive Prompts**: `obtain()` method handles conflicts with user prompts (switch/ignore/wipe/backup)
4. **URL Parsing**: Complex logic to extract VCS type, credentials, and revision from URLs
5. **Repository Detection**: Hierarchical search for VCS directories using backend-specific detection

### Dependencies

- Uses `pip._internal.utils.subprocess` for command execution
- Integrates with `pip._internal.utils.misc` for file operations and user interaction
- Leverages urllib.parse for URL manipulation and scheme registration