# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/ssl_.py
@source-hash: 5f8f80a96f756983
@generated: 2026-02-09T17:57:59Z

## Purpose
SSL/TLS utilities module for urllib3, providing cross-platform SSL context creation, certificate validation, and socket wrapping functionality. Handles platform differences and version compatibility for secure connections.

## Key Components

### Constants & Configuration
- **HASHFUNC_MAP** (L27): Maps digest lengths to hash functions (md5: 32, sha1: 40, sha256: 64)
- **DEFAULT_CIPHERS** (L110-127): Secure cipher suite preference list prioritizing forward secrecy (ECDHE/DHE), AESGCM/ChaCha20
- **ALPN_PROTOCOLS** (L24): Default HTTP/1.1 protocol list for ALPN negotiation

### Security Functions
- **_const_compare_digest_backport()** (L30-40): Constant-time digest comparison to prevent timing attacks
- **assert_fingerprint()** (L182-208): Validates certificate fingerprints using configurable hash algorithms
- **is_ipaddress()** (L457-467): Detects IPv4/IPv6 addresses for SNI hostname validation

### SSL Context Management
- **SSLContext fallback class** (L133-179): Compatibility shim for Python 2, provides basic SSL context interface with warnings
- **create_urllib3_context()** (L250-352): Creates secure SSL context with hardened defaults:
  - Disables SSLv2/SSLv3/compression/tickets
  - Enables post-handshake auth for TLS 1.3
  - Supports SSLKEYLOGFILE environment variable
- **resolve_cert_reqs()** (L211-231): Resolves certificate requirement strings to ssl constants
- **resolve_ssl_version()** (L234-247): Resolves SSL version strings to protocol constants

### Socket Wrapping
- **ssl_wrap_socket()** (L355-454): Main socket wrapping function supporting:
  - Custom SSL contexts and certificates
  - CA certificate loading (files/directories/data)
  - SNI hostname validation
  - ALPN protocol negotiation
  - TLS-in-TLS tunneling via SSLTransport
- **_ssl_wrap_socket_impl()** (L481-495): Low-level socket wrapper choosing between standard SSL and TLS-in-TLS
- **_is_key_file_encrypted()** (L470-478): Detects encrypted private key files

## Dependencies
- **ssl module**: Core SSL functionality with extensive compatibility imports (L45-90)
- **ssltransport**: Optional TLS-in-TLS support (L57-59)
- **urllib3.exceptions**: Custom SSL/warning exceptions (L10-15)
- **url utils**: IP address regex patterns for hostname validation (L17)

## Architecture Patterns
- **Graceful degradation**: Extensive try/catch blocks for missing SSL features
- **Compatibility layer**: Fallback SSLContext implementation for older Python versions
- **Security-first defaults**: Conservative cipher selection and protocol options
- **Cross-platform support**: Handles platform-specific SSL implementations (PyOpenSSL, SecureTransport)

## Critical Invariants
- Certificate fingerprints must use constant-time comparison
- IP addresses cannot be used as SNI hostnames per RFC3546
- Encrypted private keys require explicit password provision
- TLS-in-TLS requires SSLTransport validation