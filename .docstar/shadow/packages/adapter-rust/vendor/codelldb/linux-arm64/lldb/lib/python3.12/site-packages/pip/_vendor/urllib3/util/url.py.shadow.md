# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/url.py
@source-hash: 942004ecce66c80f
@generated: 2026-02-09T17:57:55Z

## Purpose
URL parsing and normalization utility module for urllib3. Provides RFC 3986 and RFC 6874 compliant URL parsing with support for HTTP/HTTPS schemes, IPv4/IPv6 addresses, and percent-encoding.

## Key Components

### Core Data Structure
- **Url namedtuple (L82-173)**: Immutable URL representation with fields [scheme, auth, host, port, path, query, fragment]
  - `__new__` (L91-107): Normalizes scheme to lowercase, ensures path starts with "/"
  - `hostname` property (L109-112): Backwards compatibility alias for host
  - `request_uri` property (L114-122): Returns path + query string for HTTP requests
  - `netloc` property (L124-129): Returns host:port network location
  - `url` property (L131-169): Reconstructs complete URL string from components

### Parsing Functions
- **parse_url(url) (L333-427)**: Main parsing function, returns Url namedtuple
  - Handles scheme-less URLs by prepending "//"
  - Applies normalization for HTTP/HTTPS schemes only
  - Validates port ranges (0-65535)
  - Encodes invalid characters in components
- **get_host(url) (L430-435)**: Deprecated wrapper returning (scheme, hostname, port)

### Helper Functions
- **split_first(s, delims) (L175-207)**: DEPRECATED - Splits string on first found delimiter
- **_encode_invalid_chars(component, allowed_chars) (L210-241)**: Percent-encodes URI components while preserving existing encodings
- **_remove_path_dot_segments(path) (L244-271)**: Normalizes paths by removing "." and ".." segments per RFC 3986
- **_normalize_host(host, scheme) (L274-302)**: Normalizes hostnames with IDNA encoding for internationalized domains
- **_idna_encode(name) (L305-320)**: IDNA encoding for international domain names
- **_encode_target(target) (L323-330)**: Encodes request targets (path + query)

### Constants and Patterns
- **url_attrs (L9)**: Field names for Url namedtuple
- **NORMALIZABLE_SCHEMES (L13)**: Schemes that undergo normalization ("http", "https", None)
- **Regex patterns (L17-71)**: Comprehensive URI component matching including IPv4/IPv6 patterns
- **Character sets (L73-79)**: Allowed characters for different URI components per RFC 3986

### Dependencies
- **six**: Python 2/3 compatibility utilities
- **idna**: International domain name encoding (optional, imported on demand)
- **LocationParseError**: Custom exception from ..exceptions

## Architecture Notes
- Follows RFC 3986 URI specification strictly
- IPv6 addresses with zone IDs handled per RFC 6874
- Graceful degradation when IDNA module unavailable
- Maintains backwards compatibility with Python's urlparse module
- Optimized regex patterns derived from rfc3986 library