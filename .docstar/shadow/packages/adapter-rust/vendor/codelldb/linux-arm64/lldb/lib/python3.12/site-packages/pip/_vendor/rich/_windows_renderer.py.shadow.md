# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_windows_renderer.py
@source-hash: b7be192f7c6e0c23
@generated: 2026-02-09T18:00:50Z

## Purpose
This module provides a rendering adapter for the Rich library to output styled text and control sequences to legacy Windows console terminals using Win32 API calls.

## Key Function
**`legacy_windows_render` (L7-56)**: Main rendering function that processes Rich Segments and translates them into appropriate Windows Console API calls through a `LegacyWindowsTerm` interface.

## Processing Logic
The renderer iterates through Segment objects from the buffer and handles two main categories:

**Text Rendering (L14-19)**:
- Styled text via `term.write_styled(text, style)`
- Plain text via `term.write_text(text)`

**Control Sequence Processing (L21-56)**:
- **Cursor positioning**: `CURSOR_MOVE_TO` (L24-26) converts 1-based coordinates to 0-based Windows coordinates
- **Cursor movement**: Support for UP, DOWN, FORWARD, BACKWARD operations (L31-38)
- **Line operations**: Carriage return (L27-28), HOME positioning (L29-30), column positioning (L39-41)
- **Cursor visibility**: HIDE/SHOW_CURSOR controls (L42-45)
- **Line erasing**: `ERASE_IN_LINE` with three modes - end (0), start (1), entire line (2) (L46-53)
- **Window management**: `SET_WINDOW_TITLE` (L54-56)

## Dependencies
- `LegacyWindowsTerm`: Win32 console API wrapper for actual terminal operations
- `WindowsCoordinates`: Data structure for terminal positioning
- `Segment`: Rich's text/style/control tuple format
- `ControlCode` and `ControlType`: Control sequence definitions

## Architecture Notes
- Coordinate conversion: Rich uses 1-based coordinates, Windows uses 0-based (L26, L41)
- Uses type casting for control code parameter extraction
- Direct mapping from Rich control types to Windows console operations