# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/locations/base.py
@source-hash: 45088f8b57781553
@generated: 2026-02-09T18:00:22Z

## Purpose
Core location management module for pip that provides path resolution utilities and system-specific directory handling for package installation. Serves as the foundation for determining where packages should be installed and where pip should store cached data.

## Key Constants and Variables
- `USER_CACHE_DIR` (L13): Global pip cache directory using appdirs library
- `site_packages` (L16): Pure Python library installation path from sysconfig
- `user_site` (L74-76): User site-packages directory with fallback handling

## Key Functions

### `get_major_minor_version()` (L19-24)
Returns current Python version as "major.minor" string (e.g., "3.12"). Simple formatter using sys.version_info.

### `change_root(new_root, pathname)` (L27-52)
Cross-platform path manipulation utility that prepends a new root to existing paths. Handles platform-specific absolute path conversion:
- POSIX systems (L36-40): Strips leading slash from absolute paths
- Windows (L42-46): Handles drive letters and backslashes
- Raises InstallationError for unsupported platforms (L49-52)

### `get_src_prefix()` (L55-68)
Determines source code installation directory based on environment:
- Virtual environments: `{sys.prefix}/src` (L57)
- Global environments: `{cwd}/src` with error handling for deleted directories (L61-64)
- Returns absolute path with macOS virtualenv workaround (L68)

### `is_osx_framework()` (L79-81)
Cached detection of macOS framework Python installation using sysconfig. Uses `@functools.lru_cache` for performance.

## Dependencies
- Standard library: functools, os, site, sys, sysconfig, typing
- Internal pip modules: exceptions.InstallationError, utils.appdirs, utils.virtualenv

## Architecture Notes
- Mixed approach to path resolution: uses both sysconfig and manual path construction
- Platform-aware implementations with explicit OS detection
- Defensive programming with error handling for filesystem edge cases
- Performance optimization with LRU caching for expensive system queries