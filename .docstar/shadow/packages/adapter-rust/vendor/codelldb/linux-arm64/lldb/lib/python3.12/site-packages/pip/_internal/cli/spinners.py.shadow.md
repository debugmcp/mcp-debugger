# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/spinners.py
@source-hash: 84827cdc67ab7458
@generated: 2026-02-09T18:00:19Z

## Primary Purpose
Provides spinner UI components for displaying progress during long-running pip operations. Implements both interactive terminal spinners and non-interactive logging-based progress indicators.

## Key Classes and Components

### SpinnerInterface (L14-19)
Abstract base interface defining the spinner contract with two methods:
- `spin()`: Update spinner display
- `finish(final_status)`: Complete spinner with final message

### InteractiveSpinner (L22-68)
Visual spinning indicator for interactive terminals:
- Displays animated characters (`-\|/` by default) at ~8 updates/second (L28-29)
- Uses backspace/overwrite technique to update in-place (L43-53)
- Rate-limited updates via `RateLimiter` (L35, L58-59)
- Respects indentation from pip's logging system (L40)
- Tracks completion state to prevent duplicate operations (L36, L56, L63)

### NonInteractiveSpinner (L75-98)
Progress indicator for non-TTY environments (CI systems, redirected output):
- Logs periodic "still running" messages every 60 seconds by default (L76, L92)
- Uses standard logging infrastructure instead of direct stdout (L85)
- Designed as keepalive for systems that timeout on silent processes (L72-74)

### RateLimiter (L101-112)
Simple time-based throttling mechanism:
- `ready()`: Checks if minimum interval has elapsed (L106-109)
- `reset()`: Updates last update timestamp (L111-112)
- Used by both spinner types to prevent excessive updates

## Key Functions

### open_spinner (L115-136)
Context manager factory that automatically selects appropriate spinner type:
- Returns `InteractiveSpinner` for TTY terminals at INFO+ log level (L122-123)
- Returns `NonInteractiveSpinner` for non-TTY or quiet modes (L124-125)
- Handles exceptions by finishing spinner with appropriate status (L129-136)
- Integrates with cursor hiding for clean display (L127)

### hidden_cursor (L143-159)
Context manager for hiding terminal cursor during spinner display:
- Uses ANSI escape codes `\x1b[?25l` and `\x1b[?25h` (L139-140)
- Skips cursor control on Windows (incompatible) and non-TTY outputs (L147-153)
- Ensures cursor is always restored via try/finally (L155-159)

## Dependencies
- `pip._internal.utils.compat.WINDOWS`: Platform detection for cursor control
- `pip._internal.utils.logging.get_indentation`: Consistent formatting with pip's logging
- Standard library: `contextlib`, `itertools`, `logging`, `sys`, `time`

## Architectural Patterns
- Strategy pattern: Different spinner implementations for different environments
- Context manager pattern: Resource management for spinners and cursor state
- Rate limiting: Prevents performance issues from excessive updates
- Graceful degradation: Falls back to logging-based progress in constrained environments