# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/parser.py
@source-hash: 400918eacf0df800
@generated: 2026-02-09T18:00:19Z

**Purpose:** Custom command-line option parser infrastructure for pip, extending optparse with configuration file integration, improved help formatting, and URL redaction capabilities.

**Core Classes:**

- **PrettyHelpFormatter (L18-98):** Enhanced help formatter that provides cleaner, more readable command-line help output
  - Adjusts terminal width and positioning for better formatting
  - Custom option string formatting with `_format_option_strings()` (L31-55)
  - Handles usage, description, and epilog formatting with proper indentation
  - Key method: `format_description()` (L70-86) differentiates between "Commands" and "Description" labels

- **UpdatingDefaultsHelpFormatter (L100-130):** Extends PrettyHelpFormatter with configuration-aware defaults
  - Updates defaults before displaying help via `expand_default()` (L109-129)
  - **Security feature:** Redacts authentication credentials from URL options using `redact_auth_from_url()`
  - Integrates with ConfigOptionParser to show current configuration values in help

- **CustomOptionParser (L132-152):** Basic optparse.OptionParser extension
  - Adds `insert_option_group()` (L133-142) for flexible option group positioning
  - Provides `option_list_all` property (L144-151) to get all options including those in groups

- **ConfigOptionParser (L154-294):** Main parser class integrating configuration files with command-line options
  - Constructor (L158-169) accepts `name` and `isolated` parameters, initializes Configuration object
  - `_get_ordered_configuration_items()` (L178-204) processes config with precedence: global → command-specific → environment
  - `_update_defaults()` (L206-268) core method that merges configuration values with option defaults
    - Handles different option types: boolean, count, append, callback actions
    - Validates configuration values and provides user-friendly error messages
  - `get_default_values()` (L270-290) loads configuration and applies defaults with error handling

**Key Dependencies:**
- `optparse` for base option parsing functionality
- `pip._internal.configuration.Configuration` for config file management  
- `pip._internal.utils.misc.redact_auth_from_url` for credential security
- `pip._internal.cli.status_codes.UNKNOWN_ERROR` for consistent error codes

**Architecture Patterns:**
- **Layered inheritance:** CustomOptionParser → ConfigOptionParser for progressive enhancement
- **Composition over inheritance:** Uses Configuration object rather than inheriting config behavior
- **Template method pattern:** Multiple format_* methods in PrettyHelpFormatter for customizable help output
- **Configuration precedence system:** global < command-specific < environment variables

**Critical Behaviors:**
- Configuration loading happens lazily in `get_default_values()` with comprehensive error handling
- URL options automatically have auth credentials redacted in help output for security
- Boolean and count options support flexible string-to-value conversion with detailed error messages
- Late evaluation system for callback options ensures proper initialization order