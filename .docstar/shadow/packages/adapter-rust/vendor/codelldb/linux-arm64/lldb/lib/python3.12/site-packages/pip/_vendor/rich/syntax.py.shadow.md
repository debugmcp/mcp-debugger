# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/syntax.py
@source-hash: 4e7643b8e0f80de1
@generated: 2026-02-09T18:01:07Z

## Rich Syntax Highlighting Module

**Purpose**: Renders syntax-highlighted code using Pygments for the Rich terminal library. Supports multiple themes, line numbers, word wrapping, and custom styling ranges.

### Key Classes

**SyntaxTheme (L123-135)** - Abstract base class defining interface for syntax themes:
- `get_style_for_token()` - Map Pygments tokens to Rich styles
- `get_background_style()` - Get background color style

**PygmentsSyntaxTheme (L137-177)** - Delegates to Pygments built-in themes:
- Caches token styles in `_style_cache` (L141, L156)
- Converts Pygments color format to Rich Style objects (L163-171)
- Falls back to "default" theme on ClassNotFound (L145-146)

**ANSISyntaxTheme (L179-210)** - Uses ANSI color mappings for terminals:
- Hierarchical token lookup from specific to general (L194-204)
- Built-in light/dark themes via `ANSI_LIGHT`/`ANSI_DARK` (L61-117)

**Syntax (L227-812)** - Main syntax highlighting class:
- Core rendering logic in `__rich_console__()` (L618-627) and `_get_syntax()` (L629-762)
- Line number rendering with highlighting support (L741-757)
- Custom range styling via `stylize_range()` (L537-549) and `_stylized_ranges` (L299)
- Lexer detection from file path/content in `guess_lexer()` (L364-404)
- Code preprocessing (dedent, tab expansion) in `_process_code()` (L793-811)

### Key Functions

**from_path() (L301-362)** - Class method to create Syntax from file, auto-detecting lexer
**highlight() (L452-535)** - Core highlighting logic, returns styled Text object
**_get_line_numbers_color() (L551-564)** - Blends background/foreground for line number colors
**_apply_stylized_ranges() (L763-791)** - Applies custom styling to specific code ranges
**_get_code_index_for_syntax_position() (L814-838)** - Maps line/column positions to string indices

### Dependencies
- **Pygments**: Lexer detection, tokenization, and built-in themes
- **Rich**: Text rendering, styling, console output, measurements
- **Standard library**: Path handling, regex, textwrap

### Key Data Structures
- `RICH_SYNTAX_THEMES` (L119) - Built-in ANSI theme mappings
- `TokenType` (L53) - Tuple representing Pygments token hierarchy
- `SyntaxPosition` (L212) - (line, column) tuple for range styling
- `_SyntaxHighlightRange` (L215-225) - NamedTuple for custom styling ranges

### Architecture Notes
- Plugin architecture for themes via SyntaxTheme ABC
- Efficient line-range rendering to avoid processing entire files
- Caching strategies for token styles and lexer objects
- Fallback mechanisms for missing lexers/themes
- Support for both transparent and opaque backgrounds
- Integration with Rich's measurement and padding systems

### Constants
- `DEFAULT_THEME = "monokai"` (L56)
- `NUMBERS_COLUMN_DEFAULT_PADDING = 2` (L120)
- Platform detection via `WINDOWS` (L55)