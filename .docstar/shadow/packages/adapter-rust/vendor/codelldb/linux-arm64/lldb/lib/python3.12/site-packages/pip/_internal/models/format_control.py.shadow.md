# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/models/format_control.py
@source-hash: c2db10a922bd1da5
@generated: 2026-02-09T18:00:19Z

## Purpose
Manages format restrictions for Python package installations, controlling whether packages can be installed from binary wheels, source distributions, or both.

## Core Architecture

### FormatControl Class (L8-78)
Primary class for managing installation format constraints with two complementary sets:
- `no_binary` (L23): Set of package names that must be installed from source only
- `only_binary` (L24): Set of package names that must be installed from binary wheels only

### Key Methods

**`__init__(self, no_binary, only_binary)` (L13-24)**
- Initializes format control with optional sets, defaulting to empty sets
- Both parameters are mutually exclusive constraints

**`handle_mutual_excludes(value, target, other)` (L38-59)**
- Static method for processing comma-separated format control strings
- Handles special tokens:
  - `:all:` - applies constraint to all packages, clears both sets
  - `:none:` - removes constraint, clears target set
- Canonicalizes package names using packaging.utils
- Enforces mutual exclusion between no_binary and only_binary sets
- Raises CommandError for malformed input (values starting with "-")

**`get_allowed_formats(canonical_name)` (L61-71)**
- Returns frozenset of allowed installation formats ("binary", "source")
- Resolution precedence: specific package name â†’ `:all:` wildcard
- Logic: starts with both formats, removes based on constraints

**`disallow_binaries()` (L73-78)**
- Convenience method to disable binary installation for all packages
- Equivalent to adding `:all:` to no_binary set

## Dependencies
- `pip._vendor.packaging.utils.canonicalize_name`: Package name normalization
- `pip._internal.exceptions.CommandError`: Error handling for malformed input

## Design Patterns
- Uses `__slots__` for memory efficiency
- Implements proper equality comparison with type checking
- Immutable result via frozenset in get_allowed_formats
- Static method for shared logic that doesn't need instance state