# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/platformdirs/windows.py
@source-hash: 205a62a21501c313
@generated: 2026-02-09T18:00:46Z

**Windows Platform Directory Implementation**

Implements Windows-specific directory resolution for platformdirs library, providing standard application data/config/cache locations following Microsoft guidelines.

## Core Classes

**Windows (L16-141)**: Main class inheriting from `PlatformDirsABC`, implements all required directory properties for Windows platform using CSIDL (Common Shell Item ID List) constants.

### Key Directory Properties:
- `user_data_dir` (L28-36): Returns roaming/local AppData based on `self.roaming` flag
- `site_data_dir` (L54-57): System-wide ProgramData directory  
- `user_config_dir` (L60-62): Aliases to `user_data_dir` (Windows pattern)
- `user_cache_dir` (L70-76): Local AppData with optional "Cache" subfolder when opinionated
- `user_log_dir` (L90-96): Data dir with optional "Logs" subfolder when opinionated
- User media dirs (L99-126): Documents, Downloads, Pictures, Videos, Music, Desktop
- `user_runtime_dir` (L129-135): Temp directory within Local AppData

### Helper Method:
**_append_parts (L38-51)**: Constructs full paths by joining base path with appauthor/appname/version/opinion segments, with optional directory creation.

## Directory Resolution Strategy

**Three-tier fallback system** for obtaining Windows folders:

1. **get_win_folder_via_ctypes (L213-249)**: Primary method using Windows Shell32 API via ctypes
   - Maps CSIDL names to numeric constants (L221-231)
   - Handles Unicode buffer allocation and short path conversion
   - Special case for Downloads folder (combines CSIDL_PROFILE + "Downloads")

2. **get_win_folder_from_registry (L183-210)**: Registry-based fallback
   - Queries `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders`
   - Maps CSIDL names to registry key names (L191-200)

3. **get_win_folder_from_env_vars (L143-161)**: Environment variable fallback
   - Uses `get_win_folder_if_csidl_name_not_env_var` for user dirs (L164-180)
   - Maps CSIDL_APPDATA/COMMON_APPDATA/LOCAL_APPDATA to env vars (L149-153)

**Selection Logic (_pick_get_win_folder, L252-265)**: Chooses implementation based on available imports - prefers ctypes, falls back to registry, then env vars.

**get_win_folder (L268)**: LRU-cached function using selected implementation.

## Key Dependencies
- `os`, `sys` for path operations and platform detection
- `functools.lru_cache` for memoization
- `ctypes` (optional) for Windows API access
- `winreg` (optional) for registry access
- `.api.PlatformDirsABC` base class

## Architecture Notes
- Robust fallback chain ensures functionality across different Windows environments
- LRU caching optimizes repeated directory lookups
- Platform-specific imports are deferred and optional
- Follows Windows conventions (config=data, separate cache with opinion support)