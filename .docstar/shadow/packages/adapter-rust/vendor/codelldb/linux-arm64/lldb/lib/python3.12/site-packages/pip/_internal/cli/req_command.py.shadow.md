# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/req_command.py
@source-hash: 0ea78586650cb3aa
@generated: 2026-02-09T18:00:19Z

## Primary Purpose
Base class for pip CLI commands that work with package requirements and dependencies. Provides common infrastructure for requirement parsing, package finding, and dependency resolution while lazy-loading heavy machinery to optimize startup performance.

## Key Classes and Functions

### RequirementCommand (L78-329)
Abstract base class extending `IndexGroupCommand` that provides core requirement-handling functionality for pip commands like install, download, etc.

**Key Methods:**
- `determine_resolver_variant()` (L84-90): Static method to select between "legacy" or "resolvelib" resolver based on options
- `make_requirement_preparer()` (L92-145): Class method factory for `RequirementPreparer` instances with resolver-specific configuration
- `make_resolver()` (L147-204): Class method factory for resolver instances, dynamically importing appropriate resolver implementation
- `get_requirements()` (L206-290): Parses command-line args, constraint files, editable installs, and requirement files into `InstallRequirement` objects
- `trace_basic_info()` (L292-301): Static utility for logging package search locations
- `_build_package_finder()` (L303-329): Creates configured `PackageFinder` with link collection and selection preferences

### Utility Functions

#### with_cleanup decorator (L50-75)
Decorator that manages temporary directory cleanup based on `--no-clean` option and handles `PreviousBuildDirError` exceptions. Configures `TempDirectoryTypeRegistry` to preserve specific temp directory types when cleanup is disabled.

## Key Dependencies
- **Core Infrastructure**: `IndexGroupCommand`, `SessionCommandMixin`, `PackageFinder`, `LinkCollector`
- **Requirement Processing**: `InstallRequirement`, requirement constructors, `parse_requirements`
- **Resolution**: `BaseResolver`, dynamic imports for legacy vs resolvelib resolvers
- **Build System**: `RequirementPreparer`, `BuildTracker`, `WheelCache`
- **Temporary Management**: `TempDirectory`, `TempDirectoryTypeRegistry`

## Important Constants
`KEEPABLE_TEMPDIR_TYPES` (L43-47): Defines which temp directory types should be preserved when `--no-clean` is used (build environments, ephemeral wheel cache, requirement builds).

## Architectural Patterns
- **Lazy Loading**: Module docstring explains separation to avoid importing heavy PackageFinder machinery unless needed
- **Factory Methods**: Extensive use of class method factories for creating configured instances
- **Resolver Strategy Pattern**: Dynamic resolver selection and instantiation based on configuration
- **Decorator Pattern**: `with_cleanup` handles cross-cutting cleanup concerns
- **Command Pattern**: Base class for pip's requirement-processing commands

## Critical Constraints
- Resolver variant determination affects feature availability (fast-deps only works with resolvelib)
- Hash checking is automatically enabled if any requirement specifies hashes
- At least one requirement source must be provided (args, editables, or requirement files)
- Temporary directory cleanup behavior depends on error conditions and user options