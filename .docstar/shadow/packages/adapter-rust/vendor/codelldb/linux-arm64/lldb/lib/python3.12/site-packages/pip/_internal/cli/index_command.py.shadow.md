# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/index_command.py
@source-hash: 1a658bf36ce9cd2e
@generated: 2026-02-09T18:00:15Z

## Purpose
Base classes and utilities for pip CLI commands that interact with package indexes and require network access. Uses lazy imports to avoid loading network modules for commands that don't always need them.

## Key Components

### _create_truststore_ssl_context() (L27-42)
Creates SSL context using truststore for Python 3.10+. Returns None if ssl support missing or truststore unavailable. Raises CommandError for version incompatibility or import failures.

### SessionCommandMixin (L45-132)
Core mixin providing session management for network-enabled commands. Inherits from CommandContextMixIn.

**Key Methods:**
- `__init__()` (L50-52): Initializes with None session cache
- `_get_index_urls()` (L55-66): Extracts index URLs from command options, respects no_index flag
- `get_default_session()` (L68-76): Lazy session creation with context management and caching
- `_build_session()` (L78-132): Constructs PipSession with full configuration:
  - Cache directory setup (L87-88)
  - Truststore SSL context integration (L90-98)
  - Proxy configuration (L121-126)
  - Authentication settings (L128-130)
  - Timeout and retry handling (L102, L117-118)

### _pip_self_version_check() (L135-138)
Wrapper function for pip version checking functionality.

### IndexGroupCommand (L141-171)
Abstract base combining Command and SessionCommandMixin for commands supporting index group options and pip version checks.

**Key Method:**
- `handle_pip_version_check()` (L148-171): Performs version check with fallback SSL context, short timeout (5s max), and no retries

## Dependencies
- Uses lazy imports for PipSession (L22, L85) to avoid loading network stack unnecessarily
- Imports truststore conditionally (L38) for modern SSL support
- Relies on CommandContextMixIn for context management

## Architecture Patterns
- **Lazy Loading**: Network imports deferred until actual network access needed
- **Mixin Pattern**: SessionCommandMixin provides reusable session functionality
- **Context Management**: Sessions properly managed via enter_context()
- **Fallback Strategy**: Truststore with certifi fallback for SSL contexts

## Critical Constraints
- Truststore requires Python 3.10+ (L28-29)
- Cache directory must be absolute path (L88)
- Session caching prevents multiple session creation per command instance
- Version check limited to 5 second timeout with fallback SSL handling