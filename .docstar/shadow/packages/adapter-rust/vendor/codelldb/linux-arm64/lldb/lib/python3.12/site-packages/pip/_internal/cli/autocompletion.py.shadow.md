# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/autocompletion.py
@source-hash: 2e58b732be9a0cdb
@generated: 2026-02-09T18:00:11Z

This module implements bash shell autocompletion for pip commands. It powers the completion functionality installed via `pip completion`.

**Core Entry Point:**
- `autocomplete()` (L15-121): Main entry function that processes bash completion environment variables (`COMP_WORDS`, `COMP_CWORD`, `PIP_AUTO_COMPLETE`) and generates appropriate completion suggestions. Exits with code 1 after printing completions.

**Key Dependencies:**
- `create_main_parser()`: Provides pip's main command parser
- `commands_dict`, `create_command()`: Access to pip subcommands and their parsers
- `get_default_environment()`: For listing installed packages

**Completion Logic Flow:**
1. **Environment Validation** (L18-23): Checks for required bash completion environment variables
2. **Command Parsing** (L24-40): Extracts current word being completed and identifies active subcommand
3. **Subcommand-Specific Completion** (L42-103):
   - **Package Name Completion** (L47-64): For `show`/`uninstall` commands, suggests installed package names matching current input
   - **Path Completion** (L66-72): For `install` command, suggests filesystem paths
   - **Option Completion** (L74-103): Suggests command-line options, filtering out already-used options and appending "=" to options requiring arguments
4. **Main Parser Completion** (L104-120): When no subcommand detected, suggests main pip options or subcommand names

**Support Functions:**
- `get_path_completion_type()` (L124-145): Determines if the previous option expects file/directory/path completion by examining option metadata
- `auto_complete_paths()` (L148-176): Generates filesystem path completions based on completion type (file/dir/path), with proper case normalization and accessibility checks

**Architecture Patterns:**
- Uses optparse introspection to extract option metadata
- Implements context-aware completion based on command position and previous arguments
- Handles special cases for package management operations (install/show/uninstall)
- Filters suggestions based on partial input matching
- Always exits with code 1 after completion (bash completion convention)