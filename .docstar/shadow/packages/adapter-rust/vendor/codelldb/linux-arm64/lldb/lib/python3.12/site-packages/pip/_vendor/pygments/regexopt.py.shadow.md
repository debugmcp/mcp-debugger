# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/regexopt.py
@source-hash: 8e0d402e881c6065
@generated: 2026-02-09T18:00:50Z

## Purpose
Regex optimization module that generates efficient regular expressions for matching lists of literal strings. Uses algorithmic approaches like common prefix/suffix detection and character set optimization to minimize regex complexity.

## Key Components

### Constants (L18-19)
- `CS_ESCAPE`: Compiled regex pattern for escaping special charset characters `[\^\\\-\]]`
- `FIRST_ELEMENT`: itemgetter(0) utility for extracting first element from tuples

### Core Functions

**`make_charset(letters)` (L22-23)**
- Creates character class regex pattern `[...]` from letter collection
- Automatically escapes special regex characters using CS_ESCAPE pattern

**`regex_opt_inner(strings, open_paren)` (L26-79)**  
- Recursive optimization algorithm that processes sorted string list
- Optimization strategies applied in order:
  1. Single string: direct escape and wrap
  2. Empty first string: makes remainder optional with `?`
  3. Single-character strings: groups into character sets `[abc]`
  4. Common prefix: factors out shared beginnings
  5. Common suffix: factors out shared endings (via string reversal)
  6. First-character grouping: splits by initial character and recurses
- Uses non-capturing groups `(?:...)` for internal structure
- Returns regex string without compilation

**`regex_opt(strings, prefix='', suffix='')` (L82-91)**
- Public API function that wraps optimization process
- Sorts input strings for consistent processing
- Adds optional prefix/suffix to final pattern
- Returns optimized regex string ready for compilation

## Dependencies
- `re`: regex operations and escaping
- `os.path.commonprefix`: finds common string prefixes
- `itertools.groupby`: groups strings by shared characteristics  
- `operator.itemgetter`: tuple element extraction

## Architecture Notes
- Recursive divide-and-conquer approach prioritizes most effective optimizations first
- Character set optimization handles single-character strings efficiently
- Prefix/suffix detection reduces redundancy in pattern matching
- Non-capturing groups minimize regex overhead while maintaining structure