# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/network/auth.py
@source-hash: 891bb92c110c2bfd
@generated: 2026-02-09T18:00:28Z

## Purpose
Network authentication helper module for pip's HTTP requests, providing multi-domain credential management with support for keyring storage, netrc files, and interactive prompting.

## Core Components

**Credentials (L39-43)**: NamedTuple storing URL, username, and password triplets for credential management.

**KeyRingBaseProvider (L45-57)**: Abstract base class defining the keyring interface with methods `get_auth_info()` and `save_auth_info()`.

**KeyRing Implementations**:
- `KeyRingNullProvider (L59-69)`: Disabled keyring provider that returns None for all operations
- `KeyRingPythonProvider (L71-101)`: Uses locally imported `keyring` package, supports both `get_credential()` (keyring>=15.2.0) and fallback `get_password()` methods
- `KeyRingCliProvider (L103-160)`: Executes keyring CLI commands via subprocess, includes custom PATH manipulation to avoid using pip's own keyring installation

**get_keyring_provider (L162-222)**: Factory function with LRU cache that returns appropriate keyring provider based on configuration. Handles provider selection logic: "import"/"auto" tries Python keyring first, falls back to CLI on failure. Includes complex PATH manipulation (L184-214) to avoid circular keyring dependencies.

**MultiDomainBasicAuth (L224-562)**: Main authentication class inheriting from requests.AuthBase. Core request authentication handler with credential caching and multi-source credential resolution.

## Key Methods

**_get_new_credentials (L331-386)**: Credential resolution pipeline checking URL-embedded credentials → index URL credentials → netrc → keyring, in priority order.

**_get_index_url (L283-329)**: Matches request URLs to configured index URLs using netloc and path prefix matching with longest common path selection.

**__call__ (L436-450)**: Main request interceptor that extracts credentials, strips them from URL, applies HTTPBasicAuth, and registers 401 response handler.

**handle_401 (L476-537)**: Handles authentication failures by attempting keyring lookup, interactive prompting, credential caching, and request retry with new auth.

## Authentication Flow
1. Initial request: Extract/resolve credentials, apply auth headers
2. On 401: Query keyring → prompt user → cache credentials → retry request  
3. Success: Optionally save credentials to keyring if user consented

## Dependencies
- `requests` library for HTTP auth and models
- `keyring` package (optional) for credential storage
- `pip._internal.utils.misc` for user interaction utilities
- `pip._internal.vcs.versioncontrol.AuthInfo` type alias

## Configuration
- `prompting`: Enable interactive credential prompts
- `index_urls`: List of package index URLs for credential scope matching
- `keyring_provider`: Strategy for keyring usage ("auto", "import", "subprocess", "disabled")

## Global State
- `KEYRING_DISABLED`: Global flag to disable keyring on exceptions, cleared via `get_keyring_provider.cache_clear()`