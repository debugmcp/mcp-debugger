# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/html.py
@source-hash: 89ab919942bb2a70
@generated: 2026-02-09T17:58:01Z

## Purpose
HTML formatter for Pygments syntax highlighting library that converts tokenized source code into styled HTML output with various customization options including line numbers, CSS styling, and full document generation.

## Core Class
- **HtmlFormatter (L113-990)**: Main formatter class inheriting from `Formatter`, handles conversion of tokens to HTML with extensive configuration options for styling, line numbers, and document structure

## Key Methods

### Initialization & Setup
- **__init__ (L411-458)**: Processes 30+ options for styling, line numbers, CSS handling, ctags integration, and HTML structure
- **_create_stylesheet (L484-506)**: Builds internal token-to-CSS mappings from style definitions
- **_decodeifneeded (L609-614)**: Handles string/bytes encoding conversion

### CSS Generation
- **get_style_defs (L508-520)**: Returns complete CSS definitions for syntax highlighting
- **get_token_style_defs (L522-537)**: Generates CSS rules for token types
- **get_background_style_defs (L539-560)**: Creates background and highlight color CSS
- **get_linenos_style_defs (L562-571)**: Produces line number styling rules
- **get_css_prefix (L573-589)**: Builds CSS selector prefixes for scoped styling

### CSS Class/Style Helpers
- **_get_css_class (L460-466)**: Maps token types to CSS class names with prefix
- **_get_css_classes (L468-474)**: Builds hierarchical CSS class names for token inheritance
- **_get_css_inline_styles (L476-482)**: Retrieves inline styles for noclasses mode

### Core Formatting Pipeline
- **format_unencoded (L953-990)**: Main formatting entry point coordinating the wrapper pipeline
- **_format_lines (L831-907)**: Core tokenization-to-HTML conversion with span generation and ctags support
- **wrap (L938-951)**: Orchestrates wrapping generators (can be overridden for customization)

### Wrapping Generators (Pipeline Components)
- **_wrap_full (L616-655)**: Generates complete HTML document with head/body tags
- **_wrap_div (L790-802)**: Wraps content in styled div container
- **_wrap_pre (L804-819)**: Adds pre tag with optional filename display
- **_wrap_code (L821-824)**: Wraps in code tag (HTML5 semantic markup)
- **_wrap_tablelinenos (L657-722)**: Creates table-based line number layout
- **_wrap_inlinelinenos (L725-766)**: Embeds line numbers inline with code
- **_wrap_lineanchors (L768-778)**: Adds anchor tags for line linking
- **_wrap_linespans (L780-788)**: Wraps lines in span tags with IDs

### Highlighting & Processing
- **_highlight_lines (L916-936)**: Post-processes specific lines for highlighting based on hl_lines option
- **_lookup_ctag (L909-914)**: Resolves ctags entries for hyperlink generation
- **_translate_parts (L826-829)**: HTML-escapes content and splits by newlines (LRU cached)

## Utility Functions
- **escape_html (L38-40)**: HTML entity escaping using translation table
- **webify (L43-47)**: Converts colors to web format, handles CSS functions
- **_get_ttype_class (L50-59)**: Maps token types to standard CSS class names

## Key Configuration Options
- **linenos**: Controls line number display (none/inline/table)
- **noclasses**: Uses inline styles instead of CSS classes
- **nowrap**: Disables wrapper tags for minimal output  
- **full**: Generates complete HTML document
- **hl_lines**: Specifies lines to highlight
- **tagsfile**: Enables ctags-based hyperlinks
- **cssfile**: External CSS file generation

## Template Constants
- **CSSFILE_TEMPLATE (L62-69)**: CSS file wrapper template
- **DOC_HEADER (L71-90)**: Full document header with inline CSS
- **DOC_HEADER_EXTERNALCSS (L92-105)**: Document header with external CSS link
- **DOC_FOOTER (L107-110)**: Document closing tags

## Dependencies
- Imports from `pip._vendor.pygments` (formatter, token, util modules)
- Optional `ctags` module for hyperlink generation
- Standard library: functools, os, sys, io.StringIO

## Architecture Notes
- Uses generator-based pipeline for memory-efficient processing
- Implements caching for HTML escaping performance
- Supports extensive subclassing through wrap() method override
- Handles both CSS classes and inline styles modes
- Integrates with ctags for IDE-like navigation features