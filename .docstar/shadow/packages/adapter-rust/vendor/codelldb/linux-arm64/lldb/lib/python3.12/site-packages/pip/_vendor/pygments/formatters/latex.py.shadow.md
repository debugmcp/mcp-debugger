# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/latex.py
@source-hash: 146cc9f98a924c4f
@generated: 2026-02-09T17:57:54Z

**LaTeX Formatter for Pygments Code Highlighting**

This file implements a LaTeX formatter for Pygments that converts syntax-highlighted code into LaTeX format using the `fancyvrb` and `color` packages.

## Core Components

**Primary Classes:**
- `LatexFormatter` (L147-438): Main formatter class that converts tokens to LaTeX code with extensive styling options
- `LatexEmbeddedLexer` (L440-521): Specialized lexer for handling escaped LaTeX segments within formatted code

**Key Functions:**
- `escape_tex(text, commandprefix)` (L22-40): Escapes LaTeX special characters using placeholder sequences
- `_get_ttype_name(ttype)` (L135-144): Resolves token type names from STANDARD_TYPES mapping

## Template System

**LaTeX Templates:**
- `DOC_TEMPLATE` (L43-58): Complete LaTeX document template for standalone output
- `STYLE_TEMPLATE` (L98-132): Macro definitions for style commands and character escapes

The formatter uses a sophisticated macro system where `\PY{classes}{text}` commands are dynamically resolved to style definitions. The magic happens through LaTeX macros that parse class lists (L78-93 comments explain the intricate macro mechanics).

## Formatter Features

**LatexFormatter Configuration Options:**
- Document structure: `full`, `docclass`, `preamble`, `title` (L185-199)
- Code presentation: `nowrap`, `linenos`, `verboptions`, `envname` (L176-250)
- Text handling: `texcomments`, `mathescape`, `escapeinside` (L222-243)
- Styling: `commandprefix`, `nobackground` (L214-226)

**Core Formatting Logic:**
- `__init__` (L256-277): Initializes all configuration options
- `_create_stylesheet` (L279-322): Builds style-to-LaTeX-command mappings from Pygments styles
- `get_style_defs` (L324-334): Generates LaTeX macro definitions for styles
- `format_unencoded` (L336-437): Main formatting logic with special handling for comments, math, and escape sequences

## Embedded Lexer System

**LatexEmbeddedLexer Methods:**
- `get_tokens_unprocessed` (L457-474): Processes text while preserving escaped segments
- `_find_safe_escape_tokens` (L476-486): Identifies escape tokens outside strings/comments
- `_filter_to` (L488-503): Utility for selective token filtering
- `_find_escape_tokens` (L505-521): Locates escape delimiters within text

## Dependencies

Imports from `pip._vendor.pygments`: `Formatter`, `Lexer`, `do_insertions`, `Token`, `STANDARD_TYPES`, utility functions for option parsing.

## Architecture Notes

The formatter implements a two-pass approach: first generating style definitions, then applying them during token processing. The escape handling is particularly sophisticated, supporting LaTeX math mode, custom delimiters, and comment processing with different escape rules.