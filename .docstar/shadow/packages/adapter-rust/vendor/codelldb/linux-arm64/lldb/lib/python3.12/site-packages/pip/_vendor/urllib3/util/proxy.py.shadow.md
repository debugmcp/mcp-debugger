# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/proxy.py
@source-hash: cd4bcf3c226ba7a7
@generated: 2026-02-09T17:57:49Z

## Purpose
Utility module for proxy connection handling in urllib3, specifically determining when HTTP tunneling is required and creating SSL contexts for proxy connections.

## Key Functions

### connection_requires_http_tunnel (L4-34)
Core logic function that determines whether an HTTP CONNECT tunnel is needed through a proxy server.

**Parameters:**
- `proxy_url`: URL object representing the proxy server
- `proxy_config`: ProxyConfig object from poolmanager.py with forwarding settings
- `destination_scheme`: Target protocol scheme (http, https, etc.)

**Logic Flow:**
- Returns `False` if no proxy is configured (L18-19)
- Returns `False` for HTTP destinations (always uses forwarding) (L22-23)
- Returns `False` for HTTPS proxies when `use_forwarding_for_https` is enabled (L26-31)
- Returns `True` for all other cases (requires tunneling) (L34)

### create_proxy_ssl_context (L37-56)
Factory function for generating SSL contexts specifically for proxy connections.

**Parameters:**
- `ssl_version`: SSL/TLS version specification
- `cert_reqs`: Certificate requirement level
- `ca_certs`: Path to CA certificate file (optional)
- `ca_cert_dir`: Directory containing CA certificates (optional)
- `ca_cert_data`: Raw CA certificate data (optional)

**Behavior:**
- Creates urllib3 SSL context with resolved SSL version and cert requirements (L44-47)
- Auto-loads default system certificates if no custom CA data provided and context supports it (L49-55)

## Dependencies
- `.ssl_`: Imports SSL utility functions for context creation and parameter resolution (L1)

## Architectural Notes
- Implements proxy tunneling decision logic based on scheme combinations and configuration flags
- Separates SSL context creation for proxy connections from general SSL handling
- Follows urllib3's pattern of resolving/normalizing SSL parameters before context creation