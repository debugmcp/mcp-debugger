# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/cachecontrol/caches/
@generated: 2026-02-09T18:16:09Z

## Overview
The `caches` directory provides pluggable cache backend implementations for pip's HTTP caching system. It contains multiple storage strategies (file-based and Redis) that implement a common cache interface, allowing pip to persist HTTP responses across requests for improved performance.

## Architecture and Components

### Core Cache Implementations
- **FileCache**: Traditional file-based cache that stores complete HTTP responses as single files on disk
- **SeparateBodyFileCache**: Memory-efficient file cache that separates response headers from bodies, storing bodies in separate `.body` files
- **RedisCache**: Distributed cache backend using Redis server for shared caching across multiple pip instances

### Key Design Patterns
- **Adapter Pattern**: All cache classes implement the `BaseCache` interface, providing uniform API regardless of storage backend
- **Mixin Architecture**: `_FileCacheMixin` provides shared file operations, extended by specific file cache implementations
- **Security-First Design**: File operations include protection against symlink attacks, race conditions, and unauthorized access

## Public API Surface

### Main Entry Points (`__init__.py`)
```python
from pip._vendor.cachecontrol.caches import FileCache, SeparateBodyFileCache, RedisCache
```

### Common Cache Interface
- `get(key)`: Retrieve cached data by key
- `set(key, value, expires=None)`: Store data with optional expiration
- `delete(key)`: Remove specific cache entry
- `clear()`: Remove all cached data (Redis only)

### Specialized APIs
- **SeparateBodyFileCache**: Additional `get_body()` and `set_body()` methods for streaming large response bodies
- **RedisCache**: Timezone-aware expiration handling for datetime objects

## Internal Organization

### File Cache Architecture
- **Hash-based Distribution**: Uses SHA224 hashing to create hierarchical directory structures, preventing filesystem bottlenecks
- **Thread-Safe Operations**: All file operations protected by `filelock` for concurrent access
- **Atomic Writes**: Uses `_secure_open_write()` with exclusive creation flags to prevent corruption
- **Configurable Security**: File permissions (default 0o0600) and `forever` flag for persistent caching

### Data Flow
1. Cache keys are hashed and converted to hierarchical file paths
2. HTTP responses are serialized and stored using secure write operations
3. Retrieval involves path reconstruction and safe file reading
4. Cleanup respects the `forever` flag and handles both main files and body files

## Key Dependencies
- **filelock**: Required for thread-safe file operations in file caches
- **redis**: Optional dependency for Redis cache backend
- **pip._vendor.cachecontrol.cache**: Base interfaces and abstract classes
- **pip._vendor.cachecontrol.controller**: Cache URL processing utilities

## Integration Points
- Integrates with pip's HTTP client through the cachecontrol library
- Cache selection typically done at configuration time based on available dependencies and deployment requirements
- File caches suitable for single-user installations, Redis cache for distributed deployments