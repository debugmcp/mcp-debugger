# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/connection.py
@source-hash: f7693db5dff2e0f1
@generated: 2026-02-09T18:01:13Z

## HTTP/HTTPS Connection Classes for urllib3

Primary HTTP and HTTPS connection wrapper classes that extend Python's standard library implementations with enhanced security, proxy support, and connection management.

### Core Components

**HTTPConnection (L76-284)**: Extended HTTP connection class inheriting from `http.client.HTTPConnection`
- Adds backwards compatibility between Python versions
- Implements FQDN hostname handling with `host` property (L133-160) that strips trailing dots for SSL certificate validation while preserving DNS resolution capabilities
- Connection establishment via `_new_conn()` (L161-190) with timeout and error handling
- Socket preparation in `_prepare_conn()` (L196-202) with tunnel support
- Enhanced request methods `putrequest()` (L208-219) with control character validation and `putheader()` (L221-229) with header skipping support
- Chunked transfer encoding support in `request_chunked()` (L246-283)

**HTTPSConnection (L286-533)**: SSL/TLS-enabled connection class extending HTTPConnection
- SSL certificate and context management via `set_cert()` (L328-359)
- Complex connection establishment in `connect()` (L361-477) handling:
  - TLS-in-TLS proxy connections
  - System time validation against `RECENT_DATE` (L71)
  - SSL context creation and certificate verification
  - Hostname matching with fallback warnings for missing subjectAltName
- Proxy TLS connection handling in `_connect_tls_proxy()` (L479-533)

### Key Dependencies

- `ssl` module with fallback handling (L17-25)
- Custom SSL utilities from `.util.ssl_` for context creation and socket wrapping
- Connection utilities from `.util.connection`
- Exception types from `.exceptions`

### Security Features

- Certificate fingerprint assertion
- Hostname verification with IP address normalization in `_match_hostname()` (L536-555)
- SSL context management with default certificate loading
- TLS version deprecation warnings
- Control character validation in HTTP methods

### Configuration

- `default_socket_options` (L106): TCP_NODELAY enabled by default
- `port_by_scheme` (L67): Standard port mappings
- Connection verification state tracking via `is_verified` and `proxy_is_verified` attributes

### Utility Functions

- `_get_default_user_agent()` (L558-559): Returns urllib3 version string
- `DummyConnection` (L562-565): Fallback class when SSL unavailable