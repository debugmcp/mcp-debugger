# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/truststore/_openssl.py
@source-hash: 2cb519ed919a8a8f
@generated: 2026-02-09T18:01:01Z

## Purpose
OpenSSL-based certificate verification implementation for the truststore library. Configures SSL contexts to use system certificate stores by searching common CA certificate file locations across different Linux distributions.

## Key Components

### Constants
- `_CA_FILE_CANDIDATES` (L8-17): List of common CA certificate file paths for different Linux distributions (Alpine, Arch, Fedora, RHEL, Debian, Ubuntu, SUSE)
- `_HASHED_CERT_FILENAME_RE` (L19): Regex pattern to identify OpenSSL hashed certificate filenames (8 hex chars + dot + digit)

### Core Functions
- `_configure_context()` (L22-46): Context manager that configures SSL context with system CA certificates. First tries OpenSSL defaults via `ssl.get_default_verify_paths()`, then falls back to searching `_CA_FILE_CANDIDATES` if defaults are unavailable
- `_capath_contains_certs()` (L49-56): Helper function that validates if a certificate directory exists and contains properly formatted certificate files
- `_verify_peercerts_impl()` (L59-66): No-op implementation that relies on SSLContext's built-in verification (CERT_REQUIRED mode)

## Architecture Patterns
- **Fallback Strategy**: Primary reliance on OpenSSL's default paths with systematic fallback to distribution-specific locations
- **Environment Awareness**: Respects SSL_CERT_FILE and SSL_CERT_DIR environment variables through `ssl.get_default_verify_paths()`
- **Cross-Platform Support**: Handles certificate location variations across major Linux distributions

## Dependencies
- `ssl`: Python SSL module for context configuration and default path detection
- `os`: File system operations for path validation
- `contextlib`: Context manager implementation
- `re`: Regular expression matching for certificate filename validation

## Critical Behavior
The context manager modifies the SSL context in-place and yields control, allowing the configured context to be used for SSL connections. The verification implementation delegates entirely to SSLContext's built-in mechanisms rather than implementing custom certificate chain validation.