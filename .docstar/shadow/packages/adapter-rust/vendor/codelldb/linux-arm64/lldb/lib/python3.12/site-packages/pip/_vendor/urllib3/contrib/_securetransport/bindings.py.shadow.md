# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/_securetransport/bindings.py
@source-hash: e1793ae2a2243c1b
@generated: 2026-02-09T17:57:06Z

## Primary Purpose
Low-level ctypes bindings for Apple's SecureTransport and CoreFoundation frameworks on macOS. Provides Python access to SSL/TLS cryptographic functions, certificate handling, and security operations. This is a platform-specific adapter layer for urllib3's SSL implementation on macOS.

## Platform Requirements & Validation
- **macOS-only**: Strict platform check raises ImportError on non-Darwin systems (L53-54)
- **Version constraint**: Requires macOS 10.8+ with version validation (L56-62)
- **Library loading**: Custom CDLL loader `load_cdll()` (L65-78) handles Big Sur (10.16+) path fallback

## Core Framework Bindings

### Security Framework (L81-318)
- **Primary library**: Security.framework loaded via `load_cdll()` (L81-83)
- **Certificate operations**: SecItemImport, SecCertificateCreateWithData, SecCertificateCopyData (L136-161)
- **SSL context management**: SSLCreateContext, SSLSetProtocolVersionMin/Max, SSLHandshake (L282-296)
- **I/O functions**: SSLRead, SSLWrite with callback function types SSLReadFunc/SSLWriteFunc (L193-223)
- **Trust evaluation**: SecTrustEvaluate, SecTrustSetAnchorCertificates (L267-280)
- **PKCS12 import**: SecPKCS12Import for certificate/key bundles (L186-191)
- **ALPN support**: SSLSetALPNProtocols with graceful AttributeError handling for pre-10.12 (L298-303)

### CoreFoundation Framework (L84-418)
- **Primary library**: CoreFoundation.framework (L84-87)
- **Memory management**: CFRetain, CFRelease for reference counting (L328-332)
- **Data structures**: CFString, CFArray, CFDictionary creation/manipulation (L337-399)
- **Constants**: Default allocator and callback structures (L401-412)

## Type System
Comprehensive ctypes type definitions (L90-133):
- **Basic types**: Boolean, CFIndex, OSStatus, etc.
- **Reference types**: All framework objects as POINTER(c_void_p) variants
- **Function signatures**: Complete argtypes/restype specifications for all bound functions

## Constants Classes

### CFConst (L423-430)
Namespace for CoreFoundation constants, currently only UTF-8 encoding.

### SecurityConst (L432-519)
Extensive SSL/TLS and Security constants including:
- **Protocol versions**: SSL 2/3, TLS 1.0-1.3 (L439-446)
- **Trust result codes**: Certificate validation outcomes (L453-461)  
- **Error codes**: SSL/TLS error conditions (L463-486)
- **Cipher suites**: Modern TLS cipher suite constants (L488-519)

## Architecture Notes
- **Error handling**: Comprehensive try/catch around all function binding with fallback ImportError (L135, L419-420)
- **Fallback compatibility**: Graceful handling of missing functions in older macOS versions
- **Reference management**: Proper ctypes pointer handling for C interop
- **Namespace organization**: Clean separation between Security and CoreFoundation APIs