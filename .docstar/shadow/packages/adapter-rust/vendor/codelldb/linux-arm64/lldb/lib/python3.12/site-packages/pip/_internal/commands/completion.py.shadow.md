# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/commands/completion.py
@source-hash: 1d3e250f46e0b1f9
@generated: 2026-02-09T18:00:14Z

## Purpose
Implements pip's shell completion command that generates auto-completion scripts for various shells. Part of pip's internal CLI infrastructure to help users get command completion in their terminal environments.

## Key Components

**CompletionCommand Class (L75-130)**
- Inherits from Command base class (L6)
- Main command handler with `ignore_require_venv = True` (L78) to work in any environment
- `add_options()` method (L80-114) registers shell-specific flags (--bash/-b, --zsh/-z, --fish/-f, --powershell/-p)
- `run()` method (L116-130) validates shell selection and outputs formatted completion script

**Completion Scripts Dictionary (L14-72)**
- Maps shell names to their respective completion script templates
- **bash** (L15-23): Uses COMPREPLY and complete builtin with _pip_completion function
- **zsh** (L24-38): Uses compdef with __pip function, handles autoload vs direct eval contexts
- **fish** (L39-49): Implements __fish_complete_pip with commandline parsing
- **powershell** (L50-71): Complex TabExpansion function override with backup mechanism

**Constants**
- `BASE_COMPLETION` (L10-12): Template wrapper for script output with shell-specific markers
- Uses `get_prog()` utility (L8) to get current program name for script customization

## Key Dependencies
- `pip._internal.cli.base_command.Command`: Base command class
- `pip._internal.cli.status_codes.SUCCESS`: Return code constant
- `pip._internal.utils.misc.get_prog`: Gets executable name for script templates

## Architecture Notes
- All completion scripts rely on `PIP_AUTO_COMPLETE=1` environment variable to trigger completion mode
- Scripts use `COMP_WORDS` and `COMP_CWORD` environment variables following bash completion conventions
- PowerShell implementation preserves existing TabExpansion by backing it up before override
- Command always returns SUCCESS (L125, L130) regardless of validation outcome - errors only print to stderr