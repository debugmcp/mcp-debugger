# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/_elffile.py
@source-hash: fcb7095b860d2b2c
@generated: 2026-02-09T18:00:35Z

**Purpose**: ELF (Executable and Linkable Format) file parser for extracting binary metadata, specifically designed to read ELF executables with a ZipFile-like interface. Only implements read functionality.

**Core Class**:
- `ELFFile` (L41-110): Main parser class that validates ELF magic bytes, extracts header information, and provides interpreter path lookup

**Key Enums**:
- `EIClass` (L23-25): Defines bitness (32-bit=1, 64-bit=2)  
- `EIData` (L28-30): Defines endianness (LSB=1, MSB=2)
- `EMachine` (L33-38): Architecture types (i386, ARM, x86_64, AArch64, S390)

**Exception**:
- `ELFInvalid` (L19-20): Custom ValueError for malformed ELF files

**ELFFile Key Methods**:
- `__init__` (L46-90): Validates ELF magic signature (`\x7fELF`), parses identification header, determines format strings for struct unpacking based on bitness/endianness combination, extracts machine type and program header metadata
- `_read` (L92-93): Helper for struct unpacking from file stream
- `interpreter` property (L96-109): Locates PT_INTERP section to extract dynamic linker path

**Critical Implementation Details**:
- Format string lookup table (L64-68): Maps (bitness, endianness) tuples to struct format strings and field indexes for 32/64-bit LSB/MSB variants
- Program header parsing uses calculated offsets (`_e_phoff`, `_e_phentsize`, `_e_phnum`) to iterate through sections
- PT_INTERP detection via type field comparison (value 3) at calculated index positions
- Null-terminated string handling in interpreter path extraction

**Dependencies**: `struct` for binary parsing, `os` for filesystem decoding, `enum` for constants, `typing` for type hints

**Architecture**: Read-only parser following the ELF specification, designed for metadata extraction rather than full ELF manipulation.