# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/requests/auth.py
@source-hash: 905ef9b6a9cb72d6
@generated: 2026-02-09T18:00:51Z

## Authentication Module for HTTP Requests

This module provides authentication handlers for the Python requests library, implementing HTTP Basic, Proxy, and Digest authentication mechanisms.

### Core Components

**AuthBase (L69-73)**: Abstract base class defining the authentication interface. All auth implementations must inherit from this and implement `__call__` to modify request objects.

**HTTPBasicAuth (L76-96)**: Implements HTTP Basic Authentication using username/password credentials. Adds `Authorization` header with base64-encoded credentials via `_basic_auth_str` helper.

**HTTPProxyAuth (L99-104)**: Inherits from HTTPBasicAuth but sets `Proxy-Authorization` header instead for proxy authentication.

**HTTPDigestAuth (L107-314)**: Complex digest authentication implementation with thread-local state management. Key methods:
- `init_per_thread_state` (L116-124): Initializes per-thread authentication state
- `build_digest_header` (L126-234): Constructs digest authentication header supporting MD5, SHA, SHA-256, SHA-512 algorithms
- `handle_401` (L241-283): Processes 401 responses, performs digest challenge-response handshake
- `handle_redirect` (L236-239): Resets authentication state on redirects

### Key Functions

**_basic_auth_str (L25-66)**: Utility function creating Basic Auth header string. Includes backwards compatibility warnings for non-string credentials (deprecated in v3.0.0).

### Dependencies & Architecture

- Uses `threading.local()` for thread-safe state in digest auth
- Imports crypto functions from `hashlib` for digest computation  
- Relies on `requests` internal utilities: `parse_dict_header`, `extract_cookies_to_jar`, `to_native_string`
- URL parsing via `compat.urlparse`

### Authentication Flow

1. Auth objects are callable, modifying request objects before sending
2. Digest auth registers response hooks to handle 401 challenges
3. State management ensures proper nonce tracking and replay protection
4. Connection reuse optimizations for digest auth sequences

### Constants

- `CONTENT_TYPE_FORM_URLENCODED` / `CONTENT_TYPE_MULTI_PART` (L21-22): Content type definitions (unused in this file)

### Thread Safety

Digest authentication uses `threading.local()` storage to maintain separate state per thread, preventing race conditions in concurrent scenarios.