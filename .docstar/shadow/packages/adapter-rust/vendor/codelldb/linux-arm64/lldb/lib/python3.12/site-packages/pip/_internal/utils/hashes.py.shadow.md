# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/utils/hashes.py
@source-hash: 68b8409435de100f
@generated: 2026-02-09T18:00:36Z

## Primary Purpose
Hash verification utility for pip's package integrity checking. Provides classes to manage multiple hash algorithms, verify file/data integrity against known-good hashes, and handle missing hash scenarios.

## Key Constants
- `FAVORITE_HASH` (L13): Default hash algorithm "sha256" used when specific algorithm isn't specified
- `STRONG_HASHES` (L18): List of collision-resistant algorithms ["sha256", "sha384", "sha512"] allowed by pip

## Core Classes

### Hashes (L21-130)
Main hash verification class that manages multiple hash algorithms and validates data integrity.

**Key Methods:**
- `__init__(hashes)` (L27-37): Accepts dict of algorithm names to lists of allowed hex digests, sorts values for consistency
- `__and__(other)` (L39-56): Intersection operator for combining hash requirements; returns union if either is empty, otherwise intersection
- `digest_count` (L58-60): Property returning total number of allowed digests across all algorithms
- `is_hash_allowed(hash_name, hex_digest)` (L62-64): Checks if specific hash digest is in allowed list for algorithm
- `check_against_chunks(chunks)` (L66-87): Core verification method that computes hashes for data chunks and validates against allowed values
- `check_against_file(file)` (L92-98): Convenience wrapper for file-like objects using `read_chunks`
- `check_against_path(path)` (L100-102): Convenience wrapper for file paths
- `has_one_of(hashes)` (L104-109): Returns True if any provided hash is in allowed set
- `_raise(gots)` (L89-90): Helper to raise HashMismatch with computed vs expected hashes

**Special Methods:**
- `__bool__` (L111-113): Returns True if any hashes are configured
- `__eq__` (L115-118): Equality based on `_allowed` dict comparison
- `__hash__` (L120-129): Hash based on sorted string representation of all algorithm:digest pairs

### MissingHashes (L132-147)
Specialized subclass for handling missing hash requirements during package installation.

**Key Methods:**
- `__init__()` (L140-144): Initializes with empty list for FAVORITE_HASH, ensuring validation always fails
- `_raise(gots)` (L146-147): Overrides parent to raise HashMissing with computed hash instead of HashMismatch

## Dependencies
- `hashlib`: Standard library for hash computations
- `pip._internal.exceptions`: Custom exceptions (HashMismatch, HashMissing, InstallationError)
- `pip._internal.utils.misc.read_chunks`: Utility for reading files in chunks

## Architecture Patterns
- **Strategy Pattern**: Multiple hash algorithms handled uniformly through hashlib interface
- **Template Method**: `check_against_*` methods use common `check_against_chunks` implementation
- **Null Object Pattern**: MissingHashes provides same interface but different failure behavior
- **Immutable Design**: Hash objects are effectively immutable after construction (sorted values, no mutation methods)

## Critical Invariants
- Hash digests are always stored sorted within each algorithm's list for consistent equality/hashing
- Empty Hashes objects in intersection operations result in the non-empty operand (permissive behavior)
- Validation fails fast on first matching hash (early return in check_against_chunks L86)
- Unknown hash algorithms raise InstallationError during validation, not construction