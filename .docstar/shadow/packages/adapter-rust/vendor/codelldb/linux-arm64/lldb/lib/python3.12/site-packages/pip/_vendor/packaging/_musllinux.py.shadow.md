# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/_musllinux.py
@source-hash: a7d66a35888e22d1
@generated: 2026-02-09T18:00:34Z

**Purpose:** Implements PEP 656 support for detecting musl libc usage and generating musllinux platform tags for Python package distribution compatibility.

**Key Components:**

- `_MuslVersion` (L18-21): NamedTuple storing major/minor version components of musl libc
- `_parse_musl_version()` (L23-30): Parses musl version output string using regex pattern `r"Version (\d+)\.(\d+)"` on second line after "musl" prefix validation
- `_get_musl_version()` (L33-53): Core detection function using ELF file analysis and subprocess execution:
  - Opens executable as ELF file to extract dynamic linker interpreter path
  - Checks if interpreter path contains "musl" 
  - Executes the musl loader directly to get version info from stderr
  - Returns None if Python not linked against musl or detection fails
  - Uses `@functools.lru_cache` for performance optimization
- `platform_tags()` (L56-72): Generates compatible musllinux platform tags by iterating through architecture sequence and musl minor versions in descending order

**Dependencies:**
- `._elffile.ELFFile`: Custom ELF file parser for extracting dynamic linker information
- Standard library: `subprocess`, `re`, `sys`, `functools`

**Architecture Pattern:**
Follows a detection-then-generation pattern: first detect musl version through ELF analysis and subprocess invocation, then generate backward-compatible platform tags for package distribution.

**Critical Invariants:**
- Only generates tags if musl is detected (returns empty iterator otherwise)
- Platform tags use format `musllinux_{major}_{minor}_{arch}`
- Minor version compatibility is backward-compatible (generates tags for current minor version down to 0)
- Requires "linux-" platform prerequisite for musllinux compatibility

**Error Handling:**
Graceful degradation with None returns on OSError, TypeError, ValueError during ELF parsing or subprocess execution failures.