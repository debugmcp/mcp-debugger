# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/certifi/core.py
@source-hash: d92453e6b21c4028
@generated: 2026-02-09T18:00:34Z

**Primary Purpose:**
Provides cross-Python-version access to the `cacert.pem` certificate bundle file, supporting both file path retrieval and direct content reading. Handles packaging scenarios (zipimport, PyOxidizer) through version-specific importlib.resources implementations.

**Architecture:**
Uses Python version branching (L14, L49, L85) to provide three distinct implementations:
- Python 3.11+: Modern `importlib.resources.files()` API
- Python 3.7-3.10: Legacy `importlib.resources.path()` API  
- Python <3.7: Fallback filesystem-based approach

**Key Functions:**

**`where() -> str`** (L21-44, L56-80, L108-111):
Returns filesystem path to `cacert.pem`. Uses lazy initialization with global caching (`_CACERT_PATH`, `_CACERT_CTX`) to avoid repeated resource extraction. For Python 3.7+, manages context manager lifecycle with `atexit` cleanup registration.

**`contents() -> str`** (L46-47, L82-83, L113-114):
Returns raw ASCII content of `cacert.pem` file. Implementation varies by Python version but consistently reads from `pip._vendor.certifi` package.

**`exit_cacert_ctx() -> None`** (L10-11):
Cleanup helper for context manager exit, registered with `atexit` to ensure proper resource cleanup.

**Critical State Management:**
- `_CACERT_CTX`: Global context manager reference (prevents premature garbage collection)
- `_CACERT_PATH`: Cached file path (avoids re-extraction on repeated calls)
- Both initialized to `None` and populated lazily on first `where()` call

**Dependencies:**
- `importlib.resources` (Python 3.7+)
- `atexit` for cleanup registration
- `os` for filesystem operations (fallback)

**Resource Location:**
All implementations target `cacert.pem` within the `pip._vendor.certifi` package namespace.

**Deployment Considerations:**
Designed to handle packaged Python applications where `__file__` may not be available or resources are embedded in archives. The lazy initialization pattern optimizes for scenarios where certificate path may never be requested.