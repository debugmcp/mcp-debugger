# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/utils/encoding.py
@source-hash: aaab170ed8b03088
@generated: 2026-02-09T18:00:25Z

## Purpose
Provides encoding detection and automatic decoding utilities for pip's internal operations, specifically handling byte strings with various Unicode encodings and BOM markers.

## Key Components

**BOMS constant (L7-15)**: List of byte order mark (BOM) tuples mapping BOM bytes to their corresponding encoding names. Supports UTF-8, UTF-16 (BE/LE), and UTF-32 (BE/LE) variants.

**ENCODING_RE pattern (L17)**: Compiled regex pattern `rb"coding[:=]\s*([-\w.]+)"` for detecting PEP 263 encoding declarations in Python source files (matches `# coding: utf-8` style declarations).

**auto_decode() function (L20-36)**: Primary encoding detection and decoding function that:
1. First checks for BOM markers at start of byte string (L24-26)
2. Falls back to PEP 263 encoding detection by scanning first two lines for `# coding:` declarations (L28-33)
3. Final fallback to system locale encoding or default encoding (L34-36)

## Dependencies
- `codecs`: For BOM constants and encoding operations
- `locale`: For system preferred encoding detection
- `re`: For regex-based encoding declaration parsing
- `sys`: For default encoding fallback

## Patterns
- Multi-tier encoding detection strategy (BOM → PEP263 → locale)
- Defensive programming with assertion for regex match result (L31)
- Graceful fallback chain ensuring decoding never fails