# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/commands/list.py
@source-hash: 46068857890df9e3
@generated: 2026-02-09T18:00:23Z

## Purpose
Implements pip's `list` command for displaying installed packages with various filtering and formatting options. Part of pip's internal command system for package management operations.

## Core Classes & Functions

### ListCommand (L38-311)
Main command class extending IndexGroupCommand. Handles listing installed packages with multiple output formats and filtering capabilities.

**Key Methods:**
- `add_options()` (L49-135): Configures command-line options including --outdated, --uptodate, --editable, --local, --user, --format, --not-required, and exclusion options
- `run()` (L164-203): Main execution logic with option validation, package collection, filtering, and output
- `get_outdated()` (L205-212): Filters packages with newer versions available
- `get_uptodate()` (L214-221): Filters packages that are current
- `get_not_required()` (L223-235): Finds packages that aren't dependencies of other packages
- `iter_packages_latest_infos()` (L237-273): Fetches latest version info from package indexes
- `output_package_listing()` (L275-294): Routes to appropriate output formatter based on format option

### Type Definitions (L22-32)
- `_DistWithLatestInfo`: TYPE_CHECKING class extending BaseDistribution with latest_version and latest_filetype fields
- `_ProcessedDists`: Type alias for sequences of enhanced distributions

### Formatting Functions
- `format_for_columns()` (L313-355): Prepares tabular data with dynamic headers based on options and package properties
- `format_for_json()` (L358-375): Converts package data to JSON format with conditional field inclusion

## Key Dependencies
- `pip._internal.metadata.get_environment()`: Package discovery and enumeration
- `pip._internal.index.package_finder.PackageFinder`: Remote package version lookup
- `pip._vendor.packaging`: Name canonicalization and version comparison
- `pip._internal.utils.misc.tabulate()`: Table formatting for columnar output

## Architecture Patterns
- Command pattern: Inherits from IndexGroupCommand for consistent CLI behavior
- Lazy imports: Heavy index modules imported only when needed for performance
- Type enhancement: Uses cast() to add runtime attributes to distribution objects
- Generator pattern: `iter_packages_latest_infos()` yields results for memory efficiency

## Critical Logic
- **Option conflicts**: Validates mutually exclusive options (outdated+uptodate, outdated+freeze format)
- **Dependency ordering**: `get_not_required()` must run before other filters to correctly identify dependencies
- **Version comparison**: Uses packaging.version.Version for semantic version comparisons
- **Prerelease handling**: Configurable inclusion/exclusion of prereleases via --pre option
- **Package discovery**: Respects virtualenv boundaries, user-site isolation, and path restrictions

## Output Formats
1. **columns**: Tabular format with dynamic headers (default)
2. **freeze**: Requirements.txt compatible format 
3. **json**: Machine-readable structured data

## Performance Considerations
- Lazy import of index modules reduces startup time for simple listings
- Generator-based latest info fetching for memory efficiency
- Package finder creation deferred until needed for remote operations