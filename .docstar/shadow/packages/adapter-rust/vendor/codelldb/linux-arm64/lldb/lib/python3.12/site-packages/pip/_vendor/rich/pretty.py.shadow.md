# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/pretty.py
@source-hash: e682073ff0865a71
@generated: 2026-02-09T18:01:10Z

This module provides pretty-printing functionality for Python objects in the Rich library, automatically formatting complex data structures with intelligent width-aware expansion and syntax highlighting.

## Primary Purpose
Core pretty-printing engine that converts Python objects into aesthetically formatted representations with automatic indentation, width management, and color highlighting. Handles container expansion, recursive structures, and special object types like dataclasses, namedtuples, and attrs objects.

## Key Classes

### Pretty (L244-346)
Main renderable class that wraps any Python object for pretty-printing. Implements `__rich_console__` and `__rich_measure__` protocols.
- **Constructor parameters**: object, highlighter, indent_size, overflow settings, max limits
- **Core rendering**: Delegates to `pretty_repr()` function, applies highlighting and formatting
- **Width calculation**: Measures rendered output for console layout

### Node (L389-472) 
Tree structure representing the hierarchical breakdown of an object for rendering.
- **Structure**: Contains key_repr, value_repr, braces, children, separators
- **Token generation**: `iter_tokens()` (L405) yields string fragments for rendering
- **Length checking**: `check_length()` (L427) validates if content fits within width limits
- **Rendering**: `render()` (L448) expands tree into multi-line formatted string

### _Line (L474-540)
Internal representation of a single line in the pretty-printed output.
- **Expansion logic**: `expand()` (L500) converts container nodes into multi-line format
- **Length validation**: Checks if line content fits within specified width

## Key Functions

### traverse() (L561-854)
**Core algorithm** that recursively walks object structure and builds Node tree.
- **Recursion detection**: Tracks visited object IDs to handle circular references (L598-600)
- **Special type handling**: dataclasses (L744), attrs objects (L695), namedtuples (L774), containers (L798)
- **Rich repr support**: Handles objects with `__rich_repr__` method (L637-694)
- **Depth/length limits**: Respects max_depth and max_length constraints

### pretty_repr() (L857-894)
Main entry point that combines traverse() and Node.render() to produce formatted string representation.

### install() (L164-242)
Sets up automatic pretty-printing in Python REPL and Jupyter environments.
- **REPL integration**: Replaces `sys.displayhook` 
- **Jupyter support**: Custom formatter for IPython display system (L221-241)

## Utility Functions

### Container detection and formatting:
- `is_expandable()` (L379): Identifies objects that can be expanded into multi-line format
- `_BRACES` (L360): Mapping of container types to their bracket styles
- `_get_braces_for_*()` (L348, L356): Specialized bracket formatting for defaultdict and array

### Type checking utilities:
- `_safe_isinstance()` (L154): Defensive isinstance() that catches exceptions
- `_is_namedtuple()` (L542): Heuristic namedtuple detection
- `_is_dataclass_repr()` (L68): Checks if dataclass uses default repr
- `_has_default_namedtuple_repr()` (L88): Verifies namedtuple has default repr

## Important Dependencies
- **Rich core**: Console, Text, Measurement, highlighter system
- **Standard library**: dataclasses, inspect, collections for type introspection
- **Optional**: attrs module support with graceful degradation

## Architecture Patterns
- **Visitor pattern**: traverse() walks object graph depth-first
- **Strategy pattern**: Different rendering strategies for container types via _BRACES
- **Proxy pattern**: Pretty class wraps objects for Rich rendering protocol
- **Two-phase rendering**: Build tree structure, then render to string with width constraints

## Critical Constraints
- **Circular reference handling**: visited_ids set prevents infinite recursion
- **Width-aware expansion**: Lines expand only when they exceed available width
- **Memory safety**: Max depth limits prevent excessive memory usage on deep structures
- **Exception safety**: All repr() calls and attribute access wrapped in try/catch