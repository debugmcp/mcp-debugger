# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/_tokenizer.py
@source-hash: 27abf91fb273bdbf
@generated: 2026-02-09T18:00:40Z

## Primary Purpose
A lexical tokenizer for parsing Python package specification strings, part of the packaging library's parsing infrastructure. Handles context-sensitive token recognition with comprehensive error reporting.

## Key Classes and Functions

### Token (L11-15)
Simple dataclass representing a parsed token with:
- `name`: Token type identifier
- `text`: Matched text content  
- `position`: Character position in source

### ParserSyntaxError (L18-37)
Custom exception for parsing failures with rich error context:
- Stores error span, message, and source text
- `__str__()` (L34-36): Generates visual error indicator with caret pointing to error location

### Tokenizer (L90-194)
Main tokenizer class providing context-sensitive parsing:

**Core State (L97-108)**:
- `source`: Input text being parsed
- `rules`: Compiled regex patterns for token recognition
- `next_token`: Lookahead token buffer
- `position`: Current parsing position

**Token Recognition Methods**:
- `check()` (L115-134): Tests if next token matches given type, optionally without consuming
- `consume()` (L110-113): Advances past token if it matches expected type
- `expect()` (L136-143): Requires specific token or raises syntax error
- `read()` (L145-153): Consumes and returns the buffered next token

**Error Handling**:
- `raise_syntax_error()` (L155-171): Creates ParserSyntaxError with position context
- `enclosing_tokens()` (L173-194): Context manager for validating matching token pairs (brackets, parentheses)

## Token Rules (L39-87)
`DEFAULT_RULES` defines comprehensive token patterns for package specifications:
- **Delimiters**: Parentheses, brackets, semicolons, commas
- **Operators**: Comparison operators (===, ==, ~=, !=, <=, >=, <, >)  
- **Keywords**: Boolean operators (or, and), 'in', 'not'
- **Identifiers**: Package names, environment variables, version specifiers
- **Complex Patterns**: 
  - `QUOTED_STRING` (L46-55): Single/double quoted strings
  - `VARIABLE` (L60-75): Python environment variables (python_version, platform_system, etc.)
  - `SPECIFIER` (L76-79): Version specifiers using imported Specifier regex patterns
  - `URL`, `IDENTIFIER`, version trails

## Dependencies
- `specifiers.Specifier`: Imports regex patterns for version specifier matching
- Standard library: `re`, `contextlib`, `dataclasses`, `typing`

## Architectural Patterns
- **Lookahead Tokenization**: Single token buffer prevents backtracking complexity
- **Rule-based Parsing**: Extensible token rule system with regex compilation
- **Context Management**: Enclosing tokens pattern for nested syntax validation
- **Assertion-based State**: Guards against incorrect API usage with runtime assertions