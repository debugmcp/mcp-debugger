# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/truststore/_api.py
@source-hash: 07d2481e2a730484
@generated: 2026-02-09T18:01:04Z

**Purpose**: API module for the truststore library that provides a system certificate-aware SSL context replacement. Implements monkey-patching functionality to inject platform-specific certificate validation into the standard SSL module.

**Core Components**:

**Injection/Extraction Functions**:
- `inject_into_ssl()` (L32-44): Replaces `ssl.SSLContext` globally with truststore's implementation, including urllib3 references
- `extract_from_ssl()` (L47-55): Restores original SSL context, reversing the injection

**Main SSL Context Class**:
- `SSLContext` (L58-274): Drop-in replacement for `ssl.SSLContext` that uses OS certificate stores
  - Inherits from platform-specific base class via `_truststore_SSLContext_super_class`
  - Contains wrapped `_original_SSLContext` instance in `self._ctx` (L69)
  - Implements `__class__` property hack (L61-66) to pass isinstance() checks in third-party libraries
  - Defines nested `TruststoreSSLObject` class (L71-81) that hooks certificate verification into handshake

**Key Methods**:
- `wrap_socket()` (L83-109): Wraps socket with certificate validation, uses context manager pattern with platform-specific `_configure_context()`
- `wrap_bio()` (L111-127): Wraps BIO objects, defers verification to handshake time
- Certificate/TLS configuration methods (L129-184): Delegates to wrapped context
- Property accessors (L186-274): Proxy all SSL context properties to internal `_ctx`

**Certificate Verification**:
- `_verify_peercerts()` (L296-313): Extracts certificate chain and delegates to platform implementation
- `_get_unverified_chain_bytes()` (L282-293): Version-aware certificate chain extraction, handles Python 3.13+ API changes

**Platform Integration**:
- Platform-specific imports (L17-22): Windows, macOS, or OpenSSL backends provide `_configure_context` and `_verify_peercerts_impl`
- Uses imported constants from `_ssl_constants` for cross-platform compatibility

**Architecture**: Decorator/proxy pattern around standard SSL context with platform-specific certificate verification hooks injected at connection time. Critical for applications requiring OS certificate store integration while maintaining SSL API compatibility.