# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/response.py
@source-hash: 189a60dc4822f6a6
@generated: 2026-02-09T17:57:52Z

## Purpose and Responsibility

HTTP response utility functions for urllib3, providing response validation and state checking capabilities. Contains utilities for determining file-like object closure states, validating HTTP header parsing, and identifying HEAD request responses.

## Key Functions

### `is_fp_closed(obj)` (L9-37)
Determines if a file-like object is closed using multiple fallback strategies:
1. First attempts `obj.isclosed()` method (Python 3 compatibility, addresses GH Issue #928)
2. Falls back to `obj.closed` attribute (standard file-like interface)
3. Final fallback checks `obj.fp is None` (for container objects like HTTPResponse)
4. Raises `ValueError` if closure state cannot be determined

### `assert_header_parsing(headers)` (L40-91)
Validates successful HTTP header parsing, Python 3 only:
- **Input validation**: Ensures `headers` is `httplib.HTTPMessage` instance
- **Defect filtering**: Ignores specific multipart-related defects (`StartBoundaryNotFoundDefect`, `MultipartInvariantViolationDefect`) that occur due to httplib parsing headers without body data
- **Unparsed data detection**: Extracts payload from non-multipart messages to identify unparsed content
- **Error aggregation**: Raises `HeaderParsingError` with collected defects and unparsed data

### `is_response_to_head(response)` (L94-107)
Determines if an HTTP response originated from a HEAD request:
- **AppEngine compatibility**: Handles platform-specific integer method representation (method == 3 for HEAD)
- **Standard handling**: Compares uppercase method string to "HEAD"
- **Implementation note**: Accesses private `_method` attribute due to lack of public API

## Dependencies

- `email.errors`: Multipart parsing defect classes
- `..exceptions.HeaderParsingError`: Custom exception for header parsing failures  
- `..packages.six.moves.http_client`: Cross-version HTTP client compatibility

## Architectural Patterns

- **Progressive fallback strategy**: `is_fp_closed` uses multiple detection methods with graceful degradation
- **Defensive programming**: Type checking and explicit error handling throughout
- **Platform abstraction**: Handles AppEngine-specific quirks in HTTP method representation