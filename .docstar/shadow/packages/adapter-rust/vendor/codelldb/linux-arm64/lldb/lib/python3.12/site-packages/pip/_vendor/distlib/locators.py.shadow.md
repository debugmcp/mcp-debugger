# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/locators.py
@source-hash: a35aff33cebf6d12
@generated: 2026-02-09T18:00:50Z

## Purpose
This module provides a framework for locating Python distributions (packages) from various sources including PyPI, local directories, and custom repositories. It implements multiple locator strategies for finding, downloading, and resolving package dependencies.

## Key Classes

### Base Classes
- **Locator (L89-408)**: Abstract base class for all distribution locators
  - Core methods: `_get_project()`, `locate()`, `score_url()`, `prefer_url()`
  - Manages caching, URL scoring, and wheel compatibility checking
  - Extensions: `.tar.gz`, `.tar.bz2`, `.tar`, `.zip`, `.tgz`, `.tbz`, `.egg`, `.exe`, `.whl`

### Concrete Locator Implementations
- **PyPIRPCLocator (L410-456)**: Uses XML-RPC to query PyPI
  - Method: `_get_project()` calls `client.package_releases()` and `client.release_urls()`
- **PyPIJSONLocator (L459-525)**: Uses PyPI's JSON API (limited functionality)
- **SimpleScrapingLocator (L586-834)**: Multi-threaded HTML scraping locator
  - Uses worker threads for parallel I/O (`_prepare_threads()`, `_fetch()`)
  - Implements page caching and link extraction via regex patterns
- **DirectoryLocator (L836-900)**: Searches local filesystem directories
  - Recursive directory traversal with `os.walk()`
- **JSONLocator (L902-938)**: Uses extended metadata for fast dependency resolution
- **DistPathLocator (L941-966)**: Finds installed distributions in a DistributionPath
- **AggregatingLocator (L969-1055)**: Chains multiple locators with merge capability

### Utility Classes
- **RedirectHandler (L57-86)**: Custom HTTP redirect handler fixing Python 3.2.x bugs
- **Page (L528-583)**: HTML page representation with link extraction via regex `_href`
- **DependencyFinder (L1069-1303)**: Resolves distribution dependencies recursively

## Key Functions
- **get_all_distribution_names() (L42-54)**: Returns all package names from an index
- **locate (L1066)**: Default locator function using `default_locator`

## Important Dependencies
- Network: `urllib` components for HTTP requests, custom `RedirectHandler`
- Parsing: `json`, `re` for HTML/URL parsing, wheel filename parsing
- Threading: Multi-threaded scraping in `SimpleScrapingLocator`
- Internal: `.database`, `.metadata`, `.wheel`, `.version` modules

## Architecture Patterns
- **Strategy Pattern**: Multiple locator implementations with common interface
- **Template Method**: Base `Locator` class defines workflow, subclasses implement `_get_project()`
- **Producer-Consumer**: `SimpleScrapingLocator` uses thread queues for parallel web scraping
- **Caching**: URL scoring, page content, and project data caching throughout

## Critical Constants
- `DEFAULT_INDEX = 'https://pypi.org/pypi'` (L39)
- `default_locator` uses `SimpleScrapingLocator` with legacy versioning scheme (L1060-1064)

## Key Algorithms
- **URL Scoring (L191-204)**: Prioritizes HTTPS, PyPI origins, wheel compatibility
- **Dependency Resolution (L1195-1303)**: BFS traversal with conflict resolution
- **Link Extraction**: Regex-based HTML parsing for distribution URLs

## Threading Model
`SimpleScrapingLocator` creates worker threads that:
1. Fetch URLs from shared queue
2. Parse HTML for download links and follow-up URLs  
3. Update shared result dictionary with thread safety locks