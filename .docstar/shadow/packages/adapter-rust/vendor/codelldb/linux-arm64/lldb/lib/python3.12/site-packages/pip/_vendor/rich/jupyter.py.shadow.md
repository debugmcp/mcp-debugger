# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/jupyter.py
@source-hash: 432a0aa04ffc21d0
@generated: 2026-02-09T18:00:58Z

## Purpose and Responsibility
Provides Jupyter notebook integration for Rich library console rendering. Enables Rich renderables to display properly in Jupyter notebooks with both HTML and plain text representations through the `_repr_mimebundle_` protocol.

## Key Classes and Functions

### JupyterRenderable (L18-33)
Simple container class holding both HTML and text representations for Jupyter display.
- `__init__(html, text)` (L21-23): Stores HTML and plain text versions
- `_repr_mimebundle_()` (L25-33): Jupyter protocol method returning MIME bundle with optional include/exclude filtering

### JupyterMixin (L36-56)
Mixin class to add Jupyter rendering capability to Rich renderables.
- `_repr_mimebundle_()` (L41-56): Core method that renders Rich objects to both HTML and text for Jupyter display
- Uses console rendering pipeline: gets console → renders to segments → converts to HTML/text

### _render_segments() (L59-81)
Converts Rich segments to HTML representation for Jupyter display.
- `escape()` nested function (L60-62): HTML entity escaping for &, <, >
- Processes segments with styling: applies HTML span tags with inline styles and link wrapping
- Uses DEFAULT_TERMINAL_THEME for color/style conversion
- Wraps final output in JUPYTER_HTML_FORMAT template

### display() (L84-95)
Renders segments directly to Jupyter notebook output.
- Creates JupyterRenderable and attempts IPython display
- Gracefully handles missing IPython dependency (L92-95)

### print() (L98-101)
Simple proxy to console.print() for convenience.

## Dependencies and Relationships
- **Internal**: `get_console()`, `Segment`, `DEFAULT_TERMINAL_THEME`
- **External**: `IPython.display` (optional, graceful degradation)
- **Type hints**: `ConsoleRenderable` from rich.console

## Architecture Patterns
- **Mixin pattern**: JupyterMixin adds Jupyter capabilities to existing Rich renderables
- **MIME bundle protocol**: Implements Jupyter's `_repr_mimebundle_` for multi-format output
- **Graceful degradation**: Handles missing IPython dependency without errors
- **Template-based HTML generation**: Uses JUPYTER_HTML_FORMAT constant for consistent styling

## Critical Details
- HTML template (L13-15) uses monospace fonts and preserves whitespace
- Segment simplification removes control sequences before HTML conversion
- Style-to-HTML conversion uses theme-based color mapping
- Both include/exclude filtering supported for MIME type selection