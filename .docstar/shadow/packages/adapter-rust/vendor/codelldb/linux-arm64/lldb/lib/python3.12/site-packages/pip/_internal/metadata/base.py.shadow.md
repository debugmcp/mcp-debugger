# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/metadata/base.py
@source-hash: 7edd0ae573602381
@generated: 2026-02-09T18:00:35Z

## Purpose
Abstract base classes and protocols defining pip's internal metadata system for Python package distributions. Provides unified interface for querying installed packages, their metadata, dependencies, and entry points across different installation formats (.dist-info, .egg-info, legacy distutils).

## Key Classes and Protocols

### BaseEntryPoint (L49-61)
Protocol defining entry point interface with `name`, `value`, and `group` properties. Used for console scripts and plugin discovery.

### RequiresEntry (L93-97)
NamedTuple representing parsed dependency entries from legacy requires.txt files with `requirement`, `extra`, and `marker` fields.

### BaseDistribution (L99-580)
Core protocol for distribution metadata abstraction. Key methods:
- **Class methods (L100-138)**: `from_directory()`, `from_metadata_file_contents()` (PEP 658), `from_wheel()`
- **Location properties (L147-209)**: `location`, `editable_project_location`, `installed_location`, `info_location`
- **Installation type detection (L212-268)**: `installed_by_distutils`, `installed_as_egg`, `installed_with_setuptools_egg_info`, `installed_with_dist_info`
- **Metadata access (L270-420)**: `canonical_name`, `version`, `raw_name`, `metadata`, `requires_python`
- **Dependencies (L440-580)**: `iter_dependencies()`, `iter_provided_extras()`, `iter_declared_entries()`

### BaseEnvironment (L582-665)
Abstract environment for distribution discovery and filtering:
- **Factory methods (L585-591)**: `default()`, `from_paths()`
- **Distribution access (L593-599)**: `get_distribution()` by name
- **Iteration (L610-664)**: `iter_all_distributions()`, `iter_installed_distributions()` with filtering options

### Wheel Classes (L667-688)
- **Wheel protocol (L667-671)**: Base interface for wheel access
- **FilesystemWheel (L674-679)**: File-based wheel implementation
- **MemoryWheel (L682-688)**: In-memory wheel implementation

## Key Functions

### _convert_installed_files_path (L63-90)
Converts legacy installed-files.txt paths to modern RECORD format by resolving relative path components between info directory and package root.

### Legacy metadata handling (L509-580)
Methods for parsing egg-info format:
- `_iter_requires_txt_entries()` (L509-532): Parses INI-style requires.txt
- `_iter_egg_info_dependencies()` (L544-570): Converts to PEP 508 format
- `_add_egg_info_requires()` (L572-579): Merges into email.message metadata

## Dependencies
- **packaging**: Requirements, specifiers, version parsing, name normalization
- **pip._internal**: Exception handling, location utilities, direct URL metadata
- **Standard library**: pathlib, email, csv, json, zipfile, logging

## Architectural Patterns
- Protocol-based design for pluggable implementations
- Legacy format compatibility layer for egg-info/distutils
- Cached property pattern for expensive metadata operations
- Factory method pattern for distribution creation from various sources

## Critical Invariants
- Distribution names must follow PEP 508 project name pattern (L617-621)
- Path normalization preserves symlinks to maintain relative relationships
- Metadata lazy loading with caching via `@functools.cached_property`
- Legacy requires.txt extra names canonicalized for PEP 508 compatibility