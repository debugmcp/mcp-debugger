# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/idna/codec.py
@source-hash: 3d2ea6f9799d493e
@generated: 2026-02-09T18:00:35Z

## Purpose
Provides Python codec infrastructure for IDNA (Internationalized Domain Names) encoding/decoding, implementing the standard Python codec interface for the 'idna2008' encoding.

## Key Classes and Functions

**Codec (L8-26)**: Basic codec implementation with encode/decode methods
- `encode(data, errors)` (L10-17): Converts Unicode string to bytes using IDNA encoding, only supports 'strict' error handling
- `decode(data, errors)` (L19-26): Converts bytes to Unicode string using IDNA decoding, only supports 'strict' error handling

**IncrementalEncoder (L28-59)**: Buffered incremental encoder for streaming IDNA encoding
- `_buffer_encode(data, errors, final)` (L29-59): Core encoding logic that splits domain names by Unicode dots, handles partial labels when not final, uses `alabel()` for ASCII-compatible encoding

**IncrementalDecoder (L61-94)**: Buffered incremental decoder for streaming IDNA decoding  
- `_buffer_decode(data, errors, final)` (L62-94): Core decoding logic that splits by Unicode dots, handles partial labels, uses `ulabel()` for Unicode label conversion

**StreamWriter/StreamReader (L97-102)**: Simple stream codec classes inheriting from Codec and respective codecs base classes

**search_function (L105-116)**: Codec registration function that returns CodecInfo for 'idna2008' encoding

## Dependencies
- `.core`: Imports `encode`, `decode`, `alabel`, `ulabel`, `IDNAError` functions
- `codecs`: Python standard library codec infrastructure
- `re`: For Unicode dot pattern matching

## Key Patterns
- **Unicode Dot Handling**: Uses regex `_unicode_dots_re` (L6) to match various Unicode dot characters (U+002E, U+3002, U+FF0E, U+FF61)
- **Strict Error Policy**: All codec classes only support 'strict' error handling, raising IDNAError for other modes
- **Incremental Processing**: Both incremental classes handle partial domain labels by preserving incomplete labels until final=True
- **Trailing Dot Preservation**: Maintains trailing dots in domain names during encoding/decoding

## Architecture
Follows Python's codec registration pattern - registers 'idna2008' codec via `codecs.register()` (L118) with complete codec infrastructure including basic, incremental, and streaming variants.

## Critical Constraints
- Only 'strict' error handling supported across all codec variants
- Incremental processing requires careful label boundary management
- Size calculations track original input length, not output length