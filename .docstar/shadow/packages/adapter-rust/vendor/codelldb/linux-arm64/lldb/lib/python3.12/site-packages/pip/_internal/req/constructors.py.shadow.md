# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_internal/req/constructors.py
@source-hash: 682f4d73e484484c
@generated: 2026-02-09T18:00:31Z

## Purpose

Factory module for creating `InstallRequirement` instances from various input formats. This module separates requirement parsing and construction logic from the main `InstallRequirement` class to improve code organization and maintainability.

## Key Components

### Primary Constructors

**`install_req_from_editable()`** (L222-251) - Creates editable install requirements from `-e` style specifications (VCS URLs, local paths with `#egg=name`)

**`install_req_from_line()`** (L386-420) - Main constructor for requirements from command line or requirements files. Handles URLs, paths, wheel files, and requirement specifiers

**`install_req_from_req_string()`** (L423-458) - Creates requirements from PEP 508 requirement strings with PyPI domain restrictions

**`install_req_from_parsed_requirement()`** (L461-498) - Bridges parsed requirement files to InstallRequirement objects

### Parsing Functions

**`parse_editable()`** (L87-139) - Parses editable requirement strings into name, URL, and extras. Handles VCS URLs and local paths, validates VCS schemes

**`parse_req_from_line()`** (L307-383) - Complex parser that disambiguates between URLs, paths, wheel files, and requirement specifiers. Handles markers and extras

**`parse_req_from_editable()`** (L203-216) - Wrapper that converts editable strings to RequirementParts

### Utility Functions

**`_strip_extras()`** (L44-53) - Regex-based extraction of extras from requirement strings `[extra1,extra2]`

**`convert_extras()`** (L56-59) - Normalizes extras strings to sets using packaging library

**`_set_requirement_extras()`** (L62-84) - Reconstructs Requirement objects with modified extras using PEP 508 grammar

**`_looks_like_path()`** (L254-270) - Heuristic path detection based on separators and leading dots

**`_get_url_from_path()`** (L273-304) - Converts filesystem paths to file:// URLs with validation for installable directories

### Data Structures

**`RequirementParts`** (L195-200) - Immutable dataclass holding parsed requirement components (requirement, link, markers, extras)

## Dependencies

- `pip._vendor.packaging` - PEP 508 requirement parsing, markers, specifiers
- `pip._internal.models.link.Link` - URL/path abstraction
- `pip._internal.req.req_install.InstallRequirement` - Main requirement class
- `pip._internal.vcs` - Version control system detection

## Key Patterns

1. **Two-stage parsing**: Raw input → RequirementParts → InstallRequirement
2. **Format disambiguation**: URLs vs paths vs requirement specs using heuristics
3. **Extras handling**: Consistent normalization and reconstruction across all parsers
4. **Error contextualization**: Line source tracking for meaningful error messages

## Critical Behaviors

- VCS URL auto-prefixing for known schemes (L118-121)
- PyPI external dependency blocking (L439-450)  
- Relative file URL normalization (L338-339)
- Wheel metadata extraction for version constraints (L341-343)
- Requirements file validation with helpful error messages (L170-192)

## Constraints

- Editable requirements must be VCS URLs or local paths
- Package names required for editable VCS requirements (`#egg=name`)
- PyPI packages cannot depend on external URLs
- File paths must be installable (contain setup.py/pyproject.toml)