# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/modeline.py
@source-hash: 785daf3b82e9386a
@generated: 2026-02-09T18:00:39Z

## Primary Purpose
Vim/Vi modeline parser for extracting file type information from text buffers. Used by Pygments syntax highlighter to determine file type from editor modelines when file extension is ambiguous or missing.

## Key Components

### Regular Expression Pattern (L16-19)
`modeline_re` - Compiled regex pattern matching vi/vim/ex modelines with filetype declarations:
- Matches editor names: `vi`, `vim`, `ex` with optional version numbers
- Captures filetype from `ft=`, `filetype=`, `syn=`, or `syntax=` declarations
- Uses verbose mode for readability

### Core Functions

#### `get_filetype_from_line(l)` (L22-25)
Single line modeline parser:
- Searches input line against modeline regex
- Returns captured filetype string or None
- Simple wrapper around regex matching

#### `get_filetype_from_buffer(buf, max_lines=5)` (L28-41)
Buffer scanning function - main entry point:
- Scans last `max_lines` and first `max_lines` of buffer
- Two-phase search strategy:
  - Lines from end: `lines[-1:-max_lines-1:-1]` (L33)
  - Lines from start: `range(max_lines, -1, -1)` (L37)
- Returns first found filetype or None
- Handles edge cases with bounds checking

## Dependencies
- `re` module for regex operations
- No external dependencies

## Usage Pattern
Designed as utility for syntax highlighters - extracts editor hints about file content type when filename-based detection insufficient.

## Public Interface
Exports single function `get_filetype_from_buffer` via `__all__` (L13).