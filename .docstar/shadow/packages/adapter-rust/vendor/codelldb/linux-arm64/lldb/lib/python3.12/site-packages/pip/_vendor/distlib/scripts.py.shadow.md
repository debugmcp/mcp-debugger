# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/scripts.py
@source-hash: f3f80ff49effb653
@generated: 2026-02-09T18:00:44Z

## Purpose
Script generation and installation utility for Python distributions. Creates executable wrappers and shebang-adjusted scripts from entry point specifications or source files. Handles cross-platform compatibility, especially Windows launcher integration and Unix shebang optimization.

## Key Components

### Constants and Templates
- `_DEFAULT_MANIFEST` (L23-39): Windows application manifest template for executable launchers
- `FIRST_LINE_RE` (L42): Regex pattern matching Python shebang lines in source scripts
- `SCRIPT_TEMPLATE` (L43-50): Template for generated Python wrapper scripts with proper `sys.argv[0]` handling
- `WRAPPERS` (L64-68): Pre-loaded executable launcher binaries indexed by filename, loaded from distlib resources to avoid import issues during package updates

### Utility Functions
- `enquote_executable()` (L71-84): Quotes executable paths containing spaces, with special handling for `/usr/bin/env` constructions
- `_enquote_executable` (L88): Deprecated alias maintained for backward compatibility

### Core Class: ScriptMaker
**ScriptMaker** (L91-466): Main script generation engine

#### Configuration Properties
- `source_dir`, `target_dir` (L106-107): Source and destination directories
- `add_launchers` (L108): Enable Windows .exe launcher generation
- `variants` (L114): Set of script name variants to generate (e.g., '', 'X.Y' for versioned names)
- `set_mode` (L112-113): Platform-dependent executable bit setting
- `_is_nt` (L117-118): Windows platform detection

#### Shebang Generation (L154-255)
- `_build_shebang()` (L154-183): Creates optimized shebang lines, using `/bin/sh` wrapper for long/complex paths
- `_get_shebang()` (L185-255): Complete shebang resolution with Python executable detection, encoding validation, and platform-specific adjustments

#### Script Processing
- `_get_script_text()` (L257-261): Generates wrapper script content from entry point specifications
- `_make_script()` (L343-357): Creates new scripts from callable specifications
- `_copy_script()` (L359-409): Copies and adjusts existing scripts, detecting and replacing Python shebangs

#### File Writing (L269-327)
- `_write_script()`: Handles cross-platform script output with launcher integration on Windows
- Uses ZipFile embedding for Windows launchers with `__main__.py` as entry point
- Implements `.deleteme` fallback for replacing in-use executables

#### Windows Launcher Support (L423-434)
- `_get_launcher()`: Retrieves platform-specific launcher binaries (32/64-bit, ARM support)
- Integrates with pre-loaded `WRAPPERS` dictionary

#### Public API
- `make()` (L438-455): Single script generation from specification or filename
- `make_multiple()` (L457-466): Batch script generation

## Architecture Patterns

### Cross-Platform Abstraction
Handles Windows vs Unix differences through platform detection and conditional logic paths. Windows uses embedded launchers, Unix uses direct shebang execution.

### Resource Management  
Pre-loads all launcher binaries to memory during import to avoid filesystem access issues during package updates.

### Encoding Safety
Validates shebang UTF-8 compatibility and script encoding consistency to prevent execution failures.

### Executable Path Resolution
Complex hierarchy for Python executable detection: explicit setting → system executable → virtual environment → build-specific paths.

## Dependencies
- Internal: `.compat`, `.resources.finder`, `.util` modules for cross-platform utilities
- External: Standard library modules for file operations, ZIP handling, and system introspection