# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/wheel.py
@source-hash: 155402bdef2ef8bd
@generated: 2026-02-09T18:00:54Z

## Python Wheel Package Implementation

This module provides comprehensive wheel file (PEP 427) support for building, installing, verifying, and mounting Python packages. Part of the distlib library's packaging infrastructure.

### Core Classes

**Wheel (L175-991)** - Primary class for wheel file operations
- Initialization via filename parsing with regex validation (L183-223)
- Properties: `filename` (L224-240), `exists` (L241-245), `tags` (L246-252), `metadata` (L253-284)
- Key methods:
  - `build()` (L372-488): Creates wheel from paths, handles pure/platlib detection, script processing
  - `install()` (L505-744): Full installation with RECORD tracking, script generation, bytecode compilation
  - `verify()` (L834-889): Validates wheel integrity via checksums and file sizes
  - `mount()/unmount()` (L801-833): Dynamic loading support via sys.path manipulation
  - `update()` (L890-991): Generic wheel modification with version bumping

**Mounter (L135-170)** - Import hook for dynamically loaded wheel extensions
- Manages impure wheels with native extensions
- Implements Python import protocol (`find_module`, `load_module`)

### Platform Detection & Compatibility

**Global Constants (L37-53)** - Platform-specific wheel naming:
- `IMP_PREFIX`: Implementation prefix (cp/pp/jy/ip)
- `PYVER`, `IMPVER`: Python version tags
- `ARCH`: Normalized platform architecture
- `ABI`: Application Binary Interface identifier

**ABI Derivation (L54-78)** - Complex ABI tag generation logic handling debug builds, pymalloc, and unicode variations for Python < 3.8

**Filename Parsing (L80-97)** - Regex patterns for wheel filename validation:
- `FILENAME_RE`: Full wheel filename structure
- `NAME_VERSION_RE`: Name-version only parsing

### Compatibility System

**compatible_tags() (L1004-1082)** - Generates all compatible (python_version, abi, arch) combinations
- Handles version compatibility (current + older minors)
- macOS universal binary support with fat/intel/universal variants
- manylinux compatibility matrix based on glibc versions
- Returns comprehensive tag set for wheel selection

**is_compatible() (L1089-1099)** - Validates wheel compatibility against current platform

### File Processing

**Shebang Processing (L301-330)** - Script header normalization:
- Replaces interpreter paths with `#!python` or `#!pythonw`
- Preserves command-line arguments

**Hash Verification (L331-342)** - Cryptographic integrity checking using configurable algorithms (default sha256)

### Installation Features

- RECORD file generation and validation for uninstallation support
- Bytecode compilation with optional hash-based invalidation (PEP 552)
- Script wrapper generation from entry points or JSON metadata
- Permission preservation on POSIX systems
- Rollback capability via FileOperator integration
- Dynamic library caching system for extension modules

### Key Dependencies

- `zipfile`, `hashlib`, `base64` for archive operations
- `.compat` module for Python 2/3 compatibility
- `.metadata.Metadata` for package metadata parsing
- `.util.FileOperator` for installation file operations
- `.database.InstalledDistribution` for tracking installed packages

### Architecture Notes

- Extensive use of cached properties for expensive operations
- Platform-specific code paths for shebang handling and permissions
- Integration with distlib's broader packaging ecosystem
- Support for both legacy and modern wheel metadata formats