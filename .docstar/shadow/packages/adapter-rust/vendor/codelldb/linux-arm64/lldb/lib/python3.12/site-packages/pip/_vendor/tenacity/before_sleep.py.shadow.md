# packages/adapter-rust/vendor/codelldb/linux-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/tenacity/before_sleep.py
@source-hash: 626a6037d63b1c69
@generated: 2026-02-09T18:01:00Z

## Primary Purpose
Provides before-sleep callback strategies for tenacity retry operations. Contains functions that define what actions to take between retry attempts, including no-op and logging behaviors.

## Key Functions

### `before_sleep_nothing` (L27-28)
- **Purpose**: No-op callback strategy that performs no action between retries
- **Parameters**: `retry_state: RetryCallState` - current retry state information
- **Returns**: `None`
- **Usage**: Default strategy when no before-sleep action is needed

### `before_sleep_log` (L31-71)
- **Purpose**: Factory function that creates a logging callback for retry attempts
- **Parameters**: 
  - `logger: logging.Logger` - logger instance for output
  - `log_level: int` - logging level (DEBUG, INFO, etc.)
  - `exc_info: bool = False` - whether to include exception traceback
- **Returns**: `Callable[[RetryCallState], None]` - configured logging callback
- **Inner Function**: `log_it` (L38-69) - actual logging implementation

#### `log_it` Internal Logic (L38-69)
- Validates retry state has required fields (`outcome`, `next_action`)
- Handles both failed and successful outcomes differently:
  - **Failed**: Extracts exception info, formats as "raised ExceptionName: message"
  - **Successful**: Uses return value, formats as "returned <value>"
- Determines function name via `_utils.get_callback_name()` with fallback
- Logs formatted message: "Retrying {fn_name} in {sleep_seconds} seconds as it {verb} {value}"

## Dependencies
- `typing` - Type hints and TYPE_CHECKING
- `pip._vendor.tenacity._utils` - Utility functions for callback name extraction
- `pip._vendor.tenacity.RetryCallState` - Type import (conditional)
- `logging` - Logging infrastructure (conditional import)

## Architectural Patterns
- **Factory Pattern**: `before_sleep_log` creates configured callback functions
- **Strategy Pattern**: Different before-sleep behaviors as pluggable functions
- **Conditional Imports**: Uses `TYPE_CHECKING` to avoid runtime import overhead
- **Error Handling**: Explicit validation with `RuntimeError` for invalid states

## Critical Constraints
- `retry_state.outcome` and `retry_state.next_action` must be set before calling `log_it`
- Exception info only included when `exc_info=True` and outcome failed
- Function name resolution gracefully handles `None` fn with fallback to "<unknown>"