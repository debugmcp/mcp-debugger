# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/urllib3/contrib/_securetransport/bindings.py
@source-hash: e1793ae2a2243c1b
@generated: 2026-02-09T17:58:18Z

## Primary Purpose
Low-level ctypes bindings for macOS SecureTransport and CoreFoundation frameworks, providing C-level SSL/TLS and cryptographic functionality for urllib3's secure transport implementation.

## Platform Requirements & Initialization
- **macOS-only module** (L53-54): Raises ImportError on non-Darwin platforms
- **Version constraints** (L56-62): Requires macOS 10.8+ 
- **Dynamic library loading** (L65-87): `load_cdll()` function handles framework loading with fallback paths for macOS 10.16+

## Core Framework Bindings

### Security Framework (L81-319)
Comprehensive SSL/TLS and certificate management bindings:
- **Certificate operations**: SecItemImport (L136), SecCertificateCreateWithData (L157), SecCertificateCopyData (L160)
- **Identity/Keychain**: SecIdentityCreateWithCertificate (L166), SecKeychainCreate/Delete (L173-184)
- **SSL context management**: SSLCreateContext (L282), SSLSetProtocolVersionMin/Max (L292-296)
- **SSL I/O operations**: SSLHandshake (L216), SSLRead/Write (L219-223), SSLClose (L225)
- **Cipher suite control**: SSLSetEnabledCiphers (L238), SSLGetNegotiatedCipher (L255)
- **Trust evaluation**: SecTrustEvaluate (L273), SecTrustSetAnchorCertificates (L267)
- **Callback types**: SSLReadFunc/SSLWriteFunc (L193-196) for custom I/O

### CoreFoundation Framework (L328-418)
Memory management and data structure bindings:
- **Reference counting**: CFRetain/CFRelease (L328-332)
- **String operations**: CFStringCreateWithCString (L337), CFStringGetCString (L347)
- **Data manipulation**: CFDataCreate (L355), CFDataGetBytePtr (L361)
- **Collections**: CFArrayCreate/CFDictionaryCreate (L377-383, L364-372)

## Type Definitions (L90-133)
Extensive ctypes mapping of CoreFoundation and Security types:
- **Basic types**: Boolean, CFIndex, OSStatus
- **Reference types**: CFStringRef, CFArrayRef, SecCertificateRef, SSLContextRef
- **SSL-specific**: SSLProtocol, SSLCipherSuite, SecTrustResultType

## Constants Classes

### CFConst (L423-430)
CoreFoundation constants namespace with UTF-8 encoding definition.

### SecurityConst (L432-519)
Comprehensive SSL/TLS constants including:
- **Protocol versions** (L439-446): SSL 2/3, TLS 1.0-1.3 constants
- **Session options** (L437-449): Client/server side, stream types
- **Trust results** (L453-461): Certificate validation outcomes
- **Error codes** (L463-487): SSL protocol errors, certificate validation errors
- **Cipher suites** (L488-519): Modern TLS cipher suite constants (ECDHE, RSA, AES-GCM, ChaCha20-Poly1305)

## Key Architectural Decisions
- **Exception handling**: Try-catch block (L135-420) ensures graceful failure if framework functions unavailable
- **Version-aware loading**: Conditional path handling for macOS Big Sur (10.16+) compatibility
- **Comprehensive error mapping**: Detailed SSL error constants for robust error handling
- **Modern cipher support**: Includes TLS 1.3 and ChaCha20-Poly1305 cipher suites