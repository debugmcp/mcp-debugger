# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/urllib3/contrib/socks.py
@source-hash: 6918bd7965e8f591
@generated: 2026-02-09T18:02:14Z

## Primary Purpose
SOCKS proxy support module for urllib3, providing SOCKS4/4A/5 proxy functionality with optional PySocks dependency. Enables HTTP/HTTPS connections through SOCKS proxies with comprehensive authentication and DNS resolution options.

## Key Classes and Functions

### SOCKSConnection (L75-141)
- Extends HTTPConnection to route plain-text HTTP through SOCKS proxies
- Constructor (L80-82): Extracts `_socks_options` parameter containing proxy configuration
- `_new_conn()` (L84-140): Core connection establishment using `socks.create_connection()`
  - Handles source address and socket options
  - Comprehensive error handling for socket timeouts and proxy errors
  - Maps SOCKS-specific exceptions to urllib3 exceptions (ConnectTimeoutError, NewConnectionError)

### SOCKSHTTPSConnection (L147-148)
- Multiple inheritance from SOCKSConnection and HTTPSConnection
- Automatically inherits SSL verification behavior from urllib3's HTTPSConnection

### Connection Pools
- **SOCKSHTTPConnectionPool** (L151-152): Uses SOCKSConnection for HTTP
- **SOCKSHTTPSConnectionPool** (L155-156): Uses SOCKSHTTPSConnection for HTTPS

### SOCKSProxyManager (L159-216)
- Main interface extending urllib3's PoolManager for SOCKS proxy management
- `pool_classes_by_scheme` (L165-168): Maps http/https to appropriate SOCKS pool classes
- Constructor (L170-214): 
  - Parses proxy URL to extract authentication and determine SOCKS version
  - Supports scheme-based configuration (socks4/4a/5/5h)
  - Sets `rdns` flag based on scheme (True for 4a/5h, False for 4/5)
  - Creates `socks_options` dict with all proxy parameters

## Dependencies
- **Required**: PySocks library (imported as `socks`)
- **Core urllib3**: HTTPConnection, HTTPSConnection, connection pools, PoolManager
- **Standard library**: socket, ssl (optional)

## Protocol Support Matrix
- **socks4**: IPv4 + basic auth (username as userid)
- **socks4a**: IPv4 + domain names + basic auth  
- **socks5**: IPv4/IPv6/domains + local DNS + username/password auth
- **socks5h**: IPv4/IPv6/domains + remote DNS + username/password auth

## Architecture Patterns
- **Dependency injection**: SOCKS options passed through `_socks_options` parameter
- **Multiple inheritance**: SOCKSHTTPSConnection combines SOCKS and HTTPS capabilities
- **Factory pattern**: pool_classes_by_scheme maps schemes to connection pool types
- **Exception translation**: Converts SOCKS/socket exceptions to urllib3 exception hierarchy

## Critical Configuration
- Remote DNS (rdns): Automatically set based on scheme (4a/5h = True, 4/5 = False)
- Authentication extraction from proxy URL auth component
- Timeout handling preserved from base urllib3 connections