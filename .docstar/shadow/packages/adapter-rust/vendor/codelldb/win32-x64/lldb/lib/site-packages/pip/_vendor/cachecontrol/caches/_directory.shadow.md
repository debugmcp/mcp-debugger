# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/cachecontrol/caches/
@generated: 2026-02-09T18:16:07Z

## Overview
The `caches` directory provides pluggable cache backend implementations for pip's vendored cachecontrol HTTP caching library. It implements multiple storage strategies (filesystem and Redis) with a unified interface, enabling flexible caching solutions for HTTP responses with different performance and persistence characteristics.

## Architecture & Components

### Public API (`__init__.py`)
Serves as the primary entry point exposing three cache implementations:
- **`FileCache`**: Traditional file-based caching storing complete responses in memory
- **`SeparateBodyFileCache`**: Memory-efficient file caching with separate body storage for streaming
- **`RedisCache`**: Redis-backed caching for distributed/persistent storage

### File-Based Caching (`file_cache.py`)
Implements secure filesystem caching with two strategies:

**Core Infrastructure (`_FileCacheMixin`)**:
- SHA224-based key hashing for filesystem-safe naming
- Hierarchical directory structure using hash prefixes for performance
- Thread-safe operations with file locking via `filelock` dependency
- Security hardening: atomic writes, symlink protection, restricted permissions (0o600/0o700)

**Cache Variants**:
- **`FileCache`**: Stores entire response in single file, loads into memory
- **`SeparateBodyFileCache`**: Stores headers and body separately, enables streaming via file handles

### Redis-Based Caching (`redis_cache.py`)
Provides Redis backend with:
- Direct delegation to Redis client operations
- Flexible expiration handling (datetime objects, integer seconds, or permanent)
- Timezone-aware expiration calculations
- Database-wide clearing capabilities

## Data Flow & Integration
1. **Import Path**: `from pip._vendor.cachecontrol.caches import FileCache, RedisCache`
2. **Key Processing**: URLs converted to cache keys via hashing (file) or direct storage (Redis)
3. **Storage Operations**: Thread-safe writes with locking (file) or atomic Redis operations
4. **Retrieval**: Direct file reads or Redis gets, with optional streaming for large bodies

## Key Design Patterns
- **Adapter Pattern**: Each cache wraps different storage backends with unified interface
- **Mixin Pattern**: `_FileCacheMixin` provides shared file operations
- **Template Method**: Different file cache strategies inherit common functionality
- **Factory Pattern**: Lock class selection in file operations

## Dependencies & Requirements
- **Required**: `filelock` for file-based caches (with helpful error messaging)
- **Optional**: `redis` library for Redis caching
- **Internal**: Extends base classes from `cachecontrol.cache` module
- **Security**: Platform-specific atomic file operations, permission enforcement

## Usage Scenarios
- **Development/Single Node**: `FileCache` for simple persistent caching
- **Large Responses**: `SeparateBodyFileCache` for memory-efficient streaming
- **Production/Distributed**: `RedisCache` for shared, scalable caching across instances

The module provides a complete caching abstraction layer enabling pip's HTTP client to persist responses efficiently across different deployment environments and performance requirements.