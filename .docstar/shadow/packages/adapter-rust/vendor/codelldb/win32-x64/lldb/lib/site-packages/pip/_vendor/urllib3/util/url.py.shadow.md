# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/urllib3/util/url.py
@source-hash: 942004ecce66c80f
@generated: 2026-02-09T18:02:18Z

## Purpose
URL parsing and normalization module for urllib3. Provides RFC 3986/6874 compliant URL parsing with support for IPv4, IPv6, and IDNA-encoded hostnames. Handles percent-encoding, path normalization, and URL reconstruction.

## Core Data Structure
- **Url namedtuple (L82-173)**: Immutable URL representation with fields: scheme, auth, host, port, path, query, fragment
  - `__new__` (L91-107): Normalizes scheme to lowercase, ensures path starts with "/"
  - `hostname` property (L110-112): Backward-compatibility alias for host
  - `request_uri` property (L115-122): Returns path + query string for HTTP requests
  - `netloc` property (L125-129): Network location (host:port)
  - `url` property (L132-169): Reconstructs complete URL string
  - `__str__` (L171-172): String representation via url property

## Key Functions
- **parse_url(url) (L333-427)**: Main parsing function, returns Url namedtuple
  - Handles scheme detection, authority parsing, port validation (0-65535)
  - Applies normalization for HTTP(S) schemes only
  - Graceful handling of incomplete URLs
- **split_first(s, delims) (L175-207)**: DEPRECATED utility for delimiter-based splitting
- **get_host(url) (L430-435)**: DEPRECATED wrapper returning (scheme, hostname, port) tuple

## Internal Utilities
- **_encode_invalid_chars(component, allowed_chars) (L210-241)**: Percent-encodes URI components while preserving existing encodings
- **_remove_path_dot_segments(path) (L244-271)**: Normalizes paths by resolving "." and ".." segments per RFC 3986
- **_normalize_host(host, scheme) (L274-302)**: Host normalization with IPv6 zone ID handling and IDNA encoding
- **_idna_encode(name) (L305-320)**: International domain name encoding with fallback error handling
- **_encode_target(target) (L323-330)**: Encodes request targets (path + query)

## Pattern Definitions
- **URI_RE (L19-26)**: Main URI parsing regex with named groups
- **IPv4/IPv6 patterns (L28-64)**: Comprehensive IP address validation patterns including zone IDs
- **Character sets (L73-79)**: RFC 3986 character classes for different URL components
- **NORMALIZABLE_SCHEMES (L13)**: Only HTTP(S) and None schemes get normalized

## Key Constants
- **url_attrs (L9)**: Field names for Url namedtuple
- **PERCENT_RE (L17)**: Matches existing percent-encoded sequences
- **TARGET_RE (L58)**: Extracts path and query from request targets

## Dependencies
- Uses `six` for Python 2/3 compatibility
- Optional `idna` module for international domain names
- Raises `LocationParseError` for malformed URLs

## Architectural Notes
- Immutable design with namedtuple base class
- Selective normalization only for web schemes
- Backward compatibility maintained for deprecated functions
- Robust error handling with graceful degradation