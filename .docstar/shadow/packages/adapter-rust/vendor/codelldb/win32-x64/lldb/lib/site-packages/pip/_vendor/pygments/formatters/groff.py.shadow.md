# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/pygments/formatters/groff.py
@source-hash: c72f197f7b573a8e
@generated: 2026-02-09T18:02:05Z

## Purpose
Pygments formatter for groff/troff/roff markup output. Converts syntax-highlighted tokens into groff escape sequences for font styles, colors, and formatting suitable for manual pages and documentation.

## Key Components

### GroffFormatter Class (L18-170)
Primary formatter class extending Pygments' base Formatter. Transforms tokenized source code into groff markup with color and font styling.

**Configuration Options:**
- `monospaced` (L48): Boolean for monospace font usage (default: True)
- `linenos` (L49): Boolean for line number display (default: False) 
- `wrap` (L51): Integer for line wrapping at specified character count (default: 0/disabled)

**Internal State:**
- `_lineno` (L50): Current line number counter
- `_linelen` (L52): Current line length for wrap calculations
- `styles` (L54): Dictionary mapping token types to groff escape sequences

### Core Methods

**_make_styles() (L58-78)**
Generates groff escape sequences for different token types based on style definitions. Maps font styles (regular/bold/italic) and colors to appropriate groff commands (`\f[CR]`, `\f[CB]`, `\f[CI]`, `\m[color]`, `\M[bgcolor]`).

**_define_colors() (L81-88)**
Extracts unique colors from style definitions and writes groff color definitions (`.defcolor`) to output.

**_write_lineno() (L91-93)**
Outputs formatted line numbers with proper spacing and newline handling.

**_wrap_line() (L96-116)**
Handles line wrapping logic when wrap option is enabled. Calculates chunk sizes, manages line length tracking, and inserts appropriate spacing for line numbers.

**_escape_chars() (L119-135)**
Escapes special characters for groff compatibility. Handles backslashes, dots, quotes, tildes, and Unicode characters by converting them to groff escape sequences (`\[uXXXX]`).

**format_unencoded() (L138-170)**
Main formatting method. Processes token stream and outputs groff-formatted text with:
- Color definitions header
- Font initialization (`.nf`, `\f[CR]`)
- Token-by-token processing with style application
- Line number handling
- Text escaping and wrapping
- Footer (`.fi`)

## Dependencies
- `math`: For floor division in line wrapping calculations
- `pip._vendor.pygments.formatter.Formatter`: Base formatter class
- `pip._vendor.pygments.util`: Utility functions for option parsing (`get_bool_opt`, `get_int_opt`)

## Architecture Notes
- Uses groff escape sequences for font control (`\f[style]`) and color (`\m[color]`, `\M[bgcolor]`)
- Implements token type inheritance by walking up parent hierarchy when styles not found (L147-148)
- Maintains line length state for intelligent wrapping behavior
- Separates concerns between style generation, character escaping, and output formatting