# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/pygments/formatters/latex.py
@source-hash: 146cc9f98a924c4f
@generated: 2026-02-09T18:02:10Z

## Purpose
LaTeX code formatter for Pygments syntax highlighting system. Converts tokenized source code into LaTeX markup using the `fancyvrb` and `color` packages, with support for full document generation and customizable styling.

## Key Components

### Core Formatter: LatexFormatter (L147-438)
Main formatter class inheriting from `Formatter`. Converts syntax-highlighted tokens to LaTeX markup with extensive customization options.

**Key Methods:**
- `__init__` (L256-278): Initializes formatter with 15+ configuration options including `nowrap`, `linenos`, `commandprefix`, `texcomments`, `mathescape`, etc.
- `_create_stylesheet` (L279-323): Builds internal mappings (`ttype2name`, `cmd2def`) from Pygments style definitions to LaTeX commands
- `get_style_defs` (L324-334): Returns LaTeX macro definitions needed for styling, using `STYLE_TEMPLATE`
- `format_unencoded` (L336-437): Core formatting logic that processes token stream and writes LaTeX output

### Utility Functions
- `escape_tex` (L22-40): Escapes LaTeX special characters using temporary placeholder substitution strategy
- `_get_ttype_name` (L135-144): Maps Pygments token types to short names using `STANDARD_TYPES` lookup with parent fallback

### LaTeX Templates
- `DOC_TEMPLATE` (L43-58): Complete LaTeX document template with configurable docclass, encoding, preamble
- `STYLE_TEMPLATE` (L98-132): Complex LaTeX macro system for token styling using `\PY` command and class-based resolution

### Embedded Lexer: LatexEmbeddedLexer (L440-521)
Specialized lexer for handling LaTeX escape sequences within source code. Processes text in two passes: first extracts strings/comments, then finds escape tokens outside those regions.

**Key Methods:**
- `get_tokens_unprocessed` (L457-474): Main tokenization method using insertion/buffering strategy
- `_find_safe_escape_tokens` (L476-486): Locates escape sequences not in strings/comments
- `_filter_to` (L488-503): Token stream filtering utility
- `_find_escape_tokens` (L505-521): Low-level escape token detection

## Architecture Patterns

**Multi-Pass Processing**: Embedded lexer uses multiple passes to safely handle escape sequences
**Template-Based Output**: Uses string templates with parameter substitution for LaTeX generation
**Token Type Hierarchy**: Leverages Pygments token type inheritance for style fallback
**Command Prefix System**: All LaTeX commands use configurable prefix (default "PY") for namespace isolation

## Configuration Options
Supports 15+ options: `nowrap`, `full`, `linenos`, `texcomments`, `mathescape`, `escapeinside`, `commandprefix`, `envname`, `docclass`, `preamble`, `verboptions`, etc.

## Dependencies
- `pip._vendor.pygments.formatter.Formatter`: Base formatter class
- `pip._vendor.pygments.token`: Token types and constants
- `pip._vendor.pygments.lexer`: Lexer utilities including `do_insertions`
- `pip._vendor.pygments.util`: Option parsing utilities