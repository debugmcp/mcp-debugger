# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/urllib3/util/ssltransport.py
@source-hash: 340faee6b313ac31
@generated: 2026-02-09T18:02:14Z

## Purpose
Implements SSLTransport for TLS-over-TLS tunneling in urllib3. Wraps existing sockets with SSL/TLS encryption using memory BIO (Binary I/O) objects, enabling multiple chained TLS connections.

## Key Classes & Functions

**SSLTransport (L11-221)**: Main class wrapping sockets with SSL encryption
- `_validate_ssl_context_for_tls_in_tls()` (L22-42): Static method validating SSL context has `wrap_bio` capability; raises ProxySchemeUnsupported for Python 2 or non-native SSL contexts
- `__init__()` (L44-61): Creates SSL transport with memory BIOs, performs initial handshake
- `_ssl_io_loop()` (L195-221): Core I/O loop handling SSL read/write operations between memory BIOs and underlying socket
- `_wrap_ssl_read()` (L186-193): SSL read wrapper with ragged EOF suppression

## Socket Interface Methods
- `read()/recv()/recv_into()` (L72-87): SSL-wrapped read operations
- `send()/sendall()` (L89-103): SSL-wrapped write operations  
- `makefile()` (L105-148): Creates buffered file-like objects for HTTP client compatibility
- Certificate/protocol info: `getpeercert()`, `version()`, `cipher()`, `selected_alpn_protocol()` etc. (L156-175)

## Dependencies
- `ssl.MemoryBIO` for memory-based SSL I/O
- `socket.SocketIO` for file-like socket interface
- `ProxySchemeUnsupported` exception from urllib3
- `six` for Python 2/3 compatibility

## Architecture
Uses memory BIO pattern instead of direct socket SSL wrapping, enabling TLS tunneling through existing TLS connections. Incoming/outgoing BIOs buffer encrypted data while underlying socket handles transport.

## Constants
- `SSL_BLOCKSIZE = 16384` (L8): Buffer size for SSL I/O operations

## Context Manager Support
Implements `__enter__/__exit__` for proper resource cleanup (L63-67).