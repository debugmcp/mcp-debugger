# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/urllib3/util/ssl_.py
@source-hash: 5f8f80a96f756983
@generated: 2026-02-09T18:02:18Z

## Primary Purpose
SSL/TLS utility module for urllib3 providing cross-platform SSL context creation, certificate validation, and secure socket wrapping with fallbacks for older Python versions.

## Key Components

### Constants & Configuration (L19-27, L110-127)
- `SSLContext`, `SSLTransport`, `HAS_SNI`, `IS_PYOPENSSL`, `IS_SECURETRANSPORT` - Platform capability flags
- `ALPN_PROTOCOLS` - HTTP/1.1 protocol list for ALPN negotiation
- `HASHFUNC_MAP` - Maps digest lengths to hash functions (MD5, SHA1, SHA256)
- `DEFAULT_CIPHERS` - Secure cipher suite string prioritizing forward secrecy and modern algorithms

### Protocol & Option Detection (L45-91)
Progressive fallback chain for SSL protocol constants and options:
- `PROTOCOL_TLS_CLIENT` → `PROTOCOL_TLS` → `PROTOCOL_SSLv23` → hardcoded value
- SSL options with fallback values: `OP_NO_SSLv2`, `OP_NO_SSLv3`, `OP_NO_COMPRESSION`, `OP_NO_TICKET`

### Security Functions
- `_const_compare_digest_backport()` (L30-41) - Constant-time digest comparison for timing attack prevention
- `assert_fingerprint()` (L182-209) - Certificate fingerprint validation using secure comparison
- `resolve_cert_reqs()` (L211-232) - Converts certificate requirement strings to SSL constants
- `resolve_ssl_version()` (L234-248) - Converts SSL version strings to protocol constants

### SSLContext Fallback (L133-180)
`SSLContext` class for Python 2 compatibility providing minimal SSL context interface:
- Stores SSL configuration (protocol, verify mode, certificates, ciphers)
- `wrap_socket()` method with deprecation warning for insecure platforms

### Core SSL Context Creation
- `create_urllib3_context()` (L250-353) - Creates secure SSL context with:
  - Default security options (disable SSLv2/v3, compression, tickets)
  - Cipher suite configuration
  - Post-handshake authentication for TLS 1.3
  - SSL key logging support via `SSLKEYLOGFILE`
  - Careful verify_mode/check_hostname ordering

### Socket Wrapping
- `ssl_wrap_socket()` (L355-455) - Main SSL socket wrapper with:
  - SSL context creation/configuration
  - Certificate loading (CA certs, client certs)
  - SNI hostname validation
  - TLS-in-TLS support via SSLTransport
- `_ssl_wrap_socket_impl()` (L481-495) - Low-level socket wrapping implementation

### Utility Functions
- `is_ipaddress()` (L457-467) - IPv4/IPv6 address detection for SNI decisions
- `_is_key_file_encrypted()` (L470-478) - Detects encrypted private key files

## Dependencies
- Standard library: `ssl`, `hmac`, `hashlib`, `warnings`, `os`, `sys`
- Internal: `..exceptions`, `..packages.six`, `.url`, `.ssltransport`

## Security Architecture
- Implements defense-in-depth with multiple fallback layers
- Prioritizes forward secrecy and modern cryptographic algorithms  
- Includes timing attack protections and secure defaults
- Handles platform-specific SSL limitations gracefully

## Critical Constraints
- Must maintain compatibility across Python 2.7+ and 3.x
- SSL module availability varies by platform/build
- SNI support detection affects certificate validation behavior
- TLS-in-TLS requires SSLTransport availability