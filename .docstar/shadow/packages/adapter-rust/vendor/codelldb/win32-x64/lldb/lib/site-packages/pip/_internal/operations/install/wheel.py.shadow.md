# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_internal/operations/install/wheel.py
@source-hash: c2c8435009f1b8f5
@generated: 2026-02-09T18:02:14Z

## Primary Purpose

Core wheel package installation module for pip, handling extraction, file placement, script generation, and metadata management for Python wheel packages.

## Key Functions

**Installation Entry Points**
- `install_wheel()` (L714-735): Main public API for installing a wheel package from file path
- `_install_wheel()` (L424-703): Core implementation handling ZIP extraction, file processing, and metadata generation

**File Processing & Utilities**
- `rehash()` (L80-84): Generates SHA256 digest and size for files using pip's hashing utilities
- `csv_io_kwargs()` (L87-91): Returns standardized CSV file opening parameters (UTF-8, no newline translation)
- `fix_script()` (L94-111): Replaces generic `#!python` shebangs with actual Python executable path

**Wheel Metadata Handling**
- `wheel_root_is_purelib()` (L114-115): Determines if wheel contains pure Python code via metadata
- `get_entrypoints()` (L118-126): Extracts console_scripts and gui_scripts from distribution metadata
- `parse_wheel()` (imported): Validates wheel format and extracts metadata

**Entry Point Processing**
- `get_console_script_specs()` (L273-345): Handles special versioned entry point generation for pip/setuptools, respects ENSUREPIP_OPTIONS environment variable
- `_raise_for_invalid_entrypoint()` (L410-413): Validates entry point specifications have callable suffixes

**File Path Management**
- `_record_to_fs_path()` (L227-228): Converts RECORD paths to filesystem paths
- `_fs_to_record_path()` (L231-238): Converts filesystem paths to RECORD format (forward slashes, relative)
- Path traversal protection via `assert_no_path_traversal()` (L476-484)

**RECORD File Management**
- `get_csv_rows_for_installed()` (L241-270): Updates installation RECORD with new paths, hashes, and generated files
- `_normalized_outrows()` (L201-224): Normalizes and sorts RECORD entries for deterministic output

**Script Location Warnings**
- `message_about_scripts_not_on_PATH()` (L129-198): Generates detailed warning messages when scripts are installed outside PATH directories

## Key Classes

**File Abstractions**
- `ZipBackedFile` (L348-386): Handles extraction of individual files from wheel ZIP, manages permissions and executable bits
- `ScriptFile` (L388-398): Wrapper for script files that applies shebang fixing via `fix_script()`
- `PipScriptMaker` (L416-421): Extends distlib's ScriptMaker with entry point validation

**Exception Classes**
- `MissingCallableSuffix` (L400-407): Raised when entry point lacks required callable suffix

## Type Definitions

- `RecordPath` (L76): NewType for RECORD file paths (string-based)
- `InstalledCSVRow` (L77): Tuple format for RECORD entries (path, hash, size)
- `File` Protocol (L65-71): Interface for file objects with save capability

## Installation Flow

1. **Validation**: Parse wheel metadata and validate format
2. **Path Determination**: Choose purelib vs platlib based on Root-Is-Purelib metadata
3. **File Categorization**: Separate root files, data scheme files, and script files
4. **File Processing**: Extract files with proper permissions, apply script fixes
5. **Entry Point Generation**: Create console/GUI scripts using PipScriptMaker
6. **Python Compilation**: Optionally compile .py files to .pyc
7. **Metadata Generation**: Write INSTALLER, REQUESTED, DIRECT_URL files
8. **RECORD Update**: Generate final installation record

## Dependencies

- **Core**: zipfile, csv, os, shutil, sys, importlib
- **Pip Internal**: metadata system, filesystem utilities, unpacking utilities
- **External**: distlib for script generation, packaging for name canonicalization

## Critical Behaviors

- Special handling for pip/setuptools versioned entry points (L283-340)
- Path traversal attack prevention for all extracted files
- Atomic file replacement using temporary files to prevent segfaults during shared library updates
- ENSUREPIP_OPTIONS environment variable controls script generation behavior
- Cross-platform path handling with proper separator normalization