# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_vendor/urllib3/util/ssl_match_hostname.py
@source-hash: 22be1c6551239809
@generated: 2026-02-09T18:02:11Z

**Primary Purpose**: SSL hostname verification implementation backported from Python 3.3.3, providing secure certificate hostname matching according to RFC 2818 and RFC 6125 standards.

**Core Architecture**: 
- Main entry point: `match_hostname()` (L98-159) validates SSL certificates against hostnames
- DNS pattern matching via `_dnsname_match()` (L25-76) with wildcard support
- IP address matching through `_ipaddress_match()` (L86-95) when ipaddress library available
- Unicode handling via `_to_unicode()` (L79-83) for Python 2/3 compatibility

**Key Classes & Functions**:
- `CertificateError(ValueError)` (L21-22): Exception raised on hostname verification failures
- `_dnsname_match(dn, hostname, max_wildcards=1)` (L25-76): RFC 6125 compliant DNS name matching with wildcard support, handles internationalized domains (xn-- prefixed)
- `_ipaddress_match(ipname, host_ip)` (L86-95): Exact IP address matching for subjectAltName IP addresses
- `_to_unicode(obj)` (L79-83): Python 2/3 compatibility layer for string handling
- `match_hostname(cert, hostname)` (L98-159): Primary validation function processing certificate subject and subjectAltName fields

**Dependencies**:
- `re`: Regular expression engine for wildcard pattern matching
- `sys`: Python version detection for compatibility
- `ipaddress`: Optional IP address parsing (graceful fallback if unavailable)

**Security Features**:
- Wildcard abuse protection: max 1 wildcard per DNS fragment (L40-48)
- RFC 6125 compliance: rejects wildcards in internationalized domains (L61-66)
- Proper certificate field precedence: subjectAltName over commonName (L138-148)

**Compatibility Notes**:
- Python 2.7+ support with unicode handling
- Optional ipaddress dependency with graceful degradation
- Backported from Python 3.3.3 stdlib under PSF license

**Validation Logic Flow**:
1. Parse hostname as IP address if possible
2. Check subjectAltName DNS/IP entries first
3. Fallback to commonName only if no subjectAltName present
4. Raise CertificateError with descriptive messages on mismatch