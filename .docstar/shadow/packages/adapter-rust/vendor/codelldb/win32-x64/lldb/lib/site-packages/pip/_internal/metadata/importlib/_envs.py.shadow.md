# packages/adapter-rust/vendor/codelldb/win32-x64/lldb/lib/site-packages/pip/_internal/metadata/importlib/_envs.py
@source-hash: f001a88db7fb122f
@generated: 2026-02-09T18:02:02Z

## Purpose
Environment scanning and distribution discovery implementation for pip's importlib-based metadata backend. Provides functionality to find installed Python packages across filesystem paths, handling various installation formats including standard distributions, egg-link files, and legacy egg packages.

## Key Components

### `_looks_like_wheel()` (L24-31)
Validates whether a file path represents a valid wheel file by checking extension, file existence, filename pattern matching, and ZIP format validation.

### `_DistributionFinder` (L34-147)
Core distribution discovery engine with memoization to prevent duplicate package detection:
- **`_found_names`** (L50): Set tracking already-discovered package names to enforce single-package-per-name constraint
- **`_find_impl()`** (L52-72): Low-level distribution finder that scans a single location, handles metadata errors, and tracks found packages
- **`find()`** (L74-84): Main distribution finder wrapping `_find_impl()` and creating `Distribution` objects
- **`find_linked()`** (L86-108): Processes egg-link files to discover distributions at linked locations
- **`find_eggs()`** (L134-146): Legacy egg package discovery using pkg_resources backend
- **`_find_eggs_in_dir()`** (L110-120) and **`_find_eggs_in_zip()`** (L122-132): Egg discovery helpers for directory and ZIP scenarios

### `_emit_egg_deprecation()` (L149-156)
LRU-cached deprecation warning emitter for egg package usage, scheduled for removal in pip 24.3.

### `Environment` (L159-189)
Main environment interface implementing `BaseEnvironment`:
- **`__init__()`** (L160-161): Accepts sequence of filesystem paths to scan
- **`default()`** (L163-165): Factory method using `sys.path`
- **`from_paths()`** (L167-171): Factory method with optional path override
- **`_iter_distributions()`** (L173-181): Primary distribution iterator orchestrating finder operations in precedence order
- **`get_distribution()`** (L183-189): Name-based distribution lookup with canonicalization

## Dependencies
- **importlib.metadata**: Modern Python package metadata access
- **pip._vendor.packaging.utils**: Package name canonicalization
- **pip._internal.metadata.base**: Abstract base classes
- **pip._vendor.pkg_resources**: Legacy egg support (deprecated path)

## Architecture Notes
- Implements precedence-based package discovery where first-found packages mask later duplicates
- Maintains backward compatibility with setuptools behavior
- Uses memoization pattern to prevent duplicate work and ensure consistent results
- Separates modern importlib.metadata handling from legacy pkg_resources fallback
- Handles multiple package formats: standard distributions, egg-links, and legacy eggs

## Critical Constraints
- Package name normalization ensures case-insensitive matching
- Discovery order matters: regular packages → eggs → linked packages
- Wheel files are explicitly skipped during scanning (L54-58)
- Egg functionality is deprecated and will be removed