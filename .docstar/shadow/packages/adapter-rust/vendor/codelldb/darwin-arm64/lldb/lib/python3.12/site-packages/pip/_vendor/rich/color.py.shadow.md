# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/color.py
@source-hash: 6c24404d57517b92
@generated: 2026-02-09T17:59:10Z

## Color System Management for Terminal Output

Core module in Rich library responsible for parsing, representing, and converting colors across different terminal color systems. Handles color downgrading based on terminal capabilities and provides ANSI escape code generation.

### Key Classes

**ColorSystem (L21-34)**: IntEnum defining 4 terminal color capabilities:
- STANDARD (1): 16 basic ANSI colors
- EIGHT_BIT (2): 256 colors  
- TRUECOLOR (3): 24-bit RGB colors
- WINDOWS (4): Windows console colors

**ColorType (L36-47)**: IntEnum for internal color representation:
- DEFAULT (0): Terminal default foreground/background
- STANDARD (1): 16 basic colors
- EIGHT_BIT (2): 256-color palette
- TRUECOLOR (3): RGB triplets  
- WINDOWS (4): Windows palette

**Color (L302-568)**: Main NamedTuple representing a terminal color with:
- `name` (str): Original color specification
- `type` (ColorType): How color is stored internally
- `number` (Optional[int]): Index for palette-based colors
- `triplet` (Optional[ColorTriplet]): RGB values for truecolor

### Core Methods

**Color.parse() (L432-482)**: Cached classmethod parsing color strings:
- Named colors from ANSI_COLOR_NAMES dict (L49-285)
- Hex format: "#rrggbb"
- Color function: "color(n)" for 0-255 indices
- RGB function: "rgb(r,g,b)" with 0-255 components

**Color.get_truecolor() (L349-378)**: Converts any color to RGB triplet using terminal theme for system-defined colors.

**Color.downgrade() (L512-568)**: Reduces color to lower capability system:
- TRUECOLOR → EIGHT_BIT: Uses HLS conversion with grayscale detection
- Any → STANDARD: Matches closest from 16-color palette
- Handles Windows palette conversion

**Color.get_ansi_codes() (L484-510)**: Generates ANSI escape sequences for foreground/background colors.

### Factory Methods

- `from_ansi(number)` (L380-394): Creates from 0-255 index
- `from_triplet(triplet)` (L396-406): Creates from ColorTriplet
- `from_rgb(r,g,b)` (L408-420): Creates from RGB components
- `default()` (L422-429): Returns default terminal color

### Dependencies

- `ColorTriplet`: RGB color representation with normalization
- `_palettes`: EIGHT_BIT_PALETTE, STANDARD_PALETTE, WINDOWS_PALETTE for color matching
- `TerminalTheme`: System color definitions (foreground/background)
- `colorsys.rgb_to_hls`: For color space conversion in downgrading

### Utilities

**parse_rgb_hex() (L571-577)**: Converts 6-char hex string to ColorTriplet
**blend_rgb() (L580-591)**: Linear interpolation between two RGB colors

### Constants

- `ANSI_COLOR_NAMES` (L49-285): Comprehensive mapping of 285 color names to indices
- `RE_COLOR` (L292-299): Regex for parsing hex/color()/rgb() formats
- `WINDOWS` (L18): Platform detection flag

The module uses extensive caching (`@lru_cache`) on parsing and code generation methods for performance. Color downgrading algorithm uses perceptual color matching and HLS color space for better visual results.