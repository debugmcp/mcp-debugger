# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatter.py
@source-hash: 27d38bf615cb24a6
@generated: 2026-02-09T17:58:53Z

**Primary Purpose:**
Base formatter class for Pygments syntax highlighting library that converts token streams to formatted text output. Provides abstract interface and common functionality for all concrete formatter implementations.

**Key Classes:**

**Formatter (L25-124):**
- Abstract base class for all Pygments formatters
- Converts token streams from lexers into formatted output (HTML, LaTeX, etc.)
- Handles encoding, styling, and output options
- Key attributes:
  - `name` (L68): Human-readable formatter name
  - `aliases` (L72): Short identifiers for formatter lookup
  - `filenames` (L77): File patterns this formatter handles
  - `unicodeoutput` (L81): Whether formatter outputs Unicode by default

**Key Methods:**

**`__init__` (L83-97):**
- Processes common formatter options: style, full document mode, title, encoding
- Resolves style from string name or Style object via `_lookup_style`
- Handles encoding normalization (converts 'guess'/'chardet' to 'utf-8')
- Supports `outencoding` override for `encoding`

**`get_style_defs` (L99-112):**
- Abstract method returning style definitions (CSS classes, etc.)
- Takes optional `arg` parameter for formatter-specific customization
- Default implementation returns empty string
- Used by command-line `-S` option

**`format` (L114-124):**
- Main formatting method that processes token stream to output file
- Wraps output file with encoding StreamWriter if encoding specified
- Delegates to `format_unencoded` method (not implemented in base class)

**Key Functions:**

**`_lookup_style` (L19-22):**
- Helper function resolving style argument to Style object
- Handles both string style names and Style objects
- Uses `get_style_by_name` for string resolution

**Dependencies:**
- `codecs`: Standard library for encoding handling
- `pip._vendor.pygments.util.get_bool_opt`: Boolean option parsing
- `pip._vendor.pygments.styles.get_style_by_name`: Style resolution

**Architectural Patterns:**
- Template method pattern: `format` calls abstract `format_unencoded`
- Strategy pattern: Different formatter implementations extend this base
- Options dictionary pattern: Flexible configuration via kwargs
- Encoding abstraction: Transparent Unicode/byte string handling

**Critical Invariants:**
- Subclasses must implement `format_unencoded` method
- Encoding 'guess'/'chardet' always normalized to 'utf-8'
- `outencoding` option takes precedence over `encoding`
- All formatters accept standard options (style, full, title, encoding)