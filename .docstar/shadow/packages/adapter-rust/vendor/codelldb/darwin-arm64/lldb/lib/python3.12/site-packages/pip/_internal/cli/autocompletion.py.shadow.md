# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/autocompletion.py
@source-hash: 2e58b732be9a0cdb
@generated: 2026-02-09T17:58:23Z

## Purpose
Implements bash autocompletion logic for pip CLI commands, triggered by shell completion environment variables.

## Core Functions

**`autocomplete()` (L15-121)** - Main entry point that parses shell environment to provide completion suggestions:
- Checks for `PIP_AUTO_COMPLETE`, `COMP_WORDS`, `COMP_CWORD` environment variables (L18-23)
- Extracts current word being completed and command context (L24-29)
- Routes to subcommand-specific or main parser completion logic

**`get_path_completion_type()` (L124-145)** - Determines if path completion is needed:
- Analyzes previous option to detect file/dir/path metavar requirements
- Returns completion type string or None
- Used to trigger filesystem-based completion

**`auto_complete_paths()` (L148-176)** - Generates filesystem path completions:
- Lists files/directories matching current input prefix
- Respects completion type (file, dir, path) to filter results
- Handles directory traversal and access permissions

## Key Dependencies
- `pip._internal.cli.main_parser.create_main_parser` (L10) - Gets main CLI parser
- `pip._internal.commands.commands_dict, create_command` (L11) - Command registry and instantiation
- `pip._internal.metadata.get_default_environment` (L12) - Package environment access

## Completion Logic Patterns

**Subcommand Detection** (L37-40): Scans command words to identify active subcommand

**Special Cases**:
- Help command: exits immediately (L44-45)
- Show/uninstall commands: completes installed package names (L47-64)
- Install command: completes filesystem paths (L66-72)

**Option Filtering** (L83-86): 
- Removes already-specified options from suggestions
- Filters by current input prefix

**Main Parser Fallback** (L104-120): When no subcommand detected, provides main parser options or subcommands

## Architecture Notes
- Uses `sys.exit(1)` to terminate after printing completions
- Integrates with bash completion via environment variables
- Supports both option completion and context-aware path/package completion
- Handles edge cases like permission errors and empty completion lists