# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/metadata/base.py
@source-hash: 7edd0ae573602381
@generated: 2026-02-09T17:58:45Z

**Primary Purpose**: Base protocol definitions and utilities for Python package metadata introspection within pip's internal metadata system. Provides abstract interfaces for distributions, environments, entry points, and wheels.

**Key Classes & Protocols**:

- **BaseEntryPoint (L49-61)**: Protocol defining entry point interface with `name`, `value`, and `group` properties
- **RequiresEntry (L93-97)**: NamedTuple for legacy dependency entries with `requirement`, `extra`, and `marker` fields
- **BaseDistribution (L99-580)**: Core protocol for package distribution metadata
  - Factory methods: `from_directory()` (L100-106), `from_metadata_file_contents()` (L108-124), `from_wheel()` (L126-138)
  - Location properties: `location` (L146-158), `installed_location` (L182-193), `info_location` (L195-209)
  - Installation format detection: `installed_by_distutils` (L211-222), `installed_as_egg` (L224-234), `installed_with_setuptools_egg_info` (L236-252), `installed_with_dist_info` (L254-268)
  - Metadata access: `metadata` (cached, L385-396), `metadata_dict` (L398-407), `direct_url` (L290-314)
  - Dependency iteration: `iter_dependencies()` (L440-446), `iter_raw_dependencies()` (L448-450)
  - File introspection: `iter_declared_entries()` (L493-507), `read_text()` (L370-377)
- **BaseEnvironment (L582-665)**: Protocol for managing collections of distributions
  - Factory methods: `default()` (L585-587), `from_paths()` (L589-591)
  - Distribution access: `get_distribution()` (L593-599), `iter_all_distributions()` (L610-629)
  - Filtering: `iter_installed_distributions()` (L631-664) with options for local-only, editables, user-site
- **Wheel Protocols**: `Wheel` (L667-672), `FilesystemWheel` (L674-680), `MemoryWheel` (L682-688)

**Key Functions**:
- **_convert_installed_files_path() (L63-90)**: Converts legacy installed-files.txt paths to modern RECORD format using path manipulation without symlink resolution

**Dependencies**: 
- External: `packaging` library for requirements/versions, `email.message` for metadata parsing
- Internal: pip utilities for locations, compatibility, direct URLs, egg links

**Architectural Patterns**:
- Protocol-based design with abstract methods requiring implementation by concrete subclasses
- Cached property pattern for expensive metadata operations (L385)
- Legacy format support with graceful fallbacks (egg-info → dist-info → distutils)
- Path normalization strategies that preserve symlinks where appropriate

**Critical Invariants**:
- Distribution names must follow PEP 508 pattern validation (L617-621)
- Metadata parsing includes automatic egg-info requires.txt integration (L572-579)
- Location properties preserve relative paths and avoid canonicalization to maintain symlink integrity
- Dependency parsing normalizes extra names for PEP 517 backend compatibility (L552-555)