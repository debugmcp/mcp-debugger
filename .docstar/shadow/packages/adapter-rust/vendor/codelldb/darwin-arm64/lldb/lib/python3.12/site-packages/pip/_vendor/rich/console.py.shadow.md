# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/console.py
@source-hash: 75e15922e6ead8cf
@generated: 2026-02-09T17:59:22Z

## Primary Purpose
Main console module for Rich - provides Console class for high-level terminal output with color, styling, markup, and various rendering capabilities. Core component that orchestrates rich text rendering, buffering, and output to terminals, Jupyter notebooks, or files.

## Key Classes and Functions

### ConsoleDimensions (L116-123)
NamedTuple defining terminal dimensions with width/height properties.

### ConsoleOptions (L125-257) 
Dataclass encapsulating rendering options including size constraints, terminal capabilities, and formatting preferences. Key methods:
- `update()` (L170-205): Creates modified copy with updated parameters
- `update_width()`/`update_height()` (L207-231): Dimension-specific updates
- `ascii_only` property (L155-158): Checks encoding for ASCII-only rendering

### Console (L594-2566)
Main high-level console interface with extensive configuration options. Core responsibilities:

#### Initialization & Detection (L632-755)
- Auto-detects terminal capabilities, color systems, Jupyter environment
- Configures color system based on environment variables and platform
- Sets up thread-local storage and rendering hooks

#### Core Properties
- `file` property (L759-771): Output stream management
- `size`/`width`/`height` properties (L992-1083): Terminal dimension handling
- `is_terminal`/`is_dumb_terminal` (L931-977): Terminal capability detection
- `color_system` property (L909-920): Returns color system name

#### Rendering Pipeline
- `render()` (L1287-1336): Core rendering method - converts renderables to Segments
- `render_lines()` (L1338-1395): Renders to list of line segments
- `render_str()` (L1397-1454): Converts strings to Text with styling/highlighting
- `_collect_renderables()` (L1486-1559): Combines objects into renderable list

#### Output Methods
- `print()` (L1624-1721): Main output method with extensive formatting options
- `print_json()` (L1723-1782): Pretty-prints JSON data
- `out()` (L1592-1622): Low-level output without formatting
- `log()` (L1908-1987): Logging with timestamp and caller information

#### Context Managers & Controls
- `capture()` (L1089-1104): Returns Capture context manager
- `pager()` (L1106-1127): Returns PagerContext for paged output
- `screen()` (L1256-1268): Returns ScreenContext for alt screen mode
- `control()` (L1582-1590): Inserts control codes

#### Export Capabilities
- `export_text()`/`save_text()` (L2126-2170): Plain text export
- `export_html()`/`save_html()` (L2172-2276): HTML export with styling
- `export_svg()`/`save_svg()` (L2278-2565): SVG export with terminal appearance

### Context Manager Classes
- `Capture` (L323-354): Captures console output as string
- `ThemeContext` (L356-374): Temporary theme application  
- `PagerContext` (L377-413): Paged output display
- `ScreenContext` (L416-461): Alternative screen mode

### Utility Classes
- `NewLine` (L293-302): Renderable for line breaks
- `ScreenUpdate` (L305-320): Updates screen at specific coordinates
- `Group` (L463-494): Combines multiple renderables
- `RenderHook` (L557-573): Abstract base for render processing hooks

### Protocol Definitions
- `RichCast` (L259-266): Objects convertible to renderables via `__rich__()`
- `ConsoleRenderable` (L269-276): Objects with `__rich_console__()` method

## Key Constants & Type Definitions
- `RenderableType` (L280): Union type for anything Console can render
- `COLOR_SYSTEMS` (L538-543): Maps color system names to enum values
- `_TERM_COLORS` (L109-113): Terminal color capability mapping
- Jupyter defaults (L77-78): Default dimensions for notebook environments

## Threading & Concurrency
- `ConsoleThreadLocals` (L548-554): Thread-local storage for themes and buffers
- Uses `threading.RLock()` for thread-safe operations (L727, L747)
- Buffer management with thread-local access patterns

## Platform-Specific Handling
- Windows legacy console detection and rendering (L2010-2027)
- Unix terminal size detection via file descriptors (L1015-1021)
- Jupyter notebook integration (L2004-2007)

## Notable Patterns
- Extensive use of optional parameters with sentinel values (NO_CHANGE pattern)
- Lazy evaluation of terminal properties with caching
- Plugin architecture via render hooks
- Protocol-based rendering system for extensibility
- Comprehensive export system supporting multiple formats