# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/syntax.py
@source-hash: 4e7643b8e0f80de1
@generated: 2026-02-09T17:59:23Z

## Rich Syntax Highlighting Module

This module provides syntax highlighting functionality for code using Pygments as the underlying tokenizer and Rich's rendering system.

### Core Classes

**SyntaxTheme (L123-135)**: Abstract base class defining the interface for syntax themes. Requires implementations of `get_style_for_token()` and `get_background_style()` methods.

**PygmentsSyntaxTheme (L137-177)**: Concrete theme implementation that delegates to Pygments style classes. Caches styles for performance and handles color conversion from Pygments format to Rich Style objects.

**ANSISyntaxTheme (L179-210)**: Theme implementation using predefined ANSI color mappings. Implements hierarchical token matching - searches from most specific token type to least specific (e.g., `("foo", "bar", "baz")` → `("foo", "bar")` → `("foo")`).

**Syntax (L227-812)**: Main class for rendering syntax-highlighted code. Key features:
- Supports both string lexer names and Lexer instances
- Optional line numbers with customizable styling
- Word wrapping and line range selection
- Custom background colors and padding
- Indent guides visualization
- Line highlighting capabilities
- Range-based custom styling via `stylize_range()`

### Key Methods

**Syntax.from_path() (L301-362)**: Class method to create Syntax instances from file paths with automatic lexer detection.

**Syntax.guess_lexer() (L364-404)**: Intelligent lexer detection using filename and optional code content. Falls back to extension-based detection.

**Syntax.highlight() (L452-535)**: Core highlighting method that tokenizes code and applies theme styles. Handles line range optimization and custom stylized ranges.

**Syntax.__rich_console__() (L618-628)**: Rich protocol implementation for console rendering with optional padding.

**Syntax._get_syntax() (L629-762)**: Main rendering logic handling line numbers, word wrapping, and various display options.

### Theme Configuration

**ANSI_LIGHT/ANSI_DARK (L61-117)**: Predefined color schemes mapping Pygments token types to Rich Style objects. Used by `RICH_SYNTAX_THEMES` dictionary.

**DEFAULT_THEME (L56)**: Set to "monokai" as the default Pygments theme.

### Utility Functions

**_get_code_index_for_syntax_position() (L814-838)**: Converts line/column positions to string indices for range styling, with bounds checking and clamping.

### Dependencies
- Pygments: Lexical analysis and tokenization
- Rich: Console rendering, styling, and text manipulation
- Standard library: Path handling, regex, platform detection

### Architecture Patterns
- Strategy pattern for theme implementations
- Caching for performance (style caches in both theme classes)
- Lazy evaluation of lexer objects
- Rich protocol compliance for seamless integration
- Factory methods for common construction patterns

The module provides a high-level interface for syntax highlighting while maintaining flexibility through its theme system and extensive customization options.