# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/spinners.py
@source-hash: 84827cdc67ab7458
@generated: 2026-02-09T17:58:28Z

## Purpose
Provides spinner implementations for pip's CLI to show progress during long-running operations. Handles both interactive (TTY) and non-interactive environments with appropriate visual feedback and rate limiting.

## Core Architecture

### SpinnerInterface (L14-20)
Abstract base defining the spinner contract:
- `spin()`: Update spinner display
- `finish(final_status)`: Complete spinner with status message

### InteractiveSpinner (L22-69)
Visual spinner for TTY environments with animated characters:
- **Constructor (L23-41)**: Sets up message display, spin characters (default "-\\|/"), rate limiting (8 updates/sec)
- **_write() (L43-53)**: Terminal manipulation using backspace sequences to overwrite previous output
- **spin() (L55-60)**: Cycles through spin characters if rate limiter allows
- **finish() (L62-68)**: Writes final status and newline, marks as finished

Key behavior: Writes initial message with "..." suffix, then overwrites with spinning characters.

### NonInteractiveSpinner (L75-98)  
Logging-based spinner for non-TTY environments:
- **Constructor (L76-80)**: Uses 60-second intervals by default for keep-alive functionality
- **_update() (L82-85)**: Logs status messages via logger.info()
- **spin() (L87-92)**: Periodic "still running..." updates
- **finish() (L94-98)**: Final status logging

Designed for CI environments that need periodic output to prevent timeout.

### RateLimiter (L101-113)
Time-based update throttling:
- **ready() (L106-109)**: Checks if minimum interval has elapsed
- **reset() (L111-112)**: Updates last update timestamp

### Context Managers

#### open_spinner() (L115-136)
Main entry point - automatically selects appropriate spinner type:
- **Logic (L122-125)**: Uses InteractiveSpinner for TTY + INFO logging level, otherwise NonInteractiveSpinner  
- **Exception handling (L129-136)**: Ensures proper cleanup with status ("canceled", "error", "done")

#### hidden_cursor() (L143-159)
Terminal cursor management using ANSI escape codes:
- **ANSI constants (L139-140)**: Hide/show cursor sequences
- **Platform/context awareness (L147-153)**: Skips on Windows, non-TTY, or quiet mode

## Dependencies
- `pip._internal.utils.compat.WINDOWS`: Platform detection
- `pip._internal.utils.logging.get_indentation()`: Console formatting alignment

## Key Patterns
- **Strategy pattern**: SpinnerInterface with environment-specific implementations
- **Rate limiting**: Prevents excessive updates that could impact performance
- **Graceful degradation**: Falls back to logging-based updates in non-interactive environments
- **Resource cleanup**: Context managers ensure proper spinner termination and cursor restoration