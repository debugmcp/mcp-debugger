# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/models/direct_url.py
@source-hash: b81b58d871dddd33
@generated: 2026-02-09T17:58:36Z

## Purpose
Implements PEP 610 direct URL metadata specification for pip package installation tracking. Provides structured representation of package installation sources (VCS, archive, or local directory) with JSON serialization support.

## Core Classes

### DirectUrl (L158-224)
Main data structure representing a direct URL installation source.
- `url`: Source URL string
- `info`: Installation type info (VcsInfo, ArchiveInfo, or DirInfo)
- `subdirectory`: Optional subdirectory path within source
- `redacted_url` property (L179-189): Returns URL with credentials removed per PEP 610 rules
- `validate()` (L191-192): Validates structure via round-trip serialization
- `from_dict()`/`to_dict()` (L194-214): Dictionary conversion for JSON serialization
- `from_json()`/`to_json()` (L216-221): Direct JSON string conversion
- `is_local_editable()` (L223-224): Checks if installation is editable local directory

### VcsInfo (L69-93)
Version control system installation metadata (dataclass).
- `vcs`: VCS type string (git, hg, etc.)
- `commit_id`: Actual commit hash
- `requested_revision`: Optional originally requested revision
- `_from_dict()`/`_to_dict()` (L77-92): Serialization methods

### ArchiveInfo (L95-137)
Archive-based installation metadata with hash validation.
- `hash` property (L107-127): Legacy single hash with auto-upgrade to `hashes` dict
- `hashes`: Dictionary of algorithm:value hash pairs
- Hash setter automatically populates `hashes` from legacy `hash` format
- `_from_dict()`/`_to_dict()` (L129-136): Serialization methods

### DirInfo (L139-153)
Local directory installation metadata (dataclass).
- `editable`: Boolean flag for editable installations
- `_from_dict()`/`_to_dict()` (L145-152): Serialization methods

## Key Functions

### Validation Helpers
- `_get()` (L27-38): Type-safe dictionary value extraction with defaults
- `_get_required()` (L41-47): Required field extraction with validation
- `_exactly_one_of()` (L50-61): Ensures exactly one info type is provided
- `_filter_none()` (L64-66): Removes None values from dictionaries

### URL Processing
- `_remove_auth_from_netloc()` (L164-176): Strips authentication from URLs except for git users and environment variables

## Constants & Patterns
- `DIRECT_URL_METADATA_NAME` (L19): Standard filename "direct_url.json"
- `ENV_VAR_RE` (L20): Regex for environment variable format validation
- `InfoType` (L155): Union type for all info classes

## Error Handling
- `DirectUrlValidationError` (L23-24): Custom exception for validation failures

## Architecture Notes
- Follows PEP 610 specification for direct URL metadata
- Uses dataclasses for VcsInfo and DirInfo, regular class for ArchiveInfo due to property requirements
- Implements credential redaction for security while preserving git user and environment variables
- Supports both legacy single hash and modern multi-hash formats with automatic upgrade
- All info classes follow consistent `_from_dict`/`_to_dict` pattern for polymorphic serialization