# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/__init__.py
@source-hash: d7fcccffbf61c71b
@generated: 2026-02-09T17:57:29Z

## Purpose
Main entry point for Pygments formatter discovery and instantiation. Provides unified API for loading formatters by name, filename patterns, or from custom files with lazy-loading and caching mechanisms.

## Core Architecture

**Caching System**
- `_formatter_cache` (L24): Maps formatter names to loaded classes for performance
- `_pattern_cache` (L25): Caches compiled filename pattern regexes
- Lazy loading: Formatters only imported when first accessed

**Formatter Discovery**
- `FORMATTERS` mapping: Static registry of built-in formatters from `_mapping.py`
- Plugin system: Dynamic discovery via `find_plugin_formatters()` 
- Auto-import module: `_automodule` class replaces this module to enable attribute-based formatter access

## Key Functions

**`get_formatter_by_name(_alias, **options)` (L70-81)**
- Primary API for formatter instantiation by alias
- Raises `ClassNotFound` if formatter not found

**`get_formatter_for_filename(fn, **options)` (L119-138)**
- Matches formatters by filename patterns using glob matching
- Uses `_fn_matches()` helper with cached regex compilation

**`load_formatter_from_file(filename, formattername="CustomFormatter", **options)` (L84-116)**
- Dynamically loads custom formatter classes from Python files
- Security risk: Uses `exec()` on file contents
- Added in version 2.2

**`find_formatter_class(alias)` (L55-67)**
- Low-level formatter lookup without instantiation
- Searches both built-in and plugin formatters

**`get_all_formatters()` (L44-52)**
- Generator yielding all available formatter classes
- Combines built-in and plugin formatters

## Helper Functions

**`_load_formatters(module_name)` (L36-41)**
- Imports formatter module and caches all contained formatter classes
- Populates `_formatter_cache` with module's `__all__` exports

**`_fn_matches(fn, glob)` (L28-33)**
- Filename pattern matching with regex caching
- Converts glob patterns to compiled regexes

## Module Replacement Pattern

**`_automodule` class (L141-151)**
- Intercepts attribute access to enable `pygments.formatters.FormatterName` syntax
- `__getattr__` triggers lazy loading when formatter accessed as module attribute
- Lines 154-158: Replaces current module in `sys.modules` with automodule instance

## Dependencies
- `fnmatch`, `re`: Filename pattern matching
- `pip._vendor.pygments.formatters._mapping.FORMATTERS`: Static formatter registry
- `pip._vendor.pygments.plugin.find_plugin_formatters`: Plugin discovery
- `pip._vendor.pygments.util.ClassNotFound`: Exception for missing formatters

## Critical Constraints
- All formatter classes must have `name`, `aliases`, and `filenames` attributes
- Plugin formatters must follow same interface as built-in formatters
- Custom formatter loading via `exec()` poses security implications