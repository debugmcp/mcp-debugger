# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/tenacity/tornadoweb.py
@source-hash: a68dbdfc5d4cb7ca
@generated: 2026-02-09T17:59:14Z

## Primary Purpose
Tornado web framework integration for the tenacity retry library, providing async/coroutine-based retry capabilities using Tornado's gen.coroutine decorator and Future-based sleep mechanism.

## Key Components

### TornadoRetrying Class (L31-59)
- **Inherits from**: `BaseRetrying` from tenacity core
- **Purpose**: Implements retry logic specifically for Tornado coroutines and async operations
- **Constructor (L32-34)**: 
  - Accepts custom sleep function (defaults to `gen.sleep`)
  - Forwards all other kwargs to parent BaseRetrying class
- **__call__ method (L36-59)**: 
  - Decorated with `@gen.coroutine` for Tornado async compatibility
  - Accepts functions that return either Tornado Generators or Futures
  - Returns a Generator that yields the final result

### Core Retry Loop Logic (L46-59)
- Creates `RetryCallState` to track retry attempts (L45)
- Infinite loop that:
  - Calls `self.iter()` to determine next action (L47)
  - **DoAttempt**: Executes the target function with exception handling (L48-54)
  - **DoSleep**: Yields to sleep function for retry delay (L55-57)
  - **Other**: Returns final result using `gen.Return` (L58-59)

## Dependencies
- **tenacity**: Core retry classes (`BaseRetrying`, `DoAttempt`, `DoSleep`, `RetryCallState`)
- **tornado**: Web framework (`gen.coroutine`, `gen.sleep`, `gen.Return`)
- **typing**: Type annotations including `Future` type checking

## Architectural Patterns
- **Adapter Pattern**: Adapts tenacity's synchronous retry mechanism for Tornado's async model
- **Generator-based Async**: Uses Tornado's pre-async/await generator pattern
- **Type Safety**: Comprehensive type annotations with generic `_RetValT` type variable (L28)

## Key Behaviors
- Exception handling preserves full exception info via `sys.exc_info()` (L52)
- Sleep operations are yielded to Tornado's event loop (L57)
- Results are returned using Tornado's `gen.Return` mechanism (L59)
- Supports both Generator and Future return types from target functions