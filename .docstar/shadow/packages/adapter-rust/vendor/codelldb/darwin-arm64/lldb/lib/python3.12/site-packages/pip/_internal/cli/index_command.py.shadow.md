# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/index_command.py
@source-hash: 1a658bf36ce9cd2e
@generated: 2026-02-09T17:58:24Z

## Primary Purpose
Base classes for pip CLI commands that interact with package indexes and the network. Provides session management and SSL context handling with lazy imports to avoid performance overhead for commands that don't always need network access.

## Key Classes and Functions

### `_create_truststore_ssl_context()` (L27-42)
Creates an SSL context using the truststore library for enhanced certificate validation.
- Requires Python 3.10+
- Falls back gracefully if SSL or truststore unavailable
- Returns `Optional[SSLContext]`

### `SessionCommandMixin` (L45-132)
Core mixin providing HTTP session management for pip commands.
- **`_session`** (L52): Cached PipSession instance
- **`_get_index_urls()`** (L55-66): Extracts index URLs from command options, returns None for empty lists
- **`get_default_session()`** (L68-76): Lazy session initialization with context management
- **`_build_session()`** (L78-132): Comprehensive session factory with:
  - Cache directory configuration (L87-88)
  - Optional truststore SSL context (L90-98) 
  - Proxy configuration (L121-126)
  - Authentication settings (L129-130)
  - Timeout and certificate handling (L109-118)

### `IndexGroupCommand` (L141-172)
Abstract base for commands supporting index operations and version checking.
- **`handle_pip_version_check()`** (L148-172): Conditional pip version check with fallback SSL context

### `_pip_self_version_check()` (L135-138)
Wrapper function for pip self-update checking.

## Key Dependencies
- `pip._internal.cli.base_command.Command`: Base command class
- `pip._internal.cli.command_context.CommandContextMixIn`: Context management
- `pip._internal.network.session.PipSession`: HTTP session implementation (lazy import)
- `pip._vendor.truststore`: Enhanced SSL certificate validation (optional)

## Architectural Patterns
- **Lazy imports**: Network-related modules imported only when needed to improve startup performance
- **Mixin pattern**: `SessionCommandMixin` provides reusable session management
- **Context management**: Sessions properly managed with enter_context pattern
- **Fallback handling**: Graceful degradation when truststore unavailable

## Critical Constraints
- Cache directory must be absolute path (L88 assertion)
- Truststore requires Python 3.10+ (L28-29)
- Index URLs return None instead of empty list for consistency (L65-66)
- Session timeout limited to 5 seconds for version checks (L164)