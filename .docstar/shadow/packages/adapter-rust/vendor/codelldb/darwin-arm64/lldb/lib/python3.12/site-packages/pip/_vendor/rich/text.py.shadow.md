# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/text.py
@source-hash: e6b437cef36b8395
@generated: 2026-02-09T17:59:31Z

This file implements Rich library's text rendering system with styling and formatting capabilities. It provides two main classes for creating styled terminal text output.

## Primary Purpose
Core text representation system for the Rich library, enabling styled text creation, manipulation, and rendering to terminals with advanced formatting features like alignment, wrapping, and style spans.

## Key Classes and Functions

### Span (L46-115)
`NamedTuple` representing a styled text region with start/end positions and associated style.
- `split(offset)` (L62-73): Splits span at given offset into two spans
- `move(offset)` (L75-85): Shifts span positions by offset amount
- `right_crop(offset)` (L87-99): Truncates span at given offset
- `extend(cells)` (L101-114): Extends span by specified cell count

### Text (L117-1330)
Main text class supporting styled text creation and manipulation. Inherits from `JupyterMixin`.

**Construction Methods:**
- `__init__` (L143-164): Basic constructor with text, style, justification, overflow options
- `from_markup()` (L258-290): Creates Text from console markup strings
- `from_ansi()` (L292-328): Creates Text from ANSI escape sequences  
- `styled()` (L330-353): Creates Text with pre-applied style
- `assemble()` (L355-399): Combines multiple text parts with optional styles

**Core Properties:**
- `plain` (L401-417): Gets/sets raw text content, sanitizes control codes
- `spans` (L419-427): Gets/sets internal style span list
- `cell_len` (L223-226): Returns cell width for terminal rendering
- `markup` (L228-256): Generates console markup representation

**Text Manipulation:**
- `stylize()` (L456-480): Applies style to text range
- `stylize_before()` (L482-506): Applies style with lower precedence
- `apply_meta()` (L508-520): Applies metadata as style
- `highlight_regex()` (L592-628): Highlights text matching regex patterns
- `highlight_words()` (L630-657): Highlights specified words
- `append()` (L962-1004): Adds text/Text instances with optional styling
- `append_text()` (L1006-1026): Optimized Text-only append method
- `append_tokens()` (L1028-1049): Appends iterable of (text, style) tuples

**Formatting Operations:**
- `truncate()` (L857-882): Clips text to maximum width with overflow handling
- `pad()` (L898-913): Adds padding characters on both sides
- `pad_left()`/`pad_right()` (L915-940): Directional padding
- `align()` (L942-960): Aligns text within specified width
- `expand_tabs()` (L815-855): Converts tabs to spaces with proper alignment

**Text Division:**
- `split()` (L1059-1101): Splits text on separator preserving styles
- `divide()` (L1103-1180): Divides text at specific offsets using binary search
- `wrap()` (L1198-1244): Word wraps text with justification support
- `fit()` (L1246-1260): Fits text to width by line chopping

**Advanced Features:**
- `join()` (L776-813): Joins Text instances with separator
- `detect_indentation()` (L1262-1281): Auto-detects code indentation using GCD
- `with_indent_guides()` (L1283-1329): Adds visual indentation guides
- `render()` (L717-774): Converts to terminal Segments with style application
- `__rich_console__()` (L686-703): Rich protocol implementation for console rendering

## Key Dependencies
- `cells.cell_len`: Terminal cell width calculation
- `segment.Segment`: Basic rendering unit for terminal output  
- `style.Style`: Style representation and combination
- `_wrap.divide_line`: Text wrapping algorithm
- `control.strip_control_codes`: Input sanitization

## Architecture Patterns
- **Span-based styling**: Non-overlapping regions with individual styles managed in `_spans` list
- **Lazy text concatenation**: `_text` list holds text fragments, joined only when `plain` property accessed
- **Binary search optimization**: `divide()` method uses binary search for efficient span distribution
- **Style combination**: Overlapping spans combined using `Style.combine()`
- **Immutable operations**: Most methods return new instances rather than modifying existing

## Critical Invariants
- Text content always sanitized via `strip_control_codes()`
- `_length` tracks total character count across all `_text` fragments
- Span coordinates always relative to concatenated plain text
- Style spans automatically trimmed when text length changes