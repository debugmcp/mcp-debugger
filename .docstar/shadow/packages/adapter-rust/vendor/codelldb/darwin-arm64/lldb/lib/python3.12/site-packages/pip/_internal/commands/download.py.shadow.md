# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/commands/download.py
@source-hash: d2a0749f2b3a6443
@generated: 2026-02-09T17:58:27Z

## Purpose
Implements pip's `download` command functionality for downloading Python packages without installing them. Part of pip's internal command structure, handling package resolution and download operations to a specified directory.

## Key Components

### DownloadCommand (L18-146)
Main command class inheriting from `RequirementCommand`. Provides complete download workflow:
- **Docstring (L19-29)**: Documents supported download sources (PyPI, VCS, local projects, archives)
- **Usage patterns (L31-36)**: CLI syntax examples for different input types
- **add_options() (L38-75)**: Configures command-line options including destination directory, build options, and target Python settings
- **run() (L77-146)**: Core execution logic with cleanup decorator

### Core Execution Flow (run method)
1. **Setup (L79-87)**: Forces ignore_installed=True, normalizes download directory
2. **Session & Finder (L89-97)**: Creates HTTP session and package finder with target Python configuration  
3. **Build Infrastructure (L99-119)**: Sets up build tracker, temp directory, and requirement preparer
4. **Resolution (L121-132)**: Creates resolver and resolves requirement set with wheel support
5. **Download (L134-141)**: Iterates unsatisfied requirements, saves linked packages
6. **Finalization (L141-145)**: Prepares downloaded requirements and reports success

## Key Dependencies
- `RequirementCommand`: Base class providing requirement handling infrastructure
- `cmdoptions`: Provides standardized command-line option definitions
- `get_build_tracker()`: Build tracking for download operations
- `TempDirectory`: Temporary workspace management
- `normalize_path()`, `ensure_dir()`: Path utilities

## Architecture Notes
- Uses context managers for resource cleanup (`@with_cleanup`, `enter_context`)
- Separates package finding, resolution, and preparation phases
- Downloads only unsatisfied requirements (L136: `req.satisfied_by is None`)
- Supports both individual packages and requirements files
- Integrates with pip's broader requirement resolution system

## Critical Behavior
- Always sets `ignore_installed=True` (L79) since download doesn't check local installs
- Uses globally managed temp directory for build operations
- Downloads to current directory by default (`os.curdir`, L63)
- Reports downloaded package names on successful completion