# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/lexers/python.py
@source-hash: 0f37870665b52314
@generated: 2026-02-09T17:57:39Z

## Core Purpose
Pygments lexer module for Python and Python-related languages, providing comprehensive syntax highlighting support for Python 2.x, Python 3.x, console sessions, tracebacks, and extended languages like Cython, dg, and NumPy.

## Primary Lexer Classes

**PythonLexer (L26-414)** - Main Python 3.x lexer
- Inherits from RegexLexer, handles Python 3.x syntax with modern features
- Supports f-strings, pattern matching (match/case), async/await, type hints
- Complex token definitions covering expressions, keywords, built-ins, magic methods/variables
- Key helper methods: `innerstring_rules(ttype)` (L67-85), `fstring_rules(ttype)` (L87-99)
- Text analysis via `analyse_text(text)` (L409-411) using shebang detection

**Python2Lexer (L417-637)** - Legacy Python 2.x lexer  
- Similar structure to PythonLexer but with Python 2-specific features
- Includes backtick support, different built-ins (print statement, long integers)
- No f-string or async/await support

**PythonConsoleLexer (L674-718)** - Interactive Python session lexer
- DelegatingLexer combining _PythonConsoleLexerBase (L638-672) for prompt parsing
- Handles >>> and ... prompts, traceback detection
- Configurable Python version via `python3` option

**PythonTracebackLexer (L720-773)** - Python 3.x traceback lexer
- Parses exception tracebacks with chained exception support
- Handles PEP 657 error location markers (Python 3.11+)

**Python2TracebackLexer (L777-823)** - Python 2.x traceback lexer
- Similar to Python 3 version but without chained exceptions

**CythonLexer (L825-1003)** - Cython/Pyrex language lexer
- Extends Python with C-type annotations, cdef/cpdef keywords
- Additional built-ins like `bint`, `Py_ssize_t`, `NULL`

**DgLexer (L1005-1102)** - dg language lexer
- Functional programming language running on CPython 3
- Unique operator syntax with backticks and specialized built-ins

**NumPyLexer (L1104-1198)** - NumPy-enhanced Python lexer
- Extends PythonLexer with 300+ NumPy-specific keywords
- Overrides `get_tokens_unprocessed()` to highlight NumPy functions as Keyword.Pseudo

## Key Architecture Patterns

**Token State Machines**: Extensive use of nested state definitions for complex parsing (strings, f-strings, expressions)

**String Handling**: Sophisticated support for various string types:
- Raw strings, unicode strings, bytes, f-strings with expression interpolation
- Escape sequence handling across different string contexts

**Delegating Pattern**: Console lexer uses delegation to combine prompt parsing with code highlighting

**Inheritance Hierarchy**: NumPyLexer extends PythonLexer, aliases like Python3Lexer = PythonLexer (L414, L774)

## Dependencies
- `pip._vendor.pygments.lexer`: Core lexing framework
- `pip._vendor.pygments.token`: Token type definitions  
- `pip._vendor.pygments.util`: Utility functions (shebang_matches, get_bool_opt)
- `pip._vendor.pygments.unistring`: Unicode identifier support
- Standard library: `re`, `keyword`

## Critical Features
- F-string expression parsing with nested brace handling (L184-203)
- Soft keyword detection for pattern matching (L221-234)
- Magic method/variable recognition (L276-309)
- Comprehensive number literal support including underscores (L310-318)
- Import statement parsing with namespace highlighting (L332-347)