# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/vcs/mercurial.py
@source-hash: a142ce8732765227
@generated: 2026-02-09T17:58:42Z

**Primary Purpose**: Implements Mercurial (hg) version control system support for pip's VCS operations, enabling pip to install packages from Mercurial repositories.

**Core Class**:
- `Mercurial` (L20-161): Main VCS adapter class extending `VersionControl`, providing complete Mercurial repository management functionality

**Key Configuration**:
- Supports schemes: hg+file, hg+http, hg+https, hg+ssh, hg+static-http (L24-30)
- Repository identifier: `.hg` directory (L22)
- Clone operation name: "clone" (L23)

**Core Operations**:
- `get_base_rev_args()` (L32-34): Formats revision arguments for hg commands
- `fetch_new()` (L36-58): Clones new repository with verbosity control and updates to specified revision
- `switch()` (L60-72): Changes repository URL by modifying `.hg/hgrc` config file, handles config errors gracefully
- `update()` (L74-77): Pulls latest changes and updates to specified revision

**Repository Introspection**:
- `get_remote_url()` (L79-89): Retrieves default remote URL, converts local paths to file URLs
- `get_revision()` (L91-102): Returns local changeset revision number as integer using `{rev}` template
- `get_requirement_revision()` (L104-116): Returns 40-character hexadecimal changeset hash using `{node}` template
- `get_subdirectory()` (L123-135): Finds Python project root relative to repository root
- `get_repository_root()` (L137-160): Determines repository root with error handling for missing hg binary

**Special Behaviors**:
- `is_commit_id_equal()` (L118-121): Always returns False, forcing version checks to assume mismatch
- Comprehensive error handling for missing hg binary and repository access issues
- Verbosity-aware command execution with appropriate flags

**Dependencies**: 
- Inherits from `VersionControl` base class
- Uses `configparser` for `.hg/hgrc` manipulation
- Integrates with pip's command execution and URL utilities

**Registration**: Automatically registers with pip's VCS system (L163)