# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/url.py
@source-hash: 942004ecce66c80f
@generated: 2026-02-09T17:57:32Z

**Purpose**: URL parsing and validation module for urllib3, providing RFC 3986/6874 compliant URL parsing with normalization capabilities.

**Core Classes**:
- `Url` (L82-173): Immutable namedtuple representing parsed URL components with attributes: scheme, auth, host, port, path, query, fragment
  - `__new__` (L91-107): Constructor that normalizes scheme to lowercase and ensures path starts with "/"
  - `hostname` property (L110-112): Backward-compatibility alias for host
  - `request_uri` property (L115-122): Returns path + query string for HTTP requests
  - `netloc` property (L125-129): Returns host:port combination
  - `url` property (L132-169): Reconstructs full URL string from components

**Key Functions**:
- `parse_url(url)` (L333-427): Main parsing function that accepts URL string and returns Url object
  - Handles scheme detection, authority parsing, host normalization, percent-encoding
  - Validates port ranges (0-65535)
  - Applies RFC 3986 path normalization for HTTP(S) schemes
- `split_first(s, delims)` (L175-207): **DEPRECATED** utility for string splitting on first delimiter
- `get_host(url)` (L430-435): **DEPRECATED** wrapper around parse_url

**Helper Functions**:
- `_normalize_host(host, scheme)` (L274-302): Normalizes hostnames including IPv6 zone handling and IDNA encoding
- `_idna_encode(name)` (L305-321): Encodes international domain names using IDNA
- `_encode_invalid_chars(component, allowed_chars)` (L210-241): Percent-encodes URI components while preserving existing encodings
- `_remove_path_dot_segments(path)` (L244-271): Implements RFC 3986 path normalization (removes . and .. segments)
- `_encode_target(target)` (L323-330): Encodes request target (path + query)

**Constants & Patterns**:
- `url_attrs` (L9): Defines URL component field names
- `NORMALIZABLE_SCHEMES` (L13): HTTP/HTTPS schemes eligible for normalization
- Regex patterns (L17-71): Comprehensive URI parsing patterns including IPv4/IPv6, percent-encoding
- Character sets (L73-79): Allowed characters for different URI components per RFC 3986

**Dependencies**:
- `..exceptions.LocationParseError`: Custom exception for parsing failures
- `..packages.six`: Python 2/3 compatibility utilities
- `pip._vendor.idna` (optional): International domain name encoding

**Key Behaviors**:
- Automatically prepends "//" to URLs without schemes for parsing
- Normalizes schemes and hosts to lowercase for HTTP(S)
- Handles IPv6 addresses with zone identifiers per RFC 6874
- Preserves existing percent-encoding while encoding invalid characters
- Provides backward compatibility with urlparse module