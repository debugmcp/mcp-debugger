# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/_elffile.py
@source-hash: fcb7095b860d2b2c
@generated: 2026-02-09T17:58:48Z

## ELF File Parser

**Primary Purpose:** Provides read-only parsing of ELF (Executable and Linkable Format) executable files with a ZipFile-like interface.

### Key Classes and Components

**ELFInvalid (L19-20):** Exception raised for invalid ELF file format or parsing errors.

**Architecture Enums (L23-39):**
- `EIClass`: Defines 32-bit (1) and 64-bit (2) architectures
- `EIData`: Defines little-endian (1) and big-endian (2) byte ordering  
- `EMachine`: Defines CPU architectures (I386=3, ARM=40, x86_64=62, AArch64=183, S390=22)

**ELFFile (L41-110):** Main parser class that reads ELF headers and extracts metadata.

### Key Methods

**`__init__(self, f: IO[bytes])` (L46-91):**
- Validates ELF magic number (`\x7fELF`)
- Parses identification header to determine bitness and endianness
- Sets up format strings for different architecture combinations
- Extracts machine type, program header offset, flags, and section counts
- Raises `ELFInvalid` for malformed files

**`_read(self, fmt: str)` (L92-93):** Utility method that unpacks binary data using struct format strings.

**`interpreter` property (L95-110):** 
- Searches program headers for `PT_INTERP` section (type 3)
- Returns the interpreter path as decoded string, or None if not found
- Strips null terminators from the path

### Architecture Support Matrix

The parser handles four architecture/endianness combinations (L64-69):
- 32-bit LSB/MSB with format `<HHIIIIIHHH`/`>HHIIIIIHHH`  
- 64-bit LSB/MSB with format `<HHIQQQIHHH`/`>HHIQQQIHHH`

### Dependencies
- Uses `struct` for binary parsing
- `enum.IntEnum` for architecture constants
- `os.fsdecode()` for path decoding

### Critical Constraints
- Read-only interface - no modification capabilities
- Requires valid ELF magic number for initialization
- File pointer must support seek operations for header navigation
- Expects standard ELF header layout per Linux Foundation specification