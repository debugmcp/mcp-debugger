# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/requests/cookies.py
@source-hash: 6cd8be8aa123e0d3
@generated: 2026-02-09T17:59:07Z

## Purpose

Cookie compatibility layer that enables `http.cookiejar.CookieJar` to work with the requests library. Provides mock classes to bridge the interface gap between requests objects and standard library cookie handling, plus a dict-compatible CookieJar implementation.

## Core Classes

### MockRequest (L23-101)
Adapter that wraps `requests.Request` to mimic `urllib2.Request` interface expected by `http.cookiejar.CookieJar`. Key methods:
- `__init__(request)` (L35): Stores request, initializes new headers dict
- `get_full_url()` (L49): Returns URL, handling custom Host headers by reconstructing URL
- `add_unredirected_header(name, value)` (L84): Adds headers to `_new_headers` dict
- Properties for `host`, `origin_req_host`, `unverifiable` (L90-101)

### MockResponse (L103-122)
Minimal wrapper around `httplib.HTTPMessage` to expose headers in format expected by cookiejar.
- `info()` (L117): Returns wrapped headers object
- `getheaders(name)` (L120): Delegates to wrapped headers (missing return statement)

### RequestsCookieJar (L176-438)
Main cookie jar class extending `cookielib.CookieJar` with dict-like interface. Thread-safe and pickleable.

**Dict Interface Methods:**
- `get(name, default, domain, path)` (L194): O(n) lookup with optional domain/path filtering
- `set(name, value, **kwargs)` (L206): Creates and stores cookie, handles None values as deletion
- `__getitem__/__setitem__/__delitem__` (L327-347): Standard dict operations
- `keys/values/items()` and iter variants (L225-275): Dict-compatible iteration

**Cookie Management:**
- `set_cookie(cookie, *args, **kwargs)` (L349): Strips quotes from cookie values
- `update(other)` (L358): Merges from another CookieJar or dict
- `_find(name, domain, path)` (L366): Internal lookup, returns first match
- `_find_no_duplicates(name, domain, path)` (L386): Strict lookup, raises CookieConflictError on conflicts

**Utility Methods:**
- `list_domains()/list_paths()` (L277-291): Extract unique domains/paths
- `get_dict(domain, path)` (L306): Export filtered cookies as plain dict
- `copy()` (L428): Deep copy with policy preservation

## Key Functions

### extract_cookies_to_jar(jar, request, response) (L124-137)
Extracts cookies from urllib3 response into CookieJar using mock objects as adapters.

### get_cookie_header(jar, request) (L140-148)
Generates Cookie header string for outgoing request using mock request adapter.

### remove_cookie_by_name(cookiejar, name, domain, path) (L151-167)
O(n) cookie removal with optional domain/path filtering.

### create_cookie(name, value, **kwargs) (L455-489)
Factory function creating `cookielib.Cookie` objects with sensible defaults (domain='', path='/', supercookie behavior).

### morsel_to_cookie(morsel) (L492-518)
Converts `http.cookies.Morsel` objects to `cookielib.Cookie`, handling max-age and expires date parsing.

### Utility Functions
- `_copy_cookie_jar(jar)` (L440-452): Smart copying that preserves RequestsCookieJar methods
- `cookiejar_from_dict(cookie_dict, cookiejar, overwrite)` (L521-539): Dict to CookieJar conversion
- `merge_cookies(cookiejar, cookies)` (L542-561): Merges dict or CookieJar into existing jar

## Dependencies
- `http.cookiejar/cookielib`: Core cookie handling
- `._internal_utils.to_native_string`: String encoding utilities  
- `.compat`: Cross-version compatibility imports
- `threading`: For RLock in RequestsCookieJar

## Architecture Notes
- Uses adapter pattern extensively to bridge requests/urllib interfaces
- RequestsCookieJar warns that dict operations are O(n) due to linear cookie search
- Thread-safety via `_cookies_lock` RLock, properly handled in pickle operations
- Handles edge cases like quoted cookie values, missing return statements in MockResponse