# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/utils/encoding.py
@source-hash: aaab170ed8b03088
@generated: 2026-02-09T17:58:33Z

## Purpose
Utility module for automatic encoding detection and decoding of byte strings, primarily handling BOM (Byte Order Mark) detection and PEP 263 encoding declarations.

## Key Components

### Constants
- **BOMS** (L7-15): List of tuples mapping BOM byte sequences to their corresponding encoding names, covering UTF-8, UTF-16 (BE/LE), and UTF-32 (BE/LE) variants
- **ENCODING_RE** (L17): Compiled regex pattern `rb"coding[:=]\s*([-\w.]+)"` for detecting PEP 263 encoding declarations in source files

### Core Function
- **auto_decode()** (L20-36): Primary decoding function that takes raw bytes and returns decoded string using intelligent encoding detection

## Encoding Detection Strategy
1. **BOM Detection** (L24-26): Checks for Unicode BOM at start of data, strips BOM and decodes with corresponding encoding
2. **PEP 263 Declaration** (L27-33): Scans first two lines for `# coding:` or `# coding=` declarations, extracts encoding name and applies it
3. **System Fallback** (L34-36): Falls back to `locale.getpreferredencoding(False)` or `sys.getdefaultencoding()` as final resort

## Dependencies
- Standard library: `codecs`, `locale`, `re`, `sys`
- Type hints: `typing.List`, `typing.Tuple`

## Usage Pattern
Designed for pip's internal use when reading configuration files, requirement files, or any text data where encoding must be auto-detected. Mimics Python 3's `open()` behavior for encoding detection.