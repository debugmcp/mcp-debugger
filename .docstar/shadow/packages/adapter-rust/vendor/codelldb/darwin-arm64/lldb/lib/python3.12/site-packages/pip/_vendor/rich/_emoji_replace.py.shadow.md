# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/_emoji_replace.py
@source-hash: 9fe91c7adb04531d
@generated: 2026-02-09T17:58:57Z

## Purpose
Provides emoji code replacement functionality, converting text-based emoji codes (e.g., `:smile:`) into Unicode emoji characters with optional variant selection.

## Key Components

### Type Aliases (L7-9)
- `_ReStringMatch`: Type alias for regex match objects
- `_ReSubCallable`: Type alias for callable functions used by `re.sub`
- `_EmojiSubMethod`: Type alias for compiled regex substitution methods

### Core Function: `_emoji_replace` (L12-32)
Primary function that processes text to replace emoji codes with Unicode emoji characters.

**Parameters:**
- `text`: Input text containing emoji codes in format `:emoji_name:` or `:emoji_name-variant:`
- `default_variant`: Optional default variant ("text" or "emoji") 
- `_emoji_sub`: Pre-compiled regex substitution method (default: pattern `r"(:(\S*?)(?:(?:\-)(emoji|text))?:)"`)

**Implementation Details:**
- Uses closure pattern with `get_emoji` (L18) referencing `EMOJI.__getitem__` for performance
- Variant mapping (L19): "text" → U+FE0E, "emoji" → U+FE0F
- Inner function `do_replace` (L23-30) handles individual match replacement
- Graceful fallback: returns original code if emoji name not found (L30)

## Dependencies
- `EMOJI` dictionary from `._emoji_codes` module (L4)
- Standard library: `re`, `typing`

## Architecture Pattern
Uses functional approach with pre-compiled regex and closure optimization for performance in text processing pipelines.

## Behavior
- Matches emoji codes in format `:name:` or `:name-variant:`
- Case-insensitive emoji name matching (L26: `.lower()`)
- Supports Unicode variation selectors for text vs emoji presentation
- Returns original text if no matches found