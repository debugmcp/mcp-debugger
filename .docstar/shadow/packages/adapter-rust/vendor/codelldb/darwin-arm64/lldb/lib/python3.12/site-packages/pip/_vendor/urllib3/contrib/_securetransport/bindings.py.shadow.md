# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/_securetransport/bindings.py
@source-hash: e1793ae2a2243c1b
@generated: 2026-02-09T17:57:08Z

## Purpose
Low-level ctypes bindings for Apple's SecureTransport and CoreFoundation frameworks on macOS. Provides direct access to SSL/TLS functionality through C-level APIs for secure socket communication. This is a platform-specific adapter that only works on macOS 10.8+.

## Key Components

### Platform Validation (L53-62)
- Runtime checks ensure macOS-only operation and minimum version 10.8+
- Raises ImportError on non-Darwin platforms and OSError on unsupported macOS versions

### Dynamic Library Loading (L65-87)
- `load_cdll()` (L65-78): Custom loader handling macOS version differences, with fallback paths for macOS 10.16+ (Big Sur)
- Loads Security and CoreFoundation frameworks using absolute paths for newer macOS versions

### Type Definitions (L90-133)
Comprehensive ctypes type mappings for:
- CoreFoundation types: `CFString`, `CFArray`, `CFData`, `CFDictionary` etc. (L90-114)
- Security framework types: `SecCertificateRef`, `SSLContextRef`, `SecTrustRef` etc. (L116-133)
- All types use `c_void_p` pointers with proper reference semantics

### Function Binding Configuration (L135-420)
Massive try-catch block defining argument types and return types for 50+ API functions:

**Security Framework Functions:**
- Certificate operations: `SecItemImport` (L136), `SecCertificateCreateWithData` (L157)
- SSL context management: `SSLCreateContext` (L282), `SSLHandshake` (L216), `SSLRead`/`SSLWrite` (L219-223)
- Trust evaluation: `SecTrustEvaluate` (L273), `SecTrustSetAnchorCertificates` (L267)
- Cipher suite management: `SSLSetEnabledCiphers` (L238), `SSLGetNegotiatedCipher` (L255)

**CoreFoundation Functions:**
- Memory management: `CFRetain`/`CFRelease` (L328-332)
- String operations: `CFStringCreateWithCString` (L337), `CFStringGetCString` (L347)
- Collection operations: `CFArrayCreate` (L377), `CFDictionaryCreate` (L364)

### Function Type Definitions (L193-196)
- `SSLReadFunc`/`SSLWriteFunc`: Callback function types for custom I/O operations
- Used for socket-level SSL data transmission

### Constant Classes (L423-519)

**CFConst (L423-429):**
- CoreFoundation constants like `kCFStringEncodingUTF8`

**SecurityConst (L432-519):**
- SSL protocol versions: `kTLSProtocol12`, `kTLSProtocol13` etc. (L439-446)
- SSL error codes: `errSSLProtocol`, `errSSLWouldBlock` etc. (L463-486)
- Trust result types: `kSecTrustResultProceed`, `kSecTrustResultDeny` etc. (L453-461)
- Cipher suite constants: Complete mapping of TLS cipher suites (L488-519)

## Dependencies
- ctypes: Core FFI functionality
- ctypes.util.find_library: Dynamic library location
- platform: macOS version detection
- urllib3.packages.six: Python 2/3 compatibility

## Critical Architecture Notes
- Platform-locked to macOS with strict version enforcement
- Uses ctypes for direct C API access without wrapper overhead
- Handles macOS version differences in library loading paths
- Extensive error handling with ImportError fallbacks
- All function signatures must be explicitly defined for ctypes compatibility

## Error Handling
Comprehensive exception handling for library loading failures (L77-78, L419-420), with graceful ImportError raising when ctypes binding fails.