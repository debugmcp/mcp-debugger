# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/metadata/__init__.py
@source-hash: f695375b7b3ee87b
@generated: 2026-02-09T17:58:35Z

## Purpose

Backend selection and factory module for pip's metadata handling layer. Provides a unified interface for accessing package distribution metadata through either `importlib.metadata` (Python 3.11+) or `pkg_resources` backends.

## Key Components

### Backend Selection Logic
- `_should_use_importlib_metadata()` (L29-49): Determines backend choice based on Python version, environment variables, and distributor patches
- `select_backend()` (L58-66): Cached factory function that returns appropriate backend module (importlib or pkg_resources)

### Protocol Definition
- `Backend` (L52-55): Protocol defining required interface for backend implementations
  - `NAME`: Literal type for backend identification
  - `Distribution`: Type for distribution metadata handling
  - `Environment`: Type for environment representation

### Factory Functions
- `get_default_environment()` (L69-75): Creates default environment from sys.path
- `get_environment(paths)` (L79-86): Creates environment from custom paths
- `get_directory_distribution(directory)` (L89-95): Creates distribution from .dist-info directory
- `get_wheel_distribution(wheel, canonical_name)` (L98-106): Creates distribution from wheel
- `get_metadata_distribution(metadata_contents, filename, canonical_name)` (L109-128): Creates distribution from raw metadata bytes

## Dependencies

- Base classes from `.base`: `BaseDistribution`, `BaseEnvironment`, `FilesystemWheel`, `MemoryWheel`, `Wheel` (L9)
- Lazy imports: `.importlib` and `.pkg_resources` modules (L61, L64)
- `pip._internal.utils.misc.strtobool` for environment variable parsing (L7)

## Architectural Patterns

- **Strategy Pattern**: Backend selection isolates metadata implementation details
- **Factory Pattern**: All public functions delegate to backend-specific implementations
- **Lazy Loading**: Backend modules imported only when selected
- **Caching**: `@functools.lru_cache` on backend selection for performance (L58)

## Backend Selection Rules

1. Environment variable `_PIP_USE_IMPORTLIB_METADATA` takes precedence
2. Python < 3.11: defaults to pkg_resources
3. Python 3.11+: defaults to importlib.metadata unless distributor disables via `_PIP_USE_IMPORTLIB_METADATA = False`

## Critical Invariants

- Backend selection is consistent across process lifetime (cached)
- All factory functions return instances conforming to base class interfaces
- Environment variable parsing uses pip's internal `strtobool` utility