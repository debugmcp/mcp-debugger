# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/file_proxy.py
@source-hash: 4e5f531cc0d9f8f9
@generated: 2026-02-09T17:59:05Z

## Primary Purpose
File proxy wrapper that intercepts text writes and redirects them to Rich console for enhanced formatting while preserving original file interface.

## Core Architecture
- **FileProxy (L11-57)**: Main wrapper class extending `io.TextIOBase`
- Implements transparent file proxying with Rich console integration
- Buffers partial lines until newline completion for proper rendering

## Key Components

### Constructor & Properties
- **`__init__` (L14-18)**: Initializes with console reference, wrapped file, empty buffer, and ANSI decoder
- **`rich_proxied_file` property (L20-23)**: Provides access to underlying wrapped file object
- **`__getattr__` (L25-26)**: Delegates unknown attributes to wrapped file for transparency

### Core Write Logic
- **`write` (L28-48)**: Main text processing method
  - Type validation for string input (L29-30)
  - Line-by-line buffering with newline detection (L33-40)
  - ANSI decoding and Rich console output for complete lines (L41-47)
  - Returns original text length for compatibility
- **`flush` (L50-54)**: Forces output of buffered content and clears buffer

### File Interface
- **`fileno` (L56-57)**: Delegates file descriptor access to wrapped file

## Dependencies
- `io.TextIOBase`: Base class for text stream implementation
- `AnsiDecoder`: Handles ANSI escape sequence processing for terminal formatting
- `Text`: Rich text object for formatted output
- `Console`: Rich console for enhanced terminal output (TYPE_CHECKING import)

## Key Patterns
- **Proxy Pattern**: Transparent wrapper maintaining original file interface
- **Buffering Strategy**: Accumulates partial lines until newline for proper console rendering
- **ANSI Processing**: Decodes terminal escape sequences before Rich console output
- **Context Management**: Uses console context manager for thread-safe output

## Critical Behavior
- Maintains line buffering to ensure proper Rich formatting
- Preserves file interface compatibility through delegation
- Processes ANSI sequences for proper terminal rendering
- Thread-safe output through console context management