# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/rtf.py
@source-hash: 680d2ffe9b16e8a6
@generated: 2026-02-09T17:57:25Z

**Primary Purpose**: RTF (Rich Text Format) formatter for Pygments syntax highlighting that converts tokenized source code into Microsoft Word-compatible RTF markup with color and style formatting.

**Key Components**:

- **RtfFormatter class (L18-146)**: Main formatter inheriting from Pygments Formatter base class
  - Exports: name='RTF', aliases=['rtf'], filenames=['*.rtf'] (L46-48)
  - Constructor (L50-64): Accepts fontface and fontsize options, ignores encoding options since RTF handles unicode natively
  - **_escape method (L66-69)**: Escapes RTF special characters (\, {, })
  - **_escape_text method (L71-93)**: Comprehensive text escaping with unicode handling
    - ASCII characters (< 2^7): Direct output
    - Unicode BMP (2^7 to 2^16): Single escape sequence format
    - Beyond BMP (â‰¥ 2^16): Converts to surrogate pairs for RTF compatibility
  - **format_unencoded method (L95-146)**: Core formatting logic that generates complete RTF document

**Dependencies**:
- `Formatter` from `pip._vendor.pygments.formatter` (L11)
- `get_int_opt`, `surrogatepair` from `pip._vendor.pygments.util` (L12)

**RTF Document Structure**:
1. **Header generation (L97-101)**: RTF 1.8 format with font table
2. **Color table construction (L103-116)**: Extracts colors from style definitions, maps to RTF color indices
3. **Token processing (L121-144)**: Iterates through token stream, applies styling based on token types

**Key Features**:
- Font customization via fontface option (defaults to \\fmodern)
- Font sizing in half-points via fontsize option
- Complete unicode support through escape sequences and surrogate pairs
- Style mapping for bold, italic, underline, background/foreground colors, and borders
- Token type hierarchy traversal for style resolution

**Critical Constraints**:
- RTF unicode limited to 16 bits, requires surrogate pair encoding for higher codepoints
- Encoding/outencoding options ignored due to RTF ASCII-native format
- Generates complete RTF documents, not fragments