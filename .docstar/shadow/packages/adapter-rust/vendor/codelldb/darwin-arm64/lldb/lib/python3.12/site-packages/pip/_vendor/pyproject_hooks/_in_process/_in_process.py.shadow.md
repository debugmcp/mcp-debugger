# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pyproject_hooks/_in_process/_in_process.py
@source-hash: 9b66f7e1cf75ec85
@generated: 2026-02-09T17:57:34Z

## Purpose
Subprocess entrypoint for executing PEP 517/518 build backend hooks in an isolated process. Serves as a communication bridge between build systems and Python package build backends, handling hook invocation and result serialization.

## Key Architecture
**Environment-based configuration**: Receives backend specification via `PEP517_BUILD_BACKEND` and optional path via `PEP517_BACKEND_PATH` environment variables (L74-76).

**JSON-based I/O**: Uses `control_dir/input.json` for parameters and `control_dir/output.json` for results (L331, L349).

**Backend loading**: `_build_backend()` (L66-91) dynamically imports and validates the specified build backend module, with security checks for backend-path containment (L82-86).

## Core Functions

### Hook Implementations (PEP 517)
- `get_requires_for_build_wheel()` (L107-118): Optional hook for wheel build dependencies
- `prepare_metadata_for_build_wheel()` (L135-154): Optional metadata preparation with fallback to full wheel build
- `build_wheel()` (L239-252): Mandatory wheel building with prebuilt wheel optimization
- `get_requires_for_build_sdist()` (L276-287): Optional hook for sdist build dependencies  
- `build_sdist()` (L300-306): Mandatory source distribution building

### Editable Install Support
- `get_requires_for_build_editable()` (L121-132): Dependencies for editable builds
- `prepare_metadata_for_build_editable()` (L157-181): Metadata prep with complex fallback chain
- `build_editable()` (L255-273): Editable wheel building with prebuilt optimization

### Utility Functions
- `_supported_features()` (L94-104): Backend capability detection
- `_find_already_built_wheel()` (L217-236): Detects prebuilt wheels via `WHEEL_BUILT_MARKER` (L184)
- `_get_wheel_metadata_from_wheel()` (L199-214): Extracts metadata from built wheels using zipfile
- `_dist_info_files()` (L187-196): Locates .dist-info directories in wheel archives

## Exception Hierarchy
- `BackendUnavailable` (L40-43): Import failures with traceback preservation
- `BackendInvalid` (L46-49): Backend validation failures
- `HookMissing` (L52-56): Missing required hooks
- `GotUnsupportedOperation` (L294-297): Wraps backend UnsupportedOperation exceptions

## Entry Point
`main()` (L322-353): Command-line interface that:
1. Validates hook names against `HOOK_NAMES` whitelist (L309-319)
2. Loads hook input from JSON
3. Executes requested hook with comprehensive exception handling
4. Serializes results to output JSON with error categorization

## Key Patterns
- **Fallback mechanisms**: Metadata preparation functions fall back to building full wheels when hooks are missing
- **Prebuilt wheel optimization**: Both wheel building functions check for and reuse already-built wheels
- **Security validation**: Backend path containment checks prevent loading from unexpected locations
- **Error isolation**: Each exception type carries specific context for proper error reporting upstream