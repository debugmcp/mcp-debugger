# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/response.py
@source-hash: 189a60dc4822f6a6
@generated: 2026-02-09T17:57:26Z

## Response Utility Module

Provides HTTP response and file-like object utilities for urllib3, focusing on state detection and validation.

### Key Functions

**`is_fp_closed(obj)` (L9-37)**
- Determines if a file-like object is closed using multiple fallback strategies
- Tries `obj.isclosed()` first (Python3 compatibility, GH Issue #928)
- Falls back to `obj.closed` attribute (standard file-like interface)
- Final fallback checks `obj.fp is None` for container objects like HTTPResponse
- Raises ValueError if closure state cannot be determined

**`assert_header_parsing(headers)` (L40-91)**
- Validates HTTP header parsing completeness and raises HeaderParsingError on issues
- Python 3 only functionality
- Accepts `http.client.HTTPMessage` objects, raises TypeError for wrong types
- Extracts parsing defects and unparsed payload data
- Filters out known benign multipart defects (StartBoundaryNotFoundDefect, MultipartInvariantViolationDefect) due to httplib quirks
- Raises HeaderParsingError with defects and unparsed_data if validation fails

**`is_response_to_head(response)` (L94-107)**
- Detects if an HTTP response originated from a HEAD request
- Handles AppEngine platform quirks where method is an integer (3 = HEAD)
- Accesses private `_method` attribute on HTTPResponse objects
- Returns boolean indicating HEAD request origin

### Dependencies
- `email.errors`: Multipart parsing defect types
- `..exceptions.HeaderParsingError`: Custom urllib3 exception
- `..packages.six.moves.http_client`: Cross-Python HTTP client compatibility

### Architecture Notes
- Defensive programming with multiple fallback strategies for file closure detection
- Specific handling of httplib multipart parsing quirks
- Platform-specific workarounds for AppEngine integer method codes