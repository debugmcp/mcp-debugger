# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/palette.py
@source-hash: 9489ef4753830d3d
@generated: 2026-02-09T17:59:15Z

## packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/palette.py

A color palette abstraction for the Rich terminal formatting library, implementing color matching and display functionality.

**Primary Purpose:**
Provides a `Palette` class that wraps a sequence of RGB color tuples and offers efficient color matching via Euclidean distance calculation in RGB space.

**Key Components:**

### Palette Class (L11-73)
- **Constructor (L14-15)**: Takes a sequence of RGB tuples and stores them internally
- **Item Access (L17-18)**: `__getitem__` returns ColorTriplet objects for palette indexing
- **Rich Display (L20-41)**: `__rich__` method generates a formatted Table showing palette colors with visual swatches
- **Color Matching (L44-72)**: `match()` method finds closest palette color using optimized weighted Euclidean distance algorithm

**Color Matching Algorithm (L45-72):**
- Uses LRU cache with 1024 entries for performance optimization
- Implements weighted RGB distance calculation accounting for human color perception
- Red-mean formula: weights red/blue components based on average red value
- Inner function `get_color_distance` (L58-69) calculates perceptual distance
- Returns index of closest matching color in palette

**Dependencies:**
- `ColorTriplet` from `.color_triplet` - RGB color representation
- Rich components (`Table`, `Color`, `Style`, `Text`) - display formatting
- Standard library: `math.sqrt`, `functools.lru_cache`

**Demo Code (L75-100):**
Contains executable color gradient demonstration using `ColorBox` class that renders HLS color space as terminal output with half-block characters.

**Performance Considerations:**
- LRU caching on color matching prevents redundant distance calculations
- Local variable optimization (`_sqrt`, `get_color`) reduces attribute lookups in tight loops
- Bitwise operations (`>>`) for efficient integer division in distance formula