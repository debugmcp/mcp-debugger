# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/truststore/_openssl.py
@source-hash: 2cb519ed919a8a8f
@generated: 2026-02-09T17:59:17Z

## Primary Purpose
OpenSSL-based SSL certificate verification implementation for the truststore library. Provides system CA certificate discovery and SSL context configuration on Unix-like systems.

## Key Components

### Constants and Configuration (L7-19)
- `_CA_FILE_CANDIDATES` (L8-17): Prioritized list of common CA certificate bundle locations across different Linux distributions and BSD systems
- `_HASHED_CERT_FILENAME_RE` (L19): Regex pattern matching OpenSSL hashed certificate filenames (8-digit hex + dot + digit)

### Core Functions

#### `_configure_context()` (L22-46) 
Context manager that configures SSL context with appropriate CA certificates:
- First attempts to use OpenSSL's default verify paths via `ssl.get_default_verify_paths()`
- Falls back to searching `_CA_FILE_CANDIDATES` if defaults are unavailable
- Uses `_capath_contains_certs()` to validate certificate directory contents
- Calls `ctx.set_default_verify_paths()` or `ctx.load_verify_locations()` as appropriate

#### `_capath_contains_certs()` (L49-56)
Utility function that validates if a directory contains OpenSSL-format certificates:
- Checks directory existence
- Scans for files matching hashed certificate naming convention
- Returns boolean indicating presence of valid certificates

#### `_verify_peercerts_impl()` (L59-66)
No-op verification function - delegates to SSLContext's built-in verification (CERT_REQUIRED mode)

## Dependencies
- `ssl`: Core SSL/TLS functionality
- `os`: File system operations for certificate discovery
- `re`: Regex matching for certificate filename validation
- `contextlib`: Context manager utilities
- `typing`: Type annotations

## Architectural Decisions
- Prioritizes system-provided CA bundles over bundled certificates
- Implements fallback chain from OpenSSL defaults to distribution-specific locations
- Uses OpenSSL's native verification rather than custom certificate validation
- Designed for Unix-like systems (Linux distributions, BSD)

## Integration Notes
Part of truststore's adapter pattern - this module handles OpenSSL backend while other modules likely handle different SSL backends (e.g., Schannel, SecureTransport).