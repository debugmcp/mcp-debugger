# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/database.py
@source-hash: d15f50becd15af16
@generated: 2026-02-09T17:58:58Z

## Purpose
PEP 376 implementation for Python package database management. Provides classes and utilities to discover, examine, and manipulate installed Python distributions on the filesystem. Core functionality for working with both modern `.dist-info` and legacy `.egg-info` distributions.

## Key Classes

### `_Cache` (L44-73)
Simple caching mechanism mapping distribution names/paths to distribution objects. Contains `name` dict (case-insensitive lookup), `path` dict (path-based lookup), and `generated` flag to track cache state.

### `DistributionPath` (L75-325)
Central class representing a set of distributions on a search path (typically sys.path). Key functionality:
- `__init__(path=None, include_egg=False)` (L80-98): Constructor with optional custom path and legacy support
- `_yield_distributions()` (L115-167): Core discovery method scanning filesystem for dist/egg info directories
- `get_distribution(name)` (L232-256): Find single distribution by name
- `get_distributions()` (L210-230): Iterator over all discovered distributions
- Maintains separate caches for modern (_cache) and legacy (_cache_egg) distributions

### `Distribution` (L327-481)
Base class for all distributions with metadata-driven initialization:
- Properties: `provides` (L379-388), `run_requires` (L399-400), various requirement types
- `matches_requirement(req)` (L418-449): Version matching logic using scheme matchers
- Equality/hashing based on name, version, source_url

### `BaseInstalledDistribution` (L483-536)
Abstract base for installed distributions adding file system operations:
- `get_hash(data, hasher=None)` (L506-535): Hash computation with configurable algorithms

### `InstalledDistribution` (L538-865)
PEP 376 compliant distribution (.dist-info directories):
- `_get_records()` (L589-610): Parse RECORD file for installed file tracking  
- `exports` property (L612-624): Cached export entry points
- `write_installed_files()` (L682-715): Generate RECORD file
- `check_installed_files()` (L717-751): Verify file integrity against RECORD
- `shared_locations` property (L753-778): Parse SHARED file for installation paths

### `EggInfoDistribution` (L867-1091)
Legacy setuptools distribution (.egg-info/.egg support):
- `_get_metadata(path)` (L898-990): Complex metadata extraction from various egg formats
- `parse_requires_data()` (L901-929): Parse requirements.txt format
- Simplified file verification without full RECORD support

### `DependencyGraph` (L1097-1238)
Dependency relationship modeling:
- `adjacency_list` and `reverse_list` for bidirectional traversal
- `topological_sort()` (L1202-1231): Dependency ordering with cycle detection
- DOT format export for visualization

## Key Functions

- `make_graph(dists, scheme='default')` (L1241-1292): Build dependency graph from distribution list
- `get_dependent_dists(dists, dist)` (L1295-1318): Find all dependents of a distribution  
- `get_required_dists(dists, dist)` (L1321-1347): Find all requirements of a distribution
- `make_dist(name, version, **kwargs)` (L1350-1359): Convenience constructor

## Architecture Patterns

- **Caching Strategy**: Two-tier caching (modern vs legacy) with lazy generation
- **Resource Discovery**: Uses pluggable `resources.finder_for_path()` abstraction
- **Version Scheme Abstraction**: Delegates to configurable version scheme matchers
- **Metadata Normalization**: Unified Metadata interface across distribution types
- **Error Resilience**: Graceful handling of malformed distributions with warnings

## Dependencies
- `resources` module for filesystem abstraction
- `metadata.Metadata` for distribution metadata parsing
- `version.get_scheme()` for version comparison logic
- `util` module for requirement parsing and CSV handling

## Constants
- `DISTINFO_EXT = '.dist-info'` (L41)
- `DIST_FILES` tuple (L38-39): Valid dist-info file names
- File name constants: `EXPORTS_FILENAME`, `COMMANDS_FILENAME` (L35-36)