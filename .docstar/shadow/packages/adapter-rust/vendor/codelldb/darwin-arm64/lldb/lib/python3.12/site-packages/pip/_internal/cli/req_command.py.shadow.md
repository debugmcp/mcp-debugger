# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/cli/req_command.py
@source-hash: 0ea78586650cb3aa
@generated: 2026-02-09T17:58:27Z

**Primary Purpose**: Base class for pip commands that handle package requirements, providing shared functionality for requirement parsing, resolver creation, and package finding while implementing lazy loading to avoid importing heavy dependencies when not needed.

**Key Classes & Functions**:

- **RequirementCommand (L78-329)**: Abstract base class extending IndexGroupCommand for commands dealing with package requirements
  - `__init__` (L79-82): Adds `--no-clean` option to command
  - `determine_resolver_variant` (L84-90): Static method to choose between "legacy" and "resolvelib" resolvers based on deprecated features
  - `make_requirement_preparer` (L92-145): Class method factory for RequirementPreparer instances with resolver-specific configuration
  - `make_resolver` (L147-204): Class method factory for BaseResolver instances, dynamically imports and creates appropriate resolver type
  - `get_requirements` (L206-290): Parses command arguments, constraint files, editable packages, and requirement files into InstallRequirement objects
  - `trace_basic_info` (L292-301): Static utility for logging package finder search locations
  - `_build_package_finder` (L303-329): Creates PackageFinder with LinkCollector and SelectionPreferences

- **with_cleanup decorator (L50-75)**: Manages temporary directory cleanup behavior
  - Inner `configure_tempdir_registry` (L55-57): Configures which temp directories to preserve
  - Inner `wrapper` (L59-74): Handles PreviousBuildDirError and applies no-clean logic

**Key Constants**:
- **KEEPABLE_TEMPDIR_TYPES (L43-47)**: List of temporary directory types that can be preserved when `--no-clean` is used

**Dependencies**:
- Core pip internals: cache, CLI options, exceptions, index operations
- Requirement handling: constructors, file parsing, InstallRequirement
- Resolution: BaseResolver and dynamic imports for legacy/resolvelib resolvers
- Network: PipSession for HTTP operations
- Build operations: BuildTracker, RequirementPreparer

**Architectural Patterns**:
- **Lazy Loading**: Module docstring explicitly mentions avoiding unnecessary imports of PackageFinder machinery
- **Factory Pattern**: Class methods for creating RequirementPreparer and resolver instances
- **Strategy Pattern**: Dynamic resolver selection between legacy and resolvelib implementations
- **Decorator Pattern**: `with_cleanup` for cross-cutting cleanup concerns

**Critical Invariants**:
- Must provide at least one requirement source (args, editables, or requirement files) or raise CommandError
- Hash checking automatically enabled if any requirement has hash options
- Temp directory registry must be initialized before cleanup operations
- Dynamic imports ensure correct resolver type instantiation for mypy type checking