# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/index.py
@source-hash: 9536f0dbaf2b4618
@generated: 2026-02-09T17:58:50Z

## Primary Purpose
PyPI-compatible package index client for uploading, downloading, signing, and searching Python packages. Part of the distlib library, providing programmatic access to Python Package Index operations.

## Key Components

### PackageIndex Class (L29-508)
Main class implementing PyPI client functionality with HTTP multipart form encoding and GPG signing support.

**Core Attributes:**
- `boundary` (L35): Multipart form boundary marker for HTTP uploads
- `url` (L44): Index URL, defaults to PyPI (https://pypi.org/pypi)
- `username/password` (L82-83): Authentication credentials from .pypirc
- `gpg` (L51): GPG binary path for package signing
- `password_handler` (L49): HTTP basic auth handler

**Authentication & Configuration:**
- `__init__()` (L37-64): Initializes with URL validation and GPG detection
- `read_configuration()` (L74-85): Loads credentials from .pypirc file
- `save_configuration()` (L87-94): Persists credentials to .pypirc
- `check_credentials()` (L96-106): Validates and sets up HTTP auth handler

**Package Operations:**
- `register()` (L108-126): Registers package metadata with index
- `upload_file()` (L232-287): Uploads release files with optional GPG signing, computes MD5/SHA256 hashes
- `upload_documentation()` (L289-315): Uploads zipped documentation directory
- `download_file()` (L365-441): Downloads files with optional digest verification and progress reporting

**GPG Signing & Verification:**
- `get_sign_command()` (L146-172): Constructs GPG signing command with keystore support
- `sign_file()` (L209-230): Signs files using GPG, returns signature file path
- `get_verify_command()` (L317-339): Constructs GPG verification command
- `verify_signature()` (L341-363): Verifies GPG signatures, returns boolean result

**Subprocess Management:**
- `run_command()` (L174-207): Executes subprocess with threaded stdout/stderr capture
- `_reader()` (L128-144): Thread target for reading subprocess output streams

**HTTP Operations:**
- `send_request()` (L442-456): Sends HTTP requests with auth handlers
- `encode_request()` (L458-499): Creates multipart/form-data HTTP requests for file uploads

**Search:**
- `search()` (L501-508): XML-RPC search interface using ServerProxy

## Dependencies
- **Internal**: `.compat` (HTTP utilities), `.util` (ZIP/ServerProxy), `.` (DistlibException)
- **Standard**: `hashlib`, `subprocess`, `tempfile`, `threading`, `logging`, `os`, `shutil`

## Architecture Patterns
- **Configuration Management**: Integrates with distutils .pypirc configuration system
- **Threaded I/O**: Uses separate threads for subprocess output capture to prevent blocking
- **Multipart Encoding**: Manual HTTP multipart/form-data encoding for file uploads
- **Error Handling**: Raises DistlibException for validation and operation failures
- **GPG Integration**: External GPG process management with configurable keystore paths

## Critical Constraints
- GPG operations require external `gpg` or `gpg2` binary availability
- HTTP authentication requires both username and password to be set
- File uploads validate metadata before transmission
- URLs must use http/https schemes only, no query parameters allowed
- Documentation uploads require `index.html` in the target directory