# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/models/format_control.py
@source-hash: c2db10a922bd1da5
@generated: 2026-02-09T17:58:31Z

## Purpose
Manages package installation format restrictions for pip, controlling whether packages can be installed from binary wheels, source distributions, or both.

## Key Components

### FormatControl Class (L8-78)
Central class managing format constraints with two primary sets:
- `no_binary` (L23): Set of package names that cannot be installed from binary wheels
- `only_binary` (L24): Set of package names that can only be installed from binary wheels

**Constructor** (L13-24): Accepts optional sets for both constraints, initializing empty sets if None provided.

**Equality Implementation** (L26-33): Compares instances by checking class type and all slot attributes.

**String Representation** (L35-36): Returns formatted string showing both constraint sets.

### Core Methods

**handle_mutual_excludes** (L38-59): Static method processing comma-separated format specifiers with special tokens:
- `:all:` - applies constraint to all packages, clearing conflicting constraints
- `:none:` - removes all constraints for the target set
- Regular package names are canonicalized and added to appropriate sets

**get_allowed_formats** (L61-71): Determines allowed installation formats for a given canonical package name:
- Returns frozenset containing "binary", "source", or both
- Checks package-specific constraints first, then global `:all:` constraints
- Priority: `only_binary` > `no_binary` > `:all:` constraints

**disallow_binaries** (L73-78): Convenience method that applies `:all:` to `no_binary`, effectively forcing source-only installation for all packages.

## Dependencies
- `pip._vendor.packaging.utils.canonicalize_name`: Normalizes package names for consistent comparison
- `pip._internal.exceptions.CommandError`: Raised for invalid format specifier syntax

## Architecture Notes
- Uses `__slots__` for memory efficiency
- Implements proper equality semantics for value objects
- Special tokens (`:all:`, `:none:`) provide bulk operations on format constraints
- Mutual exclusion logic prevents conflicting binary/source requirements