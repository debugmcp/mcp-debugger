# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/idna/codec.py
@source-hash: 3d2ea6f9799d493e
@generated: 2026-02-09T17:58:49Z

## Primary Purpose
Implements a Python codec for IDNA2008 (Internationalized Domain Names in Applications) encoding/decoding. Provides both simple and incremental codec interfaces for converting between Unicode domain names and ASCII-compatible encoding (ACE) format.

## Key Classes and Functions

### Codec (L8-26)
Basic codec implementation inheriting from `codecs.Codec`. Provides:
- `encode(data, errors='strict')` (L10-17): Converts Unicode string to bytes using IDNA encoding
- `decode(data, errors='strict')` (L19-26): Converts bytes back to Unicode string
- Only supports 'strict' error handling mode

### IncrementalEncoder (L28-59)
Buffered incremental encoder for streaming IDNA encoding. Key method:
- `_buffer_encode(data, errors, final)` (L29-59): Processes Unicode input in chunks, handling domain label splitting and partial data buffering
- Uses regex pattern `_unicode_dots_re` to split on various Unicode dot characters
- Manages trailing dots and incomplete labels for streaming scenarios

### IncrementalDecoder (L61-94)
Buffered incremental decoder for streaming IDNA decoding. Key method:
- `_buffer_decode(data, errors, final)` (L62-94): Processes ASCII input in chunks, converting back to Unicode
- Handles both string and bytes input (converts bytes to ASCII string)
- Similar label splitting and buffering logic as encoder

### StreamWriter/StreamReader (L97-102)
Simple wrapper classes combining Codec with codecs streaming interfaces for file-like object support.

### search_function (L105-116)
Codec registration function that returns `CodecInfo` for 'idna2008' codec name. Registers all codec classes with Python's codec system.

## Dependencies
- `.core`: Provides core IDNA functions (`encode`, `decode`, `alabel`, `ulabel`) and `IDNAError`
- `codecs`: Python standard codec infrastructure
- `re`: For Unicode dot pattern matching

## Key Patterns
- **Unicode Dot Handling**: Regex `_unicode_dots_re` (L6) matches various Unicode dot characters (U+002E, U+3002, U+FF0E, U+FF61)
- **Error Handling**: All classes only support 'strict' error mode, raising `IDNAError` for other modes
- **Incremental Processing**: Both incremental classes handle partial domain names by preserving incomplete labels between calls
- **Size Tracking**: All encode/decode methods return tuple of (result, consumed_bytes) for codec compliance

## Registration
Automatically registers the 'idna2008' codec with Python's codec system via `codecs.register(search_function)` (L118)