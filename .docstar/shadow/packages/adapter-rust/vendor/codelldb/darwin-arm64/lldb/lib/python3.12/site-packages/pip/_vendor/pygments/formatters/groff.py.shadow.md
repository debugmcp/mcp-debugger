# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/groff.py
@source-hash: c72f197f7b573a8e
@generated: 2026-02-09T17:57:30Z

## Purpose
Pygments formatter for groff/troff/roff typesetting systems, producing formatted text with font styling, colors, and line wrapping suitable for groff document processing.

## Key Classes

### GroffFormatter (L18-170)
Main formatter class extending Pygments' base Formatter. Converts syntax-highlighted tokens into groff markup with escapes for colors, fonts, and styling.

**Configuration Options:**
- `monospaced` (bool): Use monospace fonts (default: true)
- `linenos` (bool): Include line numbers (default: false) 
- `wrap` (int): Character limit for line wrapping (default: 0/disabled)

**Key Attributes:**
- `name = 'groff'`, `aliases = ['groff','troff','roff']` (L41-42)
- `styles` dict: Maps token types to groff start/end markup pairs
- `_lineno`, `_linelen`: Track current line number and length for formatting

## Core Methods

### __init__ (L45-56)
Initializes formatter options and builds style mappings via `_make_styles()`.

### _make_styles (L58-79)
Converts Pygments style definitions to groff markup pairs. Maps font styles (bold/italic) and colors to appropriate groff escapes (`\f[CB]`, `\m[color]`, etc.).

### _define_colors (L81-89)
Writes groff color definitions (`.defcolor`) to output for all colors used in the style.

### _write_lineno (L91-94)
Outputs formatted line numbers with proper spacing and newline handling.

### _wrap_line (L96-117)
Handles line wrapping at specified character limits, accounting for line number indentation. Maintains `_linelen` state for continuation tracking.

### _escape_chars (L119-136)
Escapes special groff characters (`\`, `.`, `'`, `` ` ``, `~`) and Unicode characters using groff's `\[uXXXX]` notation.

### format_unencoded (L138-170)
Main formatting entry point. Processes token stream, applies styling, handles line numbers/wrapping, and outputs groff markup with proper `.nf`/`.fi` blocks.

## Dependencies
- `math` module for floor division in line wrapping
- `pip._vendor.pygments.formatter.Formatter` base class
- `pip._vendor.pygments.util` for option parsing helpers

## Architecture Notes
- Uses groff font escapes: `\f[R]` (regular), `\f[B]` (bold), `\f[I]` (italic), with `C` variants for monospace
- Color markup: `\m[color]` for foreground, `\M[color]` for background  
- Token type inheritance: Falls back to parent token types when specific styles not found
- Stateful line tracking for proper wrapping and numbering behavior