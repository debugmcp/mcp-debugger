# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/rich/style.py
@source-hash: de18a8707ff837cb
@generated: 2026-02-09T17:59:24Z

## Purpose
Core terminal styling system for the Rich library, providing ANSI terminal text formatting with color, background, and text attributes (bold, italic, underline, etc.). Handles style parsing, composition, rendering, and ANSI code generation.

## Core Classes

### _Bit (L16-28)
Descriptor class for efficient bit-based attribute storage. Uses bit manipulation to represent boolean style attributes, enabling compact storage and fast access patterns.

### Style (L31-760)
Main styling class representing a complete terminal style with foreground/background colors and text attributes.

**Key Instance Variables:**
- `_color`, `_bgcolor` (L58-59): Optional Color objects for foreground/background
- `_attributes`, `_set_attributes` (L60-61): Bit fields for attribute values and which are set
- `_link`, `_link_id` (L71-72): Hyperlink support with unique identifiers
- `_ansi`, `_style_definition` (L73-74): Cached representations
- `_meta` (L64): Serialized metadata dictionary

**Factory Methods:**
- `null()` (L198-201): Returns performant singleton for empty styles
- `from_color()` (L203-225): Creates color-only styles bypassing full initialization
- `from_meta()` (L227-246): Creates metadata-only styles
- `on()` (L248-264): Creates styles with event handlers

**Attribute Properties (L266-278):**
Uses `_Bit` descriptors for efficient attribute access: `bold`, `dim`, `italic`, `underline`, `blink`, `blink2`, `reverse`, `conceal`, `strike`, `underline2`, `frame`, `encircle`, `overline`

**Core Operations:**
- `parse()` (L496-561): Parses string style definitions with comprehensive error handling
- `_make_ansi_codes()` (L335-376): Generates ANSI escape sequences for terminal rendering
- `get_html_style()` (L563-598): Converts to CSS for HTML output
- `render()` (L694-718): Applies style to text with ANSI codes and hyperlinks
- `_add()` (L732-755): Style combination with attribute precedence rules

**Combination Methods:**
- `combine()` (L600-611): Merges multiple styles via sum reduction
- `chain()` (L613-624): Combines positional style arguments
- `copy()` (L626-646): Deep copy with link ID regeneration

### StyleStack (L765-795)
Stack-based style management for nested styling contexts. Maintains current combined style at top of stack.

## Key Data Structures

**STYLE_ATTRIBUTES (L97-120):** Maps style names and abbreviations to canonical attribute names for parsing.

**_style_map (L81-95):** Maps bit positions to SGR (Select Graphic Rendition) ANSI parameters.

## Architecture Patterns

- **Bit field optimization:** Uses integer bit manipulation for compact attribute storage
- **Lazy evaluation:** ANSI codes and string representations cached until needed  
- **Immutable semantics:** Style operations return new instances rather than modifying existing
- **Singleton optimization:** NULL_STYLE constant for performance
- **LRU caching:** Heavy use of `@lru_cache` for parsing and rendering methods

## Dependencies
- `Color` from `.color`: Color representation and parsing
- `TerminalTheme` from `.terminal_theme`: Theme-aware color rendering
- `errors`: Custom exception types for style syntax errors