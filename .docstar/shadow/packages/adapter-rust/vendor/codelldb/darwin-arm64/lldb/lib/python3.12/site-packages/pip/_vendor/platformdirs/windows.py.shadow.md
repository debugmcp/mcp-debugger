# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/platformdirs/windows.py
@source-hash: 205a62a21501c313
@generated: 2026-02-09T17:58:55Z

## Windows Platform Directory Implementation

**Primary Purpose**: Provides Windows-specific implementation of platform directory paths for applications, following Microsoft's CSIDL (Common Shell Item ID List) standards.

**Core Class**: 
- `Windows (L16-141)`: Inherits from `PlatformDirsABC`, implements Windows-specific directory resolution using CSIDL constants

**Key Directory Properties**:
- `user_data_dir (L27-36)`: Returns roaming/local AppData based on `self.roaming` flag
- `site_data_dir (L53-57)`: Common application data directory for all users  
- `user_config_dir (L59-62)`: Aliases to `user_data_dir` (Windows pattern)
- `site_config_dir (L64-67)`: Aliases to `site_data_dir`
- `user_cache_dir (L69-76)`: Local AppData with optional "Cache" subfolder
- `user_log_dir (L89-96)`: Data directory with optional "Logs" subfolder when opinionated
- User media directories (L98-126): Documents, Downloads, Pictures, Videos, Music, Desktop
- Runtime directories (L128-140): Temporary directories in Local AppData

**Path Construction**:
- `_append_parts (L38-51)`: Core path builder that constructs hierarchical paths using appauthor/appname/version, with optional directory creation

**Windows Folder Resolution Strategy** (fallback chain):
1. `get_win_folder_via_ctypes (L213-249)`: Uses Windows Shell32 API via ctypes (preferred)
2. `get_win_folder_from_registry (L183-210)`: Registry-based fallback using winreg
3. `get_win_folder_from_env_vars (L143-161)`: Environment variable fallback

**Key Functions**:
- `get_win_folder_if_csidl_name_not_env_var (L164-180)`: Handles user profile subdirectories
- `_pick_get_win_folder (L252-265)`: Strategy selector based on available imports
- `get_win_folder (L268)`: LRU-cached folder resolver using selected strategy

**Architecture**: Uses CSIDL constants for Windows shell folder identification. Implements graceful degradation from native Windows APIs to environment variables. Supports both user-specific and system-wide directory locations.

**Dependencies**: 
- `.api.PlatformDirsABC` for base interface
- Optional: `ctypes`, `winreg` for Windows-specific APIs
- `os`, `functools.lru_cache` for path operations and caching