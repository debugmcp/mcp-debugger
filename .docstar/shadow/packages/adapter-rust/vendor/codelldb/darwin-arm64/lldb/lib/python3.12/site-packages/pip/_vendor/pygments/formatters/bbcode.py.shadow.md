# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/bbcode.py
@source-hash: af56fbc33593268b
@generated: 2026-02-09T17:57:29Z

## Purpose
BBCode formatter for Pygments syntax highlighting that outputs BBCode tags suitable for bulletin boards and forums. Converts syntax-highlighted tokens into BBCode markup with support for colors, bold, italic, and underline formatting.

## Key Components

### BBCodeFormatter Class (L18-108)
Main formatter class inheriting from Pygments `Formatter`. Converts tokenized source code into BBCode markup.

**Key attributes:**
- `name = 'BBCode'` (L47) - Formatter identifier
- `aliases = ['bbcode', 'bb']` (L48) - Command-line aliases
- `styles` (L56) - Dictionary mapping token types to BBCode tag pairs

**Configuration options:**
- `codetag` - Wraps output in `[code]` tags
- `monofont` - Adds monospace font tags
- `style` - Style scheme to use for highlighting

### Core Methods

**`__init__(self, **options)` (L51-57)**
- Initializes formatter with boolean options for `codetag` and `monofont`
- Calls `_make_styles()` to build style mapping

**`_make_styles(self)` (L59-76)**
- Builds `self.styles` dictionary mapping token types to BBCode tag pairs
- Supports: color (`[color=#hex]`), bold (`[b]`), italic (`[i]`), underline (`[u]`)
- Explicitly excludes background colors and borders (L74 comment)

**`format_unencoded(self, tokensource, outfile)` (L78-108)**
- Main formatting method that processes token stream
- Writes opening tags (`[code]`, `[font=monospace]`) based on options
- Groups consecutive tokens of same type for efficiency (L87-97)
- Writes BBCode tags around each token group
- Closes tags in reverse order

## Architecture Patterns

**Token Type Inheritance Resolution (L88-89)**
Uses parent token type lookup when exact type not found in styles, walking up the token type hierarchy.

**Tag Nesting Strategy (L62-73)**
Builds nested BBCode tags by accumulating opening tags in `start` and prepending closing tags to `end`, ensuring proper nesting order.

**Streaming Processing (L84-101)**
Processes tokens in streaming fashion, batching consecutive same-type tokens to minimize tag overhead.

## Dependencies
- `pip._vendor.pygments.formatter.Formatter` - Base formatter class
- `pip._vendor.pygments.util.get_bool_opt` - Option parsing utility

## Constraints
- No support for background colors or borders (BBCode limitation)
- Some bulletin boards don't support colors in `[code]` tags
- Monospace font implementation varies across BBCode parsers