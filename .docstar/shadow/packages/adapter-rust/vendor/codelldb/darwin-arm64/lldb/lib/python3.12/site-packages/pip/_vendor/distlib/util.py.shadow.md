# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/util.py
@source-hash: 5d2ce7c448bf8b74
@generated: 2026-02-09T17:59:14Z

## Primary Purpose
Utility module for distlib package distribution library providing essential functionality for package management, PEP 508 requirement parsing, file operations, networking, archiving, and platform detection.

## Key Components

### Requirement Parsing (L46-277)
- **parse_marker(marker_string)** (L56): Parses PEP 508 marker expressions into AST-like dictionary structures with nested `op`, `lhs`, `rhs` keys
- **parse_requirement(req)** (L147): Comprehensive PEP 508 requirement string parser returning Container with name, extras, constraints, marker, url, requirement fields
- Uses regex patterns: IDENTIFIER (L46), VERSION_IDENTIFIER (L47), COMPARE_OP (L48), MARKER_OP (L49) for tokenization

### File Operations (L498-688)
- **FileOperator** (L498): Core file manipulation class with dry-run support and transaction recording
  - copy_file(), copy_stream(), write_binary_file(), write_text_file() for file I/O
  - byte_compile() (L604) with hashed invalidation support for .pyc generation
  - ensure_dir(), ensure_removed() for directory management
  - commit()/rollback() (L662/L672) for transactional operations
- **convert_path(pathname)** (L471): Converts Unix-style paths to native filesystem format

### Caching and Storage (L985-1027)
- **Cache** (L985): File system cache for resources like shared libraries
- **get_cache_base(suffix)** (L772): Cross-platform cache directory resolution using LOCALAPPDATA on Windows, home directory elsewhere
- **path_to_cache_dir(path)** (L813): Converts absolute paths to cache-safe directory names

### Import/Export System (L706-769)
- **ExportEntry** (L706): Represents entry points with name, prefix, suffix, flags
- **get_export_entry(specification)** (L741): Parses entry point specifications using ENTRY_RE regex (L734)
- **read_exports(stream)/write_exports(exports, stream)** (L360/L407): JSON and INI format support for entry points

### Networking and Security (L484-1623)
- **HTTPSConnection** (L484): Certificate-verifying HTTPS connection with domain matching
- **HTTPSHandler** (L518): Custom HTTPS handler with CA certificate support
- **ServerProxy** (L1606): XML-RPC client with timeout support via Transport/SafeTransport classes
- **socket_timeout** context manager (L445) for network operations

### Archive Operations (L1249-1328)
- **unarchive(archive_filename, dest_dir)** (L1249): Secure extraction for zip, tar, tgz, tbz, whl with path traversal protection
- **zip_dir(directory)** (L1317): Creates BytesIO zip archive from directory tree
- Supports tarfile extraction filters (L1300) when available

### Progress Tracking (L1338-1425)
- **Progress** (L1338): Progress bar implementation with ETA calculation, speed reporting, and time tracking
- Properties: percentage, ETA, speed with human-readable formatting

### Pattern Matching (L1437-1473)
- **iglob(path_glob)** (L1437): Extended globbing with `**` recursive and `{opt1,opt2}` brace expansion support
- Validates glob patterns and handles recursive directory traversal

### Platform Detection (L1928-2025)
- **get_host_platform()** (L1928): Cross-platform identifier generation (e.g., "linux-x86_64", "win-amd64")
- **get_platform()** (L2019): Handles Windows cross-compilation via VSCMD_ARG_TGT_ARCH

### Event System (L1029-1097)
- **EventMixin** (L1029): Publish-subscribe pattern with subscriber management using deque for ordering

### Configuration (L1705-1758)
- **Configurator** (L1705): Extended BaseConfigurator with custom object instantiation and inc:// protocol support
- **PyPIRCFile** (L1827): Parses and manages PyPI authentication configuration files

### Utility Functions
- **in_venv()** (L306): Detects virtual environment execution
- **resolve(module_name, dotted_path)** (L691): Dynamic import resolution
- **normalize_name(name)** (L1810): PEP 503 package name normalization
- **split_filename(filename)** (L874): Extracts name, version, python version from filenames
- **get_project_data(name)/get_package_data(name, version)** (L972/L979): External metadata retrieval

### CSV Support (L1631-1698)
- **CSVReader/CSVWriter** (L1656/L1683): Unicode-aware CSV handling for Python 2/3 compatibility

### Dependencies
- Core Python modules: os, sys, re, json, subprocess, threading, tarfile, tempfile
- Network: socket, ssl, urllib components via .compat imports
- Archive: zipfile via .compat ZipFile import
- Configuration: configparser via .compat import

### Architecture Decisions
- Extensive use of context managers for resource management
- Dry-run capability throughout file operations
- Transaction support with commit/rollback semantics
- Cross-platform compatibility abstractions
- Security-first approach with certificate verification and path validation