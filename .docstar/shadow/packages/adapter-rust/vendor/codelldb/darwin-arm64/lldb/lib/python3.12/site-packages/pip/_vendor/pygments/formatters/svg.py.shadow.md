# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/formatters/svg.py
@source-hash: 75038d5b2a5bcdfb
@generated: 2026-02-09T17:57:31Z

## Primary Purpose
SVG formatter for Pygments - converts syntax-highlighted tokens into SVG graphics output. Each line of code becomes a `<text>` element with `<tspan>` elements for individual token styles.

## Core Components

### Main Class: SvgFormatter (L29-188)
Inherits from `Formatter`. Provides comprehensive SVG output formatting with extensive customization options.

**Key Configuration Options (L93-112):**
- `nowrap`: Skip SVG wrapper elements and XML declaration 
- Font settings: `fontfamily` (default "monospace"), `fontsize` (default "14px")
- Layout: `xoffset`, `yoffset`, `ystep` for positioning and line spacing
- Line numbers: `linenos`, `linenostart`, `linenostep`, `linenowidth`
- `spacehack`: Convert spaces to non-breaking spaces (&#160;) for SVG compatibility

### Core Methods

**format_unencoded(L114-171):** Main formatting method
- Handles XML declaration and SVG wrapper generation (when not `nowrap`)
- Processes token stream line by line
- Manages line numbering with configurable step intervals
- Converts newlines into separate `<text>` elements with incremented Y coordinates

**_get_style(L173-188):** Token style resolver with caching
- Traverses token hierarchy to find applicable style
- Converts Pygments styles to SVG attributes (`fill`, `font-weight`, `font-style`)
- Uses `_stylecache` for performance optimization

### Utility Functions

**escape_html(L18-24):** HTML entity escaping
- Escapes &, <, >, quotes for safe SVG text content

## Architecture Patterns

**Token Processing Pipeline:**
1. Token stream iteration with style lookup
2. HTML escaping and space handling
3. Line-by-line SVG text element generation
4. Coordinate management for multi-line layout

**Style Inheritance:** Walks token type hierarchy using `.parent` until style found, enabling fallback styling.

**Caching Strategy:** Style cache (`_stylecache`) prevents redundant style calculations for repeated token types.

## Dependencies
- `pip._vendor.pygments.formatter.Formatter` (base class)
- `pip._vendor.pygments.token.Comment` (for line number styling)  
- `pip._vendor.pygments.util` (option parsing helpers)

## Output Format
Generates complete SVG documents with:
- XML declaration and DOCTYPE
- Font family/size configuration in `<g>` wrapper
- Individual `<text>` elements per line
- Optional line numbering with right alignment