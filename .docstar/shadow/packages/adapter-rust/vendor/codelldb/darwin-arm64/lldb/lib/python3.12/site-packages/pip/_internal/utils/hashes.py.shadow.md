# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/utils/hashes.py
@source-hash: 68b8409435de100f
@generated: 2026-02-09T17:58:42Z

## Purpose
Hash verification utility for pip package installations. Provides cryptographic hash validation against known-good values to ensure package integrity during downloads and installations.

## Core Components

### Constants (L11-18)
- `FAVORITE_HASH = "sha256"` - Default/recommended hash algorithm
- `STRONG_HASHES = ["sha256", "sha384", "sha512"]` - Collision-resistant algorithms supported by pip

### Hashes Class (L21-130)
Primary hash validation wrapper that builds and verifies multiple hashes simultaneously.

**Key Methods:**
- `__init__(hashes: Dict[str, List[str]])` (L27-37) - Initialize with allowed hash algorithm -> digest mappings
- `__and__(other)` (L39-56) - Set intersection operation for combining hash constraints
- `check_against_chunks(chunks)` (L66-87) - Core validation logic; computes hashes from data chunks and validates against allowed values
- `check_against_file(file)` (L92-98) - File-based validation wrapper
- `check_against_path(path)` (L100-102) - Path-based validation wrapper
- `is_hash_allowed(hash_name, hex_digest)` (L62-64) - Single hash verification
- `has_one_of(hashes)` (L104-109) - Check if any provided hash is acceptable

**Properties:**
- `digest_count` (L58-60) - Total number of allowed digests across all algorithms
- Implements `__bool__`, `__eq__`, `__hash__` for standard Python operations

### MissingHashes Class (L132-147)
Specialized subclass for handling missing hash requirements. Always fails validation but computes actual hash to show users what the correct hash should be.

**Key Behavior:**
- `__init__()` (L140-144) - Sets up with empty allowed list for `FAVORITE_HASH`
- `_raise()` (L146-147) - Overrides parent to raise `HashMissing` instead of `HashMismatch`

## Dependencies
- `hashlib` - Core cryptographic hash functions
- `pip._internal.exceptions` - Custom exception types (`HashMismatch`, `HashMissing`, `InstallationError`)
- `pip._internal.utils.misc.read_chunks` - Utility for reading files in chunks

## Key Patterns
- Fail-fast validation: raises exceptions immediately on hash mismatch
- Multiple hash algorithm support for flexibility and migration paths
- Chunk-based processing for memory efficiency with large files
- Set intersection semantics for combining hash requirements from multiple sources

## Critical Invariants
- All hash digests stored in sorted order for consistent equality checks
- Empty Hashes object (no constraints) allows all hashes in intersection operations
- Hash validation is all-or-nothing: any matching hash from allowed set passes validation