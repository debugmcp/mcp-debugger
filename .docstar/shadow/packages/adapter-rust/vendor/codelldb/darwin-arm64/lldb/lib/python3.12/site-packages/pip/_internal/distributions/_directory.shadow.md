# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/distributions/
@generated: 2026-02-09T18:16:10Z

## Overview

This module implements pip's distribution abstraction system, providing a polymorphic interface for handling different types of Python package distributions during installation. The core responsibility is to abstract away the differences between source distributions, wheel files, and already-installed packages through a common `AbstractDistribution` interface.

## Architecture Pattern

The module follows a **Factory + Strategy pattern**:
- **Factory**: `__init__.py` provides `make_distribution_for_install_requirement()` to create appropriate distribution objects
- **Strategy**: Different distribution types implement the same `AbstractDistribution` interface with type-specific behavior

## Core Components

### Abstract Base (`base.py`)
- **AbstractDistribution**: Defines the contract all distribution types must implement
- Three key abstract methods: `build_tracker_id`, `get_metadata_distribution()`, `prepare_distribution_metadata()`
- Establishes separation between metadata access and distribution preparation phases

### Concrete Implementations

**SourceDistribution (`sdist.py`)**
- Handles source packages requiring compilation/build steps
- Complex preparation involving PEP 517 build backends, isolated environments, and dependency resolution
- Two-phase build dependency installation (static → dynamic requirements)
- Supports both traditional setup.py and modern pyproject.toml workflows

**WheelDistribution (`wheel.py`)**  
- Handles pre-built wheel files requiring no preparation
- Optimized path with direct metadata extraction from wheel files
- No-op preparation since wheels are already built

**InstalledDistribution (`installed.py`)**
- Represents packages already present on the system
- No-op preparation since they're already installed
- Simple metadata passthrough from existing installation

## Public API

### Primary Entry Point
- `make_distribution_for_install_requirement(install_req)`: Factory function that examines an `InstallRequirement` and returns the appropriate distribution object

### Decision Logic
1. **Editable installs** → `SourceDistribution` (legacy path)
2. **Wheel files** → `WheelDistribution` 
3. **Everything else** → `SourceDistribution`
4. **Satisfied requirements** → `InstalledDistribution` (handled elsewhere in pip)

## Key Abstractions

**Build Tracking**: Optional build tracking via `build_tracker_id` prevents concurrent builds of the same package. Sources return unique IDs, while wheels/installed return None.

**Metadata Access**: All distributions provide `get_metadata_distribution()` returning a `BaseDistribution` object for unified metadata querying.

**Preparation Pipeline**: `prepare_distribution_metadata()` handles any required setup before installation. Complex for sources (build environment setup), no-op for wheels/installed.

## Data Flow

1. **Requirement Analysis**: Factory examines `InstallRequirement` properties
2. **Distribution Creation**: Appropriate distribution object instantiated
3. **Metadata Preparation**: Distribution prepares any necessary build artifacts
4. **Metadata Access**: Unified metadata interface available for dependency resolution
5. **Installation**: Downstream pip components use prepared distribution

## Critical Invariants

- All factory paths return `AbstractDistribution` subclasses
- `build_tracker_id` determines whether preparation is needed
- Source distributions must have non-None `pyproject_requires` when using PEP 517
- Wheel distributions require local file paths for metadata access
- Installed distributions require non-None `satisfied_by` attribute