# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/locators.py
@source-hash: a35aff33cebf6d12
@generated: 2026-02-09T17:58:58Z

## Primary Purpose
This module provides a comprehensive system for locating and managing Python package distributions from various sources (PyPI, directories, JSON metadata, etc.). It serves as the foundation for package discovery and dependency resolution in distlib.

## Key Classes and Functions

### Core Locator Classes
- **Locator (L89-408)**: Abstract base class defining the locator interface
  - `_get_project()` - abstract method for retrieving project versions
  - `locate()` - finds distributions matching requirements with version constraints
  - `score_url()` - prioritizes URLs for package selection
  - `convert_url_to_download_info()` - extracts package metadata from URLs

### Concrete Locator Implementations
- **PyPIRPCLocator (L410-456)**: Uses XML-RPC to query PyPI
  - Limited to PyPI-compatible indexes with RPC support
  - `_get_project()` fetches release data via XML-RPC calls

- **PyPIJSONLocator (L459-525)**: Uses PyPI's JSON API
  - More lightweight than RPC but limited functionality
  - Parses JSON responses for package metadata

- **SimpleScrapingLocator (L586-834)**: Multi-threaded HTML scraper
  - Scrapes package index pages to discover distributions
  - Uses worker threads for parallel I/O operations
  - Implements sophisticated URL filtering and platform compatibility checks

- **DirectoryLocator (L836-899)**: Searches local filesystem directories
  - Recursively scans directories for package files
  - Supports both recursive and flat directory scanning

- **JSONLocator (L902-938)**: Uses extended JSON metadata (not PyPI standard)
  - Optimized for fast dependency resolution without archive downloads
  - Relies on pre-computed project metadata

- **DistPathLocator (L941-966)**: Finds installed distributions
  - Works with DistributionPath instances to locate installed packages

- **AggregatingLocator (L969-1055)**: Chains multiple locators
  - Supports both first-match and merge strategies
  - Propagates scheme settings to child locators

### Supporting Classes
- **RedirectHandler (L57-86)**: HTTP redirect handler fixing Python 3.2.x bugs
- **Page (L528-583)**: Represents scraped HTML pages with link extraction
- **DependencyFinder (L1069-1303)**: Resolves package dependency trees
  - `find()` - performs complete dependency resolution with conflict handling
  - Manages provider replacement and version constraint satisfaction

### Key Functions
- **get_all_distribution_names() (L42-54)**: Retrieves all package names from an index

## Important Dependencies
- HTTP handling: `urllib` components, custom `RedirectHandler`
- Threading: `threading` module for concurrent operations
- Metadata parsing: `.metadata`, `.version`, `.wheel` modules
- Utility functions: `.util` module for name normalization and parsing

## Architectural Patterns
- **Strategy Pattern**: Different locator implementations for various package sources
- **Chain of Responsibility**: `AggregatingLocator` delegates to multiple locators
- **Worker Thread Pool**: `SimpleScrapingLocator` uses thread pool for I/O parallelization
- **Caching Layer**: `get_project()` implements transparent caching via `_cache`

## Critical Invariants
- Version scheme consistency across all locators via `scheme` property
- Thread safety in multi-threaded locators using `threading.RLock`
- URL scoring prioritizes HTTPS and PyPI.org sources
- Dependency resolution handles circular dependencies and version conflicts

## Default Configuration
- `default_locator` (L1060-1064): Pre-configured `AggregatingLocator` with `SimpleScrapingLocator`
- Uses legacy versioning scheme for PyPI compatibility
- `locate` function (L1066): Convenience alias to default locator's locate method