# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/certifi/core.py
@source-hash: d92453e6b21c4028
@generated: 2026-02-09T17:58:46Z

**Purpose:** Core module for the certifi package that provides access to Mozilla's CA certificate bundle (cacert.pem) with version-specific implementations for Python 3.7+, 3.11+, and legacy versions.

**Architecture:** Uses conditional imports based on Python version to provide consistent API across different importlib.resources implementations:

- **Python 3.11+ Branch (L14-47):** Uses modern `importlib.resources.files()` and `as_file()` API
- **Python 3.7-3.10 Branch (L49-83):** Uses deprecated `importlib.resources.path()` and `read_text()` API  
- **Legacy Branch (L85-114):** Fallback implementation using filesystem paths for Python <3.7

**Key Functions:**

- `where() -> str`: Returns filesystem path to cacert.pem file. Implements lazy loading with global caching using `_CACERT_PATH` and `_CACERT_CTX` variables. Handles context manager lifecycle for resource extraction from zip/wheel packages.

- `contents() -> str`: Returns raw contents of cacert.pem as ASCII-encoded string. Direct file read without caching.

- `exit_cacert_ctx() -> None` (L10-11): Cleanup function registered with `atexit` to properly close the resource context manager.

**Global State Management:**
- `_CACERT_CTX`: Holds importlib.resources context manager for proper cleanup
- `_CACERT_PATH`: Cached path string to avoid re-extraction on repeated calls

**Resource Handling:** Sophisticated handling of packaged resources that may be inside zip files or wheels. The context manager pattern ensures temporary file cleanup while maintaining performance through global caching.

**Dependencies:** 
- `importlib.resources` (version-dependent imports)
- `atexit` for cleanup registration
- `os`, `types`, `typing` for legacy branch

**Critical Invariant:** Global variables must be properly managed to prevent resource leaks and ensure cleanup occurs during Python exit.