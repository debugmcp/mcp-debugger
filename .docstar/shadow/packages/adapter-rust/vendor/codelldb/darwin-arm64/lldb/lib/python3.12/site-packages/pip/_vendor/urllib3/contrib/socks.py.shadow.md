# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/contrib/socks.py
@source-hash: 6918bd7965e8f591
@generated: 2026-02-09T17:57:29Z

**Purpose**: SOCKS proxy support module for urllib3, enabling HTTP/HTTPS connections through SOCKS4/4A/5 proxies with authentication.

**Key Dependencies**:
- `socks` (PySocks) - Required external dependency for SOCKS functionality (L43-58)
- `urllib3` core modules: connection, connectionpool, poolmanager, exceptions (L60-67)
- Optional `ssl` module for HTTPS support (L69-72)

**Core Classes**:

**SOCKSConnection** (L75-141):
- Extends `HTTPConnection` for plain HTTP over SOCKS proxy
- `__init__()` (L80-82): Extracts `_socks_options` from kwargs
- `_new_conn()` (L84-140): Creates SOCKS proxy connection using `socks.create_connection()`, handles timeouts and proxy errors

**SOCKSHTTPSConnection** (L147-148):
- Multiple inheritance from `SOCKSConnection` and `HTTPSConnection`
- Provides HTTPS over SOCKS functionality through composition

**Connection Pools**:
- **SOCKSHTTPConnectionPool** (L151-152): Uses `SOCKSConnection` as connection class
- **SOCKSHTTPSConnectionPool** (L155-156): Uses `SOCKSHTTPSConnection` as connection class

**SOCKSProxyManager** (L159-216):
- Main interface extending `PoolManager` for SOCKS proxy management
- `pool_classes_by_scheme` (L165-168): Maps HTTP/HTTPS to respective SOCKS pool classes
- `__init__()` (L170-214): 
  - Parses proxy URL and extracts authentication (L179-184)
  - Maps URL schemes to SOCKS versions and DNS resolution modes (L185-198)
  - Configures `socks_options` dictionary with proxy parameters (L202-210)

**SOCKS Protocol Support**:
- SOCKS4: Basic IPv4 support (`socks4://`)
- SOCKS4A: IPv4 + domain names with remote DNS (`socks4a://`) 
- SOCKS5: IPv4/IPv6/domains with local DNS (`socks5://`)
- SOCKS5H: IPv4/IPv6/domains with remote DNS (`socks5h://`)

**Error Handling**:
- Dependency validation with warning and exception (L43-58)
- Socket timeout conversion to `ConnectTimeoutError` (L108-113, L120-125)
- Comprehensive proxy error handling with fallback to `NewConnectionError` (L115-138)

**Architecture Pattern**: 
- Decorator pattern extending urllib3 connection classes with SOCKS capability
- Factory pattern through pool manager for connection type selection
- Configuration encapsulation via `_socks_options` parameter passing