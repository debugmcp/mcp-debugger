# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/cmdline.py
@source-hash: bdb972686abbf4e2
@generated: 2026-02-09T17:58:59Z

## Purpose
Command line interface for Pygments syntax highlighting tool. Provides a comprehensive CLI for highlighting code with lexers, formatters, filters, and styles. Supports file I/O, stdin/stdout processing, streaming mode, and various query/help operations.

## Key Functions

### Option Parsing
- `_parse_options(o_strs)` (L33-51): Parses comma-separated option strings into key-value dictionary. Handles both `key=value` and boolean flag formats.
- `_parse_filters(f_strs)` (L54-64): Parses filter specifications with optional options (`filter:opt1=val1,opt2=val2`).

### Information Display
- `_print_help(what, name)` (L67-84): Prints detailed help for lexers, formatters, or filters by name.
- `_print_list(what)` (L87-136): Pretty-prints lists of available lexers, formatters, filters, or styles with descriptions.
- `_print_list_as_json(requested_items)` (L138-180): JSON output version of listing functionality.

### Core Logic
- `main_inner(parser, argns)` (L182-515): Main command processing logic handling all CLI operations:
  - Version display (`-V`)
  - Listing components (`-L`) 
  - Help lookup (`-H`)
  - Lexer name guessing (`-N`, `-C`)
  - Style sheet generation (`-S`)
  - Code highlighting with lexer/formatter selection
  - Streaming mode (`-s`) for line-by-line processing
  - Custom lexer/formatter loading (`-x`)

### CLI Infrastructure  
- `HelpFormatter` (L517-525): Custom argparse formatter that auto-detects terminal width.
- `main(args)` (L528-668): Entry point that sets up argument parser and handles exceptions gracefully.

## Key Dependencies
- Pygments core: `highlight`, lexers, formatters, filters, styles modules
- Standard library: `argparse`, `sys`, `os`, `shutil`
- Special handling for Windows colorama integration (L472-477)

## Architecture Patterns
- Extensive use of try/except for graceful error handling with user-friendly messages
- Modular option parsing with separate functions for different option types
- Conditional formatter selection based on environment (COLORTERM, TERM variables)
- Special LaTeX formatter integration with `LatexEmbeddedLexer` (L483-486)
- Binary I/O handling with encoding detection/conversion

## Critical Behaviors
- Encoding detection: `guess_decode()` for files, `guess_decode_from_terminal()` for stdin
- Lexer fallback chain: explicit → filename-based → content-based → TextLexer
- Formatter fallback: explicit → filename-based → terminal-appropriate default
- Streaming mode requires explicit lexer selection and processes line-by-line
- Custom lexer/formatter loading supports `filename:classname` syntax

## Error Handling
- Returns appropriate exit codes (0=success, 1=error, 2=usage error)
- Detailed traceback with `-v` flag, simplified messages otherwise
- Graceful handling of BrokenPipeError for piped output