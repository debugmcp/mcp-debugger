# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_internal/commands/inspect.py
@source-hash: 3c6ad8f534534423
@generated: 2026-02-09T17:58:29Z

## Purpose
Implements the `pip inspect` command that analyzes a Python environment and produces a structured JSON report of installed packages and environment metadata.

## Core Components

### InspectCommand Class (L19-92)
Main command handler extending pip's base Command class. Key characteristics:
- **ignore_require_venv = True** (L24): Allows execution in any environment
- **add_options()** (L28-46): Configures CLI options for local-only, user-only, and custom path inspection
- **run()** (L48-63): Main execution logic that orchestrates environment inspection and JSON output
- **_dist_to_dict()** (L65-92): Transforms BaseDistribution objects into serializable dictionaries

## Key Dependencies
- **pip._vendor.packaging.markers**: Environment marker detection
- **pip._vendor.rich**: JSON output formatting with syntax highlighting
- **pip._internal.metadata**: Distribution discovery and metadata access
- **pip._internal.utils.compat**: Standard library package filtering

## Architecture & Data Flow
1. **Option Processing** (L49): Validates path options via cmdoptions.check_list_path_option()
2. **Environment Discovery** (L50-54): Uses get_environment() to iterate installed distributions with filtering
3. **Report Generation** (L55-61): Constructs structured output with version info, pip version, installed packages, and environment markers
4. **Package Serialization** (L65-92): Converts each distribution to dictionary format including metadata, location, direct_url, installer, and requested status

## Output Schema
The JSON report includes:
- **version**: Schema version ("1")
- **pip_version**: Current pip version
- **installed**: Array of package dictionaries
- **environment**: Platform/Python environment markers

## Package Dictionary Structure
Each installed package includes:
- **metadata**: Full package metadata dictionary
- **metadata_location**: Path to package info
- **direct_url**: Installation source URL (if available) or emulated for editable installs (L76-84)
- **installer**: Tool used for installation (L86-88)
- **requested**: User-requested flag for dist-info installs (L90-91)

## Filtering Logic
- Excludes standard library packages via stdlib_pkgs
- Supports local-only filtering (virtualenv isolation)
- Supports user-site-only filtering
- Custom path targeting via --path option