# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/resources.py
@source-hash: 2f06cf92c7340352
@generated: 2026-02-09T17:58:55Z

## Primary Purpose
Resource management system for accessing files and data within Python packages, supporting both filesystem and ZIP archive resources. Provides unified interface for reading package data regardless of distribution format.

## Key Classes

### ResourceCache (L27-68)
Caching layer for resource access with cache invalidation strategy.
- `__init__(base=None)` (L28-32): Initializes cache in system temp directory
- `is_stale(resource, path)` (L34-43): Always returns True (aggressive invalidation)
- `get(resource)` (L45-68): Retrieves resource into cache, writes bytes if stale

### Resource (L77-108) 
Represents individual files/data within packages.
- `as_stream()` (L85-92): Returns new stream each call via finder
- `file_path` (L94-99): Cached property returning filesystem path via global cache
- `bytes` (L101-103): Cached property for file contents
- `size` (L105-107): Cached property for file size

### ResourceContainer (L110-116)
Represents directories/containers within packages.
- `resources` (L113-115): Cached property listing contained resources

### ResourceFinder (L118-206)
Base finder for filesystem-based resources.
- `skipped_extensions` (L123-126): Platform-specific file exclusions (.pyc, .pyo, .class on Java)
- `__init__(module)` (L128-131): Extracts module path and loader
- `find(resource_name)` (L154-164): Main entry point, returns Resource or ResourceContainer
- `iterator(resource_name)` (L187-205): Recursive traversal of resource tree
- File operations: `get_stream()`, `get_bytes()`, `get_size()` (L166-174)

### ZipResourceFinder (L208-284)
Specialized finder for ZIP archive resources, inherits from ResourceFinder.
- `__init__(module)` (L212-221): Extracts ZIP file index and prefix information
- `_find(path)` (L226-242): Uses binary search on sorted ZIP index
- `get_bytes(resource)` (L249-250): Delegates to loader.get_data()
- `_is_directory(path)` (L274-283): Checks if path has children in ZIP index

## Key Functions

### finder(package) (L313-335)
Main factory function returning appropriate ResourceFinder for package.
- Imports package if not loaded
- Uses `_finder_registry` to match loader type to finder class
- Caches results in `_finder_cache`

### finder_for_path(path) (L341-358)
Creates finder for arbitrary filesystem paths using pkgutil infrastructure.

## Important Dependencies
- `distlib.util.Cache`: Base caching functionality
- `zipimport`: ZIP file resource access
- `_frozen_importlib/_frozen_importlib_external`: Python import machinery integration

## Global State
- `cache` (L24): Lazy-initialized global ResourceCache instance
- `_finder_registry` (L286-303): Maps loader types to finder classes
- `_finder_cache` (L310): Package name to finder instance cache

## Architectural Decisions
- Finder pattern with registry-based dispatch by loader type
- Aggressive cache invalidation (always stale) for simplicity
- Unified interface abstracting filesystem vs ZIP access differences
- Cached properties for expensive operations (file I/O)

## Critical Constraints
- Package-only operation (no module-level resources)
- ZIP resources accessed via binary search for performance
- Platform-specific file filtering for bytecode files