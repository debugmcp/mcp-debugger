# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/pygments/regexopt.py
@source-hash: 8e0d402e881c6065
@generated: 2026-02-09T17:58:58Z

## Purpose
Optimized regex generation algorithm that creates efficient regular expressions for matching literal string lists. Part of the Pygments syntax highlighting library, this module transforms collections of literal strings into compact regex patterns using prefix/suffix analysis and character set optimization.

## Core Algorithm
- **regex_opt_inner (L26-79)**: Recursive optimization engine that analyzes string collections to build efficient regex patterns
- **regex_opt (L82-91)**: Public API function that sorts input strings and delegates to the inner algorithm

## Key Optimizations
1. **Character Set Optimization**: Groups single-character strings into character classes `[abc]` rather than alternation `a|b|c`
2. **Common Prefix Extraction**: Factors out shared prefixes to reduce pattern size
3. **Common Suffix Extraction**: Reverses strings to find shared suffixes, then reconstructs optimized pattern
4. **Empty String Handling**: Converts empty strings to optional groups with `?` quantifier
5. **Fallback Grouping**: Groups strings by first character when no other optimization applies

## Utility Functions
- **make_charset (L22-23)**: Creates regex character class notation with proper escaping for special characters
- **CS_ESCAPE (L18)**: Regex pattern for escaping special characters in character sets (`[\^\-\]]`)
- **FIRST_ELEMENT (L19)**: Operator helper for extracting first elements from tuples

## Dependencies
- Standard library: `re`, `os.path.commonprefix`, `itertools.groupby`, `operator.itemgetter`
- Uses regex escaping extensively to handle literal string matching

## Architecture Pattern
Recursive divide-and-conquer algorithm that progressively breaks down string lists into optimizable subgroups. Each recursive call handles one optimization strategy before delegating remaining work to child calls.

## Critical Constraints
- Input strings must be literals, not regex patterns (they get escaped)
- Algorithm assumes sorted input for consistent optimization results
- Maintains regex correctness while optimizing for pattern size and match performance