# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/distlib/markers.py
@source-hash: 9f70df3a1d72bd9f
@generated: 2026-02-09T17:58:49Z

## Primary Purpose
Parses and evaluates PEP 508 environment markers - conditional expressions that determine when Python packages should be installed based on platform/environment conditions.

## Key Components

### Evaluator Class (L45-98)
Core expression evaluator that processes marker syntax trees.

**Key Methods:**
- `evaluate(expr, context)` (L65-98): Recursively evaluates parsed marker expressions against environment context
  - Handles literals (quoted strings), variables, and operator expressions
  - Special handling for version comparisons using LegacyVersion
  - Supports operators: `==`, `===`, `~=`, `!=`, `<`, `<=`, `>`, `>=`, `and`, `or`, `in`, `not in`

**Operations Dict (L50-63)**: Maps operator strings to lambda functions for evaluation

### Environment Context Functions
- `default_context()` (L104-138): Builds default environment context with platform info
  - `format_full_version(info)` (L106-111): Formats Python version info
  - Returns dict with keys like `python_version`, `platform_system`, `os_name`, etc.
- `DEFAULT_CONTEXT` (L141): Pre-computed default context, function deleted after use

### Utility Functions
- `_is_version_marker(s)` (L31-32): Checks if string is version-related marker
- `_is_literal(o)` (L35-38): Detects quoted string literals  
- `_get_versions(s)` (L41-42): Extracts version objects from string using regex

### Main API
- `interpret(marker, execution_context=None)` (L147-167): Public entry point
  - Parses marker string using `parse_marker` from util module
  - Merges default and custom contexts
  - Returns boolean evaluation result

## Dependencies
- `compat.string_types`: String type compatibility
- `util.in_venv, parse_marker`: Virtual environment detection and marker parsing
- `version.LegacyVersion`: Version comparison objects
- Standard library: `os`, `re`, `sys`, `platform`

## Key Patterns
- Expression tree evaluation via recursive descent
- Context-based variable resolution
- Special version comparison logic for PEP 508 operators like `~=`
- Lazy evaluation of default context (computed once, function deleted)

## Constants
- `_VERSION_PATTERN` (L26-27): Regex for extracting version strings
- `_VERSION_MARKERS` (L28): Set of version-related marker names
- `_DIGITS` (L101): Regex for major.minor version extraction