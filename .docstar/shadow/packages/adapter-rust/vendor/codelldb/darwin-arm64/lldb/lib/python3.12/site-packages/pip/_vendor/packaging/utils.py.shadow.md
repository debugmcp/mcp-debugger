# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/packaging/utils.py
@source-hash: 3407585309e500ea
@generated: 2026-02-09T17:58:54Z

## Purpose
Core utility module for Python package name and filename normalization/validation following PEP 503, PEP 427, and PEP 440 standards. Handles canonicalization of package names, version strings, and parsing of wheel/sdist filenames.

## Type Definitions
- `BuildTag` (L13): Union type for wheel build tags - either empty tuple or tuple of build number and string
- `NormalizedName` (L14): NewType wrapper for canonicalized package names

## Exception Classes
- `InvalidName` (L17-21): Raised for invalid distribution names
- `InvalidWheelFilename` (L23-27): Raised for malformed wheel filenames (PEP 427 violations)
- `InvalidSdistFilename` (L29-33): Raised for malformed sdist filenames

## Regex Patterns
- `_validate_regex` (L36-38): Validates package names per core metadata spec
- `_canonicalize_regex` (L39): Matches sequences of hyphens, underscores, dots for normalization
- `_normalized_regex` (L40): Validates already-normalized names
- `_build_tag_regex` (L42): Parses wheel build tags (must start with digit)

## Core Functions

### `canonicalize_name(name, *, validate=False)` (L45-51)
Normalizes package names per PEP 503: converts to lowercase, replaces runs of [-_.] with single hyphen. Optional validation against metadata spec.

### `is_normalized_name(name)` (L53-55)
Checks if a name is already in normalized form using regex match.

### `canonicalize_version(version, *, strip_trailing_zero=True)` (L57-103)
Converts Version objects or strings to canonical string format. Handles all PEP 440 version components (epoch, release, pre/post/dev releases, local versions). Strips trailing .0 segments by default.

### `parse_wheel_filename(filename)` (L105-146)
Parses wheel filenames per PEP 427 into components: normalized name, version, build tag, and platform tags. Validates filename structure (4-5 dash-separated parts), extension, and project name format.

### `parse_sdist_filename(filename)` (L148-174)
Parses source distribution filenames into name and version. Supports .tar.gz and .zip extensions. Uses rightmost dash as name/version separator since PEP 440 versions cannot contain dashes.

## Dependencies
- `tags.Tag, parse_tag` (L10): Platform tag parsing
- `version.Version, InvalidVersion` (L11): Version parsing and validation

## Key Patterns
- Extensive regex-based validation for package ecosystem standards
- Consistent error handling with descriptive exception messages
- Type casting to maintain type safety with NewType wrappers
- Graceful handling of legacy versions in canonicalization