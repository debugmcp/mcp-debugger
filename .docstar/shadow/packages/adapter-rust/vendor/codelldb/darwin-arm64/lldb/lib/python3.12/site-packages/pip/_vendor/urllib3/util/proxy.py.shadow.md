# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/proxy.py
@source-hash: cd4bcf3c226ba7a7
@generated: 2026-02-09T17:57:24Z

## Purpose
Proxy utility functions for urllib3's HTTP connection tunneling and SSL context creation. Determines when HTTP CONNECT tunneling is required and creates appropriate SSL contexts for proxy connections.

## Key Functions

### connection_requires_http_tunnel (L4-34)
Core decision function that determines if an HTTP CONNECT tunnel is needed through a proxy based on:
- **Parameters**: `proxy_url` (URL object), `proxy_config` (ProxyConfig from poolmanager), `destination_scheme` (str)
- **Logic**:
  - Returns `False` if no proxy is configured (L18-19)
  - Returns `False` for HTTP destinations (always use forwarding) (L22-23)
  - Returns `False` for HTTPS proxies with `use_forwarding_for_https` enabled (L26-31)
  - Returns `True` for all other cases (requires tunneling) (L34)

### create_proxy_ssl_context (L37-56)
SSL context factory for proxy connections:
- **Parameters**: `ssl_version`, `cert_reqs`, optional CA certificate sources
- **Process**: 
  - Creates base SSL context using `create_urllib3_context` with resolved SSL parameters (L44-47)
  - Auto-loads default certificates if no custom CA sources provided and method exists (L49-55)
- **Returns**: Configured SSL context object

## Dependencies
- `.ssl_` module: `create_urllib3_context`, `resolve_cert_reqs`, `resolve_ssl_version` (L1)

## Architecture Notes
- Part of urllib3's proxy handling layer
- Supports both HTTP and HTTPS proxy protocols
- Implements conditional tunneling logic based on proxy type and destination scheme
- Handles SSL context creation with fallback to system default certificates