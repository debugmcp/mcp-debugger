# packages/adapter-rust/vendor/codelldb/darwin-arm64/lldb/lib/python3.12/site-packages/pip/_vendor/urllib3/util/ssl_match_hostname.py
@source-hash: 22be1c6551239809
@generated: 2026-02-09T17:57:32Z

## Purpose
SSL certificate hostname verification implementation that mimics Python 3.3.3's match_hostname() function. Provides RFC 2818/6125 compliant hostname matching for SSL certificates with backward compatibility for Python 2.7.

## Key Components

### Exception Class
- **CertificateError (L21-22)**: Custom ValueError subclass raised when hostname verification fails

### Core Functions

#### DNS Name Matching
- **_dnsname_match (L25-76)**: Implements RFC 6125 Section 6.4.3 DNS name matching with wildcard support
  - Handles wildcard certificates with security limits (max 1 wildcard per fragment)
  - Special handling for internationalized domain names (IDN) with "xn--" prefix
  - Returns boolean match result using regex pattern matching
  - Key security feature: prevents DoS attacks by limiting wildcards (L41-48)

#### IP Address Matching  
- **_ipaddress_match (L86-95)**: Exact IP address matching for subjectAltName IP addresses
  - Handles trailing newlines from OpenSSL
  - Uses ipaddress module for proper IP comparison
  - Requires ipaddress library (optional dependency)

#### Unicode Conversion
- **_to_unicode (L79-83)**: Python 2/3 compatibility helper for string encoding
  - Converts str to unicode in Python 2.7 using ASCII encoding

#### Main Verification
- **match_hostname (L98-159)**: Primary hostname verification entry point
  - Validates SSL certificate against target hostname
  - Processes subjectAltName extensions first (L128-137)
  - Falls back to commonName in certificate subject (L141-148)
  - Supports both DNS names and IP addresses
  - Raises CertificateError with descriptive messages on mismatch

## Dependencies
- **re**: Regex operations for wildcard pattern matching
- **sys**: Python version detection for compatibility
- **ipaddress** (optional, L13-16): IP address parsing and comparison, gracefully degrades if unavailable

## Architecture Patterns
- **Graceful degradation**: Optional ipaddress library with fallback behavior
- **RFC compliance**: Strict adherence to RFC 2818 and RFC 6125 specifications
- **Security-first design**: DoS protection via wildcard limits
- **Python 2/3 compatibility**: Version-aware string handling

## Critical Constraints
- Maximum 1 wildcard per DNS name fragment (security constraint)
- Wildcards only allowed in leftmost label per RFC 6125
- No wildcard matching for internationalized domain names (IDN)
- IP addresses not accepted as hostname parameter (must be extracted from certificate)