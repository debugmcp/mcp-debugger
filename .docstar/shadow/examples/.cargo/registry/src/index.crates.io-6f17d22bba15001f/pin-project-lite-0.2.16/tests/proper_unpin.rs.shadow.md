# examples/.cargo/registry/src/index.crates.io-6f17d22bba15001f/pin-project-lite-0.2.16/tests/proper_unpin.rs
@source-hash: 83790eb38ae2fd5a
@generated: 2026-02-09T18:11:46Z

## Test File: Unpin Trait Behavior Validation for pin-project-lite

**Purpose**: Comprehensive test suite validating automatic Unpin trait implementation logic for structures and enums generated by the pin_project! macro from pin-project-lite crate.

### Key Components

**Helper Module**:
- `auxiliary` module (L6): Provides test assertion macros via `#[macro_use]`

**Test Environment** (L8-101):
- Module `default`: Contains all test cases for Unpin behavior validation
- Uses `assert_unpin!` and `assert_not_unpin!` macros for compile-time trait verification

### Test Structures and Patterns

**Basic Inner Type** (L13-18):
- `Inner<T>` (L13-15): Generic wrapper struct containing field `f: T`
- Demonstrates fundamental Unpin propagation: Unpin when T is Unpin, !Unpin when T is !Unpin

**Struct with Mixed Pin/Unpin Fields** (L20-31):
- `Struct<T, U>` (L21-26): Tests pin_project! macro on struct with both pinned (#[pin]) and unpinned fields
- Pinned field `f1: Inner<T>` determines Unpin status, unpinned field `f2: U` doesn't affect it
- Validates Unpin inheritance through pinned fields only

**Enum Projections** (L33-48):
- `Enum<T, U>` (L36-43): Tests pin_project! on enums with projection attributes
- Includes `#[project = EnumProj]` and `#[project_ref = EnumProjRef]` for custom projection naming
- Same Unpin logic as structs: determined by pinned fields within variants

**Explicit !Unpin Override** (L50-61):
- `NotUnpinEnum<T, U>` (L52-58): Tests `#[project(!Unpin)]` attribute
- Forces !Unpin regardless of field types, overriding automatic inference

**Edge Cases**:
- `TrivialBounds` (L62-69): Direct PhantomPinned field test
- `PinRef<'a, T, U>` (L72-79): Mutable reference pinning behavior - references are always Unpin
- `NotUnpin<U>` (L82-89): Explicit !Unpin on simple generic struct
- `NotUnpinRef<'a, T, U>` (L92-100): Explicit !Unpin override on reference-containing struct

### Key Dependencies
- `std::marker::PhantomPinned`: Standard library type that is never Unpin
- `pin_project_lite::pin_project`: Core macro being tested

### Testing Pattern
Each test case uses compile-time assertions to verify expected Unpin behavior, ensuring the macro correctly implements trait bounds based on pinned field analysis and explicit annotations.