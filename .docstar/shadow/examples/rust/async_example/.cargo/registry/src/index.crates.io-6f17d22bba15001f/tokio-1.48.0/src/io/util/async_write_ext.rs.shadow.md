# examples/rust/async_example/.cargo/registry/src/index.crates.io-6f17d22bba15001f/tokio-1.48.0/src/io/util/async_write_ext.rs
@source-hash: ca47e9a6caf8d5e5
@generated: 2026-02-09T18:02:51Z

## Tokio AsyncWriteExt - Extension Trait for Async Writing

**Primary Purpose**: Provides convenient async writing methods as an extension trait for types implementing `AsyncWrite`. Acts as a convenience layer over the raw `AsyncWrite` trait, similar to how `std::io::Write` extensions work but for async contexts.

**Core Architecture**:
- **Extension Trait Pattern**: `AsyncWriteExt` (L72-1329) extends all `AsyncWrite` implementors via blanket implementation (L1332)
- **Future-based API**: All methods return specific future types that implement the async operations
- **Macro-generated Methods**: Uses `write_impl!` macro (L24-38) to generate numeric write methods with consistent patterns

**Key Method Categories**:

### Basic Write Operations (L130-392)
- **`write()`** (L130-135): Single buffer write, may be partial, returns bytes written
- **`write_vectored()`** (L182-187): Scatter-gather write from multiple buffers  
- **`write_buf()`** (L266-272): Write from `Buf` trait, advances cursor automatically
- **`write_all()`** (L387-392): Guaranteed complete write, loops until all bytes written
- **`write_all_buf()`** (L334-340): Complete write from `Buf`, advances until empty

### Numeric Writers (L394-1236)
Generated by macro for both big-endian and little-endian variants:
- **Integers**: `write_u8/i8` through `write_u128/i128` and `*_le` variants
- **Floats**: `write_f32/f64` and `*_le` variants  
- All numeric writers use corresponding future types (e.g., `WriteU32`, `WriteF64Le`)

### Stream Management (L1238-1329)
- **`flush()`** (L1281-1286): Forces buffered data to destination, cancellation safe
- **`shutdown()`** (L1323-1328): Clean stream closure, flushes then shuts down underlying writer

**Dependencies**:
- External utilities from `crate::io::util::*` for future implementations
- `bytes::Buf` for buffer-based writing
- `std::io::IoSlice` for vectored operations

**Key Design Patterns**:
- **Cancellation Safety**: Most methods are cancellation safe (documented per method)
- **Unpin Requirement**: All methods require `Self: Unpin` for safe async operation  
- **Future Return Types**: Each method returns a specific future type rather than `impl Future`
- **Error Propagation**: I/O errors bubble up from underlying `AsyncWrite` implementation

**Critical Invariants**:
- Write methods may write fewer bytes than requested (except `write_all*` variants)
- Zero return indicates writer can't accept more data or buffer is empty
- Partial writes advance internal cursors appropriately
- Numeric writes are atomic (all bytes or none)

**Usage Context**: Designed to be imported and used instead of raw `AsyncWrite` trait methods. Provides the async equivalent of `std::io::Write` convenience methods but with proper async/await support and cancellation handling.