#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run linting check
echo "ğŸ” Running ESLint checks before commit..."
npm run lint

if [ $? -eq 0 ]; then
    echo "âœ… ESLint checks passed!"
else
    echo "âŒ ESLint errors found! Please fix them before committing."
    echo "ğŸ’¡ You can use 'npm run lint:fix' to auto-fix some issues."
    echo "ğŸ’¡ Or use 'git commit --no-verify' to bypass this check (not recommended)."
    exit 1
fi

# Run personal information check on staged files
echo ""
echo "ğŸ” Checking staged files for personal information..."
node scripts/check-personal-paths.cjs

if [ $? -eq 0 ]; then
    echo "âœ… Pre-commit checks passed. Personal information check completed."
    echo "ğŸ’¡ Note: Tests will run before push to ensure code quality on GitHub."
else
    echo ""
    echo "âŒ Pre-commit checks failed. Please address the issues."
    exit 1
fi
